[33m[nodemon] 3.1.10[39m
[33m[nodemon] to restart at any time, enter `rs`[39m
[33m[nodemon] watching path(s): server.ts src/**/*[39m
[33m[nodemon] watching extensions: ts,tsx,js,jsx[39m
[32m[nodemon] starting `npx tsx server.ts`[39m
> Ready on http://0.0.0.0:3000
> Socket.IO server running at ws://0.0.0.0:3000/api/socketio
 ○ Compiling / ...
 ✓ Compiled / in 3.4s (857 modules)
 GET / 200 in 4396ms
 ✓ Compiled /favicon.ico in 419ms (493 modules)
 GET /favicon.ico 200 in 715ms
 ○ Compiling /api/dashboard ...
 ✓ Compiled /api/dashboard in 1352ms (999 modules)
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`isActive` = ? ORDER BY `main`.`cryptocurrencies`.`isDefault` DESC, `main`.`cryptocurrencies`.`rank` ASC, `main`.`cryptocurrencies`.`createdAt` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`coin_data_collection`.`id`, `main`.`coin_data_collection`.`cryptoId`, `main`.`coin_data_collection`.`status`, `main`.`coin_data_collection`.`lastCollected`, `main`.`coin_data_collection`.`nextCollection`, `main`.`coin_data_collection`.`errorCount`, `main`.`coin_data_collection`.`lastError`, `main`.`coin_data_collection`.`metadata` FROM `main`.`coin_data_collection` WHERE `main`.`coin_data_collection`.`cryptoId` IN (?,?,?,?,?) LIMIT ? OFFSET ?
 GET /api/cryptocurrencies?activeOnly=true 200 in 2356ms
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE `main`.`analysis_history`.`cryptoId` = ? ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/dashboard?coinId=bitcoin 200 in 2448ms
 ✓ Compiled /api/trading-signals-fast in 443ms (1002 modules)
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/trading-signals-fast?action=signal&coinId=bitcoin 200 in 595ms
 ✓ Compiled /api/alerts-fast in 364ms (1005 modules)
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/alerts-fast?action=process-data&coinId=bitcoin 200 in 532ms
 ○ Compiling /api/ai-analysis ...
 ✓ Compiled /api/ai-analysis in 502ms (1009 modules)
🤖 Starting AI analysis for bitcoin...
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE (`main`.`analysis_history`.`coinId` = ? AND `main`.`analysis_history`.`analysisType` = ?) ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
Failed to make API request: TypeError: fetch failed
    at async generateEnhancedAIAnalysis (src/app/api/ai-analysis/route.ts:272:27)
    at async performAIAnalysis (src/app/api/ai-analysis/route.ts:165:29)
    at async POST (src/app/api/ai-analysis/route.ts:54:13)
  270 |     if (zai) {
  271 |       try {
> 272 |         const completion = await zai.chat.completions.create({
      |                           ^
  273 |           messages: [
  274 |             {
  275 |               role: 'system', {
  [cause]: [Error: getaddrinfo ENOTFOUND api.z-ai.dev] {
    errno: -3008,
    code: 'ENOTFOUND',
    syscall: 'getaddrinfo',
    hostname: 'api.z-ai.dev'
  }
}
Z.AI analysis failed, using fallback: fetch failed
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query INSERT INTO `main`.`analysis_history` (`id`, `cryptoId`, `coinId`, `signal`, `confidence`, `reasoning`, `riskLevel`, `aiModel`, `analysisType`, `analysisData`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `cryptoId` AS `cryptoId`, `coinId` AS `coinId`, `signal` AS `signal`, `confidence` AS `confidence`, `reasoning` AS `reasoning`, `riskLevel` AS `riskLevel`, `aiModel` AS `aiModel`, `analysisType` AS `analysisType`, `analysisData` AS `analysisData`, `metricsData` AS `metricsData`, `timestamp` AS `timestamp`
✅ AI analysis saved to database for bitcoin
 POST /api/ai-analysis?action=analyze&coinId=bitcoin 200 in 1153ms
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `npx tsx server.ts`[39m
> Ready on http://0.0.0.0:3000
> Socket.IO server running at ws://0.0.0.0:3000/api/socketio
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `npx tsx server.ts`[39m
> Ready on http://0.0.0.0:3000
> Socket.IO server running at ws://0.0.0.0:3000/api/socketio
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `npx tsx server.ts`[39m
> Ready on http://0.0.0.0:3000
> Socket.IO server running at ws://0.0.0.0:3000/api/socketio
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `npx tsx server.ts`[39m
> Ready on http://0.0.0.0:3000
> Socket.IO server running at ws://0.0.0.0:3000/api/socketio
 ○ Compiling / ...
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `npx tsx server.ts`[39m
> Ready on http://0.0.0.0:3000
> Socket.IO server running at ws://0.0.0.0:3000/api/socketio
 ○ Compiling / ...
 ✓ Compiled / in 2.9s (857 modules)
 GET / 200 in 4081ms
 ✓ Compiled /favicon.ico in 336ms (493 modules)
 GET /favicon.ico 200 in 653ms
 GET / 200 in 223ms
 GET /favicon.ico 200 in 38ms
 ○ Compiling /api/cryptocurrencies ...
 ✓ Compiled /api/cryptocurrencies in 1118ms (999 modules)
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`isActive` = ? ORDER BY `main`.`cryptocurrencies`.`isDefault` DESC, `main`.`cryptocurrencies`.`rank` ASC, `main`.`cryptocurrencies`.`createdAt` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`coin_data_collection`.`id`, `main`.`coin_data_collection`.`cryptoId`, `main`.`coin_data_collection`.`status`, `main`.`coin_data_collection`.`lastCollected`, `main`.`coin_data_collection`.`nextCollection`, `main`.`coin_data_collection`.`errorCount`, `main`.`coin_data_collection`.`lastError`, `main`.`coin_data_collection`.`metadata` FROM `main`.`coin_data_collection` WHERE `main`.`coin_data_collection`.`cryptoId` IN (?,?,?,?,?) LIMIT ? OFFSET ?
 GET /api/cryptocurrencies?activeOnly=true 200 in 2232ms
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE `main`.`analysis_history`.`cryptoId` = ? ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/dashboard?coinId=bitcoin 200 in 2316ms
 ○ Compiling /api/ai-analysis ...
 ✓ Compiled /api/ai-analysis in 947ms (1007 modules)
🤖 [1754882590865-rv94ehuve] Starting AI analysis operation: AI_ENHANCED_ANALYSIS for bitcoin
📊 [1754882590865-rv94ehuve] Request data: {
  "marketData": {
    "price": {
      "usd": 45000,
      "usd_24h_change": 2.5,
      "usd_24h_vol": 25000000000,
      "usd_market_cap": 850000000000
    },
    "technical": {
      "rsi": 55,
      "ma50": 44000,
      "ma200": 42000,
      "macd": 0.5
    },
    "onChain": {
      "mvrv": 1.5,
      "nupl": 0.3,
      "sopr": 1.1,
      "activeAddresses": 1000000
    },
    "sentiment": {
      "fearGreedIndex": 60,
      "fearGreedClassification": "Neutral"
    }
  }
}
🤖 Starting AI analysis for bitcoin...
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE (`main`.`analysis_history`.`coinId` = ? AND `main`.`analysis_history`.`analysisType` = ?) ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
🤖 Using cached AI analysis for bitcoin
💾 [1754882590865-rv94ehuve] Using cached analysis for bitcoin (age: 622631ms)
✅ [1754882590865-rv94ehuve] Completed AI_ENHANCED_ANALYSIS successfully (41ms)
🎯 [1754882590865-rv94ehuve] Final result: {
  "recommendation": "GIỮ",
  "timeframe": "Ngắn hạn",
  "riskFactors": [
    "Thị trường biến động thông thường"
  ],
  "entryPoints": "Chờ tín hiệu rõ ràng hơn trước khi vào lệnh",
  "exitPoints": "Chốt lời khi có biến động giá mạnh hoặc đạt mục tiêu lợi nhuận",
  "stopLoss": "Quản lý rủi ro chặt chẽ, stop loss tại mức biến động chấp nhận được",
  "takeProfit": "Take profit khi đạt lợi nhuận mục tiêu hoặc có thay đổi xu hướng",
  "zaiAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn",
    "breakoutPotential": "LOW",
    "reasoning": "Phân tích dựa trên dữ liệu thị trường hiện tại."
  },
  "chatGPTAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn đến trung hạn (1-4 tuần)",
    "breakoutPotential": "LOW",
    "reasoning": "Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên quan sát và chờ đợi tín hiệu tốt hơn."
  }
}
 POST /api/ai-analysis?action=analyze&coinId=bitcoin 200 in 971ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/trading-signals-fast?action=signal&coinId=bitcoin 200 in 1188ms
 ○ Compiling /api/alerts-fast ...
 ✓ Compiled /api/alerts-fast in 541ms (1010 modules)
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/alerts-fast?action=process-data&coinId=bitcoin 200 in 702ms
🤖 [1754882592835-2tahkz92o] Starting AI analysis operation: AI_ENHANCED_ANALYSIS for bitcoin
📊 [1754882592835-2tahkz92o] Request data: {
  "marketData": {
    "price": {
      "usd": 117775,
      "usd_24h_change": 0.8618738474048199,
      "usd_24h_vol": 33776641957.26242,
      "usd_market_cap": 2343795976558.965
    },
    "onChain": {
      "mvrv": 1.8,
      "nupl": 0.65,
      "sopr": 1.02,
      "activeAddresses": 950000,
      "exchangeInflow": 15000,
      "exchangeOutflow": 12000,
      "transactionVolume": 25000000000,
      "supplyDistribution": {
        "whaleHoldings": {
          "percentage": 42.3,
          "addressCount": 850
        },
        "retailHoldings": {
          "percentage": 38.7,
          "addressCount": 42000000
        },
        "exchangeHoldings": {
          "percentage": 12.5,
          "addressCount": 150
        },
        "otherHoldings": {
          "percentage": 6.5,
          "addressCount": 120000
        }
      },
      "whaleHoldingsPercentage": 42.3,
      "retailHoldingsPercentage": 38.7,
      "exchangeHoldingsPercentage": 12.5
    },
    "technical": {
      "rsi": 58.5,
      "ma50": 112000,
      "ma200": 108000,
      "macd": 145.5,
      "macdSignal": null,
      "bollingerUpper": 122000,
      "bollingerLower": 111000,
      "bollingerMiddle": 116627
    },
    "derivatives": {
      "openInterest": 18500000000,
      "fundingRate": 0.0125,
      "liquidationVolume": 45000000,
      "putCallRatio": 0.85
    },
    "sentiment": {
      "fearGreedIndex": 50,
      "fearGreedClassification": "Neutral",
      "social": {
        "twitterSentiment": 0.5,
        "redditSentiment": 0.5,
        "socialVolume": 45000,
        "engagementRate": 0.085,
        "influencerSentiment": 0.75,
        "trendingScore": 75
      },
      "news": {
        "newsSentiment": 0.5,
        "newsVolume": 1250,
        "positiveNewsCount": 780,
        "negativeNewsCount": 320,
        "neutralNewsCount": 150,
        "sentimentScore": 0.5,
        "buzzScore": 75
      },
      "googleTrends": {
        "trendsScore": 75,
        "searchVolume": 850000,
        "trendingKeywords": [
          "bitcoin price",
          "btc news",
          "bitcoin mining"
        ],
        "regionalInterest": {
          "US": 85,
          "CN": 72,
          "EU": 68,
          "JP": 45,
          "KR": 52
        },
        "relatedQueries": [
          {
            "query": "bitcoin price today",
            "score": 95,
            "rising": true
          },
          {
            "query": "bitcoin prediction",
            "score": 78,
            "rising": true
          },
          {
            "query": "bitcoin mining",
            "score": 65,
            "rising": false
          }
        ],
        "trendDirection": "stable"
      }
    },
    "analysis": {
      "signal": "GIỮ",
      "confidence": 60,
      "reasoning": "Z.AI: Phân tích dựa trên dữ liệu thị trường hiện tại.... | ChatGPT: Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên q...",
      "riskLevel": "MEDIUM",
      "aiModel": "Z.AI+ChatGPT"
    },
    "timestamp": "2025-08-11T03:23:09.691Z",
    "dataSource": "database"
  },
  "tradingSignal": {
    "signal": "HOLD",
    "confidence": 50,
    "reasoning": "Tín hiệu trung lập: Không đủ điều kiện để MUA hoặc BÁN. Cần theo dõi thêm.",
    "riskLevel": "MEDIUM",
    "conditions": {
      "mvrv": 1.8,
      "fearGreed": 50,
      "fundingRate": 0.0125,
      "sopr": 1.02,
      "rsi": 58.5,
      "nupl": 0.65,
      "volumeTrend": "increasing",
      "extremeDetected": false
    },
    "triggers": []
  },
  "alerts": [
    {
      "id": "alert_1754882592609_vcp12evh3",
      "type": "WARNING",
      "category": "FUNDING_RATE",
      "title": "High Funding Rate Detected",
      "message": "Funding rate at 1.250% indicates strong long pressure and potential squeeze risk.",
      "severity": "MEDIUM",
      "timestamp": "2025-08-11T03:23:12.609Z",
      "coinId": "bitcoin",
      "data": {
        "fundingRate": 0.0125,
        "threshold": 0.001
      },
      "triggeredBy": [
        "High funding rate"
      ],
      "actionRequired": true,
      "recommendedAction": "Monitor for potential long squeeze or price correction"
    }
  ],
  "coinId": "bitcoin"
}
🤖 Starting AI analysis for bitcoin...
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE (`main`.`analysis_history`.`coinId` = ? AND `main`.`analysis_history`.`analysisType` = ?) ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
🤖 Using cached AI analysis for bitcoin
💾 [1754882592835-2tahkz92o] Using cached analysis for bitcoin (age: 624576ms)
✅ [1754882592835-2tahkz92o] Completed AI_ENHANCED_ANALYSIS successfully (16ms)
🎯 [1754882592835-2tahkz92o] Final result: {
  "recommendation": "GIỮ",
  "timeframe": "Ngắn hạn",
  "riskFactors": [
    "Thị trường biến động thông thường"
  ],
  "entryPoints": "Chờ tín hiệu rõ ràng hơn trước khi vào lệnh",
  "exitPoints": "Chốt lời khi có biến động giá mạnh hoặc đạt mục tiêu lợi nhuận",
  "stopLoss": "Quản lý rủi ro chặt chẽ, stop loss tại mức biến động chấp nhận được",
  "takeProfit": "Take profit khi đạt lợi nhuận mục tiêu hoặc có thay đổi xu hướng",
  "zaiAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn",
    "breakoutPotential": "LOW",
    "reasoning": "Phân tích dựa trên dữ liệu thị trường hiện tại."
  },
  "chatGPTAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn đến trung hạn (1-4 tuần)",
    "breakoutPotential": "LOW",
    "reasoning": "Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên quan sát và chờ đợi tín hiệu tốt hơn."
  }
}
 POST /api/ai-analysis?action=analyze&coinId=bitcoin 200 in 90ms
 GET / 200 in 212ms
 GET /favicon.ico 200 in 50ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`isActive` = ? ORDER BY `main`.`cryptocurrencies`.`isDefault` DESC, `main`.`cryptocurrencies`.`rank` ASC, `main`.`cryptocurrencies`.`createdAt` DESC LIMIT ? OFFSET ?
 GET /api/cryptocurrencies?activeOnly=true 200 in 131ms
prisma:query SELECT `main`.`coin_data_collection`.`id`, `main`.`coin_data_collection`.`cryptoId`, `main`.`coin_data_collection`.`status`, `main`.`coin_data_collection`.`lastCollected`, `main`.`coin_data_collection`.`nextCollection`, `main`.`coin_data_collection`.`errorCount`, `main`.`coin_data_collection`.`lastError`, `main`.`coin_data_collection`.`metadata` FROM `main`.`coin_data_collection` WHERE `main`.`coin_data_collection`.`cryptoId` IN (?,?,?,?,?) LIMIT ? OFFSET ?
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE `main`.`analysis_history`.`cryptoId` = ? ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/dashboard?coinId=bitcoin 200 in 167ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/trading-signals-fast?action=signal&coinId=bitcoin 200 in 81ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/alerts-fast?action=process-data&coinId=bitcoin 200 in 65ms
🤖 [1754882595740-nmfohdi7m] Starting AI analysis operation: AI_ENHANCED_ANALYSIS for bitcoin
📊 [1754882595740-nmfohdi7m] Request data: {
  "marketData": {
    "price": {
      "usd": 117775,
      "usd_24h_change": 0.8618738474048199,
      "usd_24h_vol": 33776641957.26242,
      "usd_market_cap": 2343795976558.965
    },
    "onChain": {
      "mvrv": 1.8,
      "nupl": 0.65,
      "sopr": 1.02,
      "activeAddresses": 950000,
      "exchangeInflow": 15000,
      "exchangeOutflow": 12000,
      "transactionVolume": 25000000000,
      "supplyDistribution": {
        "whaleHoldings": {
          "percentage": 42.3,
          "addressCount": 850
        },
        "retailHoldings": {
          "percentage": 38.7,
          "addressCount": 42000000
        },
        "exchangeHoldings": {
          "percentage": 12.5,
          "addressCount": 150
        },
        "otherHoldings": {
          "percentage": 6.5,
          "addressCount": 120000
        }
      },
      "whaleHoldingsPercentage": 42.3,
      "retailHoldingsPercentage": 38.7,
      "exchangeHoldingsPercentage": 12.5
    },
    "technical": {
      "rsi": 58.5,
      "ma50": 112000,
      "ma200": 108000,
      "macd": 145.5,
      "macdSignal": null,
      "bollingerUpper": 122000,
      "bollingerLower": 111000,
      "bollingerMiddle": 116627
    },
    "derivatives": {
      "openInterest": 18500000000,
      "fundingRate": 0.0125,
      "liquidationVolume": 45000000,
      "putCallRatio": 0.85
    },
    "sentiment": {
      "fearGreedIndex": 50,
      "fearGreedClassification": "Neutral",
      "social": {
        "twitterSentiment": 0.5,
        "redditSentiment": 0.5,
        "socialVolume": 45000,
        "engagementRate": 0.085,
        "influencerSentiment": 0.75,
        "trendingScore": 75
      },
      "news": {
        "newsSentiment": 0.5,
        "newsVolume": 1250,
        "positiveNewsCount": 780,
        "negativeNewsCount": 320,
        "neutralNewsCount": 150,
        "sentimentScore": 0.5,
        "buzzScore": 75
      },
      "googleTrends": {
        "trendsScore": 75,
        "searchVolume": 850000,
        "trendingKeywords": [
          "bitcoin price",
          "btc news",
          "bitcoin mining"
        ],
        "regionalInterest": {
          "US": 85,
          "CN": 72,
          "EU": 68,
          "JP": 45,
          "KR": 52
        },
        "relatedQueries": [
          {
            "query": "bitcoin price today",
            "score": 95,
            "rising": true
          },
          {
            "query": "bitcoin prediction",
            "score": 78,
            "rising": true
          },
          {
            "query": "bitcoin mining",
            "score": 65,
            "rising": false
          }
        ],
        "trendDirection": "stable"
      }
    },
    "analysis": {
      "signal": "GIỮ",
      "confidence": 60,
      "reasoning": "Z.AI: Phân tích dựa trên dữ liệu thị trường hiện tại.... | ChatGPT: Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên q...",
      "riskLevel": "MEDIUM",
      "aiModel": "Z.AI+ChatGPT"
    },
    "timestamp": "2025-08-11T03:23:15.334Z",
    "dataSource": "database"
  },
  "tradingSignal": {
    "signal": "HOLD",
    "confidence": 50,
    "reasoning": "Tín hiệu trung lập: Không đủ điều kiện để MUA hoặc BÁN. Cần theo dõi thêm.",
    "riskLevel": "MEDIUM",
    "conditions": {
      "mvrv": 1.8,
      "fearGreed": 50,
      "fundingRate": 0.0125,
      "sopr": 1.02,
      "rsi": 58.5,
      "nupl": 0.65,
      "volumeTrend": "increasing",
      "extremeDetected": false
    },
    "triggers": []
  },
  "alerts": [
    {
      "id": "alert_1754882595629_y9bp1sj1x",
      "type": "WARNING",
      "category": "DERIVATIVES",
      "title": "High Open Interest Detected",
      "message": "Open interest at $18.5B is near historical highs - increased volatility risk.",
      "severity": "MEDIUM",
      "timestamp": "2025-08-11T03:23:15.629Z",
      "coinId": "bitcoin",
      "data": {
        "openInterest": 18500000000,
        "historicalHigh": 18500000000,
        "percentage": "100.0"
      },
      "triggeredBy": [
        "High open interest"
      ],
      "actionRequired": true,
      "recommendedAction": "Prepare for increased volatility and potential liquidations"
    }
  ],
  "coinId": "bitcoin"
}
🤖 Starting AI analysis for bitcoin...
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE (`main`.`analysis_history`.`coinId` = ? AND `main`.`analysis_history`.`analysisType` = ?) ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
🤖 Using cached AI analysis for bitcoin
💾 [1754882595740-nmfohdi7m] Using cached analysis for bitcoin (age: 627471ms)
✅ [1754882595740-nmfohdi7m] Completed AI_ENHANCED_ANALYSIS successfully (6ms)
🎯 [1754882595740-nmfohdi7m] Final result: {
  "recommendation": "GIỮ",
  "timeframe": "Ngắn hạn",
  "riskFactors": [
    "Thị trường biến động thông thường"
  ],
  "entryPoints": "Chờ tín hiệu rõ ràng hơn trước khi vào lệnh",
  "exitPoints": "Chốt lời khi có biến động giá mạnh hoặc đạt mục tiêu lợi nhuận",
  "stopLoss": "Quản lý rủi ro chặt chẽ, stop loss tại mức biến động chấp nhận được",
  "takeProfit": "Take profit khi đạt lợi nhuận mục tiêu hoặc có thay đổi xu hướng",
  "zaiAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn",
    "breakoutPotential": "LOW",
    "reasoning": "Phân tích dựa trên dữ liệu thị trường hiện tại."
  },
  "chatGPTAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn đến trung hạn (1-4 tuần)",
    "breakoutPotential": "LOW",
    "reasoning": "Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên quan sát và chờ đợi tín hiệu tốt hơn."
  }
}
 POST /api/ai-analysis?action=analyze&coinId=bitcoin 200 in 46ms
 GET / 200 in 67ms
 GET /favicon.ico 200 in 38ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`isActive` = ? ORDER BY `main`.`cryptocurrencies`.`isDefault` DESC, `main`.`cryptocurrencies`.`rank` ASC, `main`.`cryptocurrencies`.`createdAt` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`coin_data_collection`.`id`, `main`.`coin_data_collection`.`cryptoId`, `main`.`coin_data_collection`.`status`, `main`.`coin_data_collection`.`lastCollected`, `main`.`coin_data_collection`.`nextCollection`, `main`.`coin_data_collection`.`errorCount`, `main`.`coin_data_collection`.`lastError`, `main`.`coin_data_collection`.`metadata` FROM `main`.`coin_data_collection` WHERE `main`.`coin_data_collection`.`cryptoId` IN (?,?,?,?,?) LIMIT ? OFFSET ?
 GET /api/cryptocurrencies?activeOnly=true 200 in 75ms
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE `main`.`analysis_history`.`cryptoId` = ? ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/dashboard?coinId=bitcoin 200 in 101ms
 ○ Compiling /api/ai-analysis-logs ...
 ✓ Compiled /api/ai-analysis-logs in 1018ms (1012 modules)
 GET /api/ai-analysis-logs?action=stats 200 in 1145ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/trading-signals-fast?action=signal&coinId=bitcoin 200 in 1144ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/alerts-fast?action=process-data&coinId=bitcoin 200 in 87ms
🤖 [1754882602932-ed7t8i3fs] Starting AI analysis operation: AI_ENHANCED_ANALYSIS for bitcoin
📊 [1754882602932-ed7t8i3fs] Request data: {
  "marketData": {
    "price": {
      "usd": 117775,
      "usd_24h_change": 0.8618738474048199,
      "usd_24h_vol": 33776641957.26242,
      "usd_market_cap": 2343795976558.965
    },
    "onChain": {
      "mvrv": 1.8,
      "nupl": 0.65,
      "sopr": 1.02,
      "activeAddresses": 950000,
      "exchangeInflow": 15000,
      "exchangeOutflow": 12000,
      "transactionVolume": 25000000000,
      "supplyDistribution": {
        "whaleHoldings": {
          "percentage": 42.3,
          "addressCount": 850
        },
        "retailHoldings": {
          "percentage": 38.7,
          "addressCount": 42000000
        },
        "exchangeHoldings": {
          "percentage": 12.5,
          "addressCount": 150
        },
        "otherHoldings": {
          "percentage": 6.5,
          "addressCount": 120000
        }
      },
      "whaleHoldingsPercentage": 42.3,
      "retailHoldingsPercentage": 38.7,
      "exchangeHoldingsPercentage": 12.5
    },
    "technical": {
      "rsi": 58.5,
      "ma50": 112000,
      "ma200": 108000,
      "macd": 145.5,
      "macdSignal": null,
      "bollingerUpper": 122000,
      "bollingerLower": 111000,
      "bollingerMiddle": 116627
    },
    "derivatives": {
      "openInterest": 18500000000,
      "fundingRate": 0.0125,
      "liquidationVolume": 45000000,
      "putCallRatio": 0.85
    },
    "sentiment": {
      "fearGreedIndex": 50,
      "fearGreedClassification": "Neutral",
      "social": {
        "twitterSentiment": 0.5,
        "redditSentiment": 0.5,
        "socialVolume": 45000,
        "engagementRate": 0.085,
        "influencerSentiment": 0.75,
        "trendingScore": 75
      },
      "news": {
        "newsSentiment": 0.5,
        "newsVolume": 1250,
        "positiveNewsCount": 780,
        "negativeNewsCount": 320,
        "neutralNewsCount": 150,
        "sentimentScore": 0.5,
        "buzzScore": 75
      },
      "googleTrends": {
        "trendsScore": 75,
        "searchVolume": 850000,
        "trendingKeywords": [
          "bitcoin price",
          "btc news",
          "bitcoin mining"
        ],
        "regionalInterest": {
          "US": 85,
          "CN": 72,
          "EU": 68,
          "JP": 45,
          "KR": 52
        },
        "relatedQueries": [
          {
            "query": "bitcoin price today",
            "score": 95,
            "rising": true
          },
          {
            "query": "bitcoin prediction",
            "score": 78,
            "rising": true
          },
          {
            "query": "bitcoin mining",
            "score": 65,
            "rising": false
          }
        ],
        "trendDirection": "stable"
      }
    },
    "analysis": {
      "signal": "GIỮ",
      "confidence": 60,
      "reasoning": "Z.AI: Phân tích dựa trên dữ liệu thị trường hiện tại.... | ChatGPT: Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên q...",
      "riskLevel": "MEDIUM",
      "aiModel": "Z.AI+ChatGPT"
    },
    "timestamp": "2025-08-11T03:23:20.308Z",
    "dataSource": "database"
  },
  "tradingSignal": {
    "signal": "HOLD",
    "confidence": 50,
    "reasoning": "Tín hiệu trung lập: Không đủ điều kiện để MUA hoặc BÁN. Cần theo dõi thêm.",
    "riskLevel": "MEDIUM",
    "conditions": {
      "mvrv": 1.8,
      "fearGreed": 50,
      "fundingRate": 0.0125,
      "sopr": 1.02,
      "rsi": 58.5,
      "nupl": 0.65,
      "volumeTrend": "increasing",
      "extremeDetected": false
    },
    "triggers": []
  },
  "alerts": [
    {
      "id": "alert_1754882602796_0xfs09kqh",
      "type": "WARNING",
      "category": "FUNDING_RATE",
      "title": "High Funding Rate Detected",
      "message": "Funding rate at 1.250% indicates strong long pressure and potential squeeze risk.",
      "severity": "MEDIUM",
      "timestamp": "2025-08-11T03:23:22.795Z",
      "coinId": "bitcoin",
      "data": {
        "fundingRate": 0.0125,
        "threshold": 0.001
      },
      "triggeredBy": [
        "High funding rate"
      ],
      "actionRequired": true,
      "recommendedAction": "Monitor for potential long squeeze or price correction"
    }
  ],
  "coinId": "bitcoin"
}
🤖 Starting AI analysis for bitcoin...
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE (`main`.`analysis_history`.`coinId` = ? AND `main`.`analysis_history`.`analysisType` = ?) ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
🤖 Using cached AI analysis for bitcoin
💾 [1754882602932-ed7t8i3fs] Using cached analysis for bitcoin (age: 634666ms)
✅ [1754882602932-ed7t8i3fs] Completed AI_ENHANCED_ANALYSIS successfully (10ms)
🎯 [1754882602932-ed7t8i3fs] Final result: {
  "recommendation": "GIỮ",
  "timeframe": "Ngắn hạn",
  "riskFactors": [
    "Thị trường biến động thông thường"
  ],
  "entryPoints": "Chờ tín hiệu rõ ràng hơn trước khi vào lệnh",
  "exitPoints": "Chốt lời khi có biến động giá mạnh hoặc đạt mục tiêu lợi nhuận",
  "stopLoss": "Quản lý rủi ro chặt chẽ, stop loss tại mức biến động chấp nhận được",
  "takeProfit": "Take profit khi đạt lợi nhuận mục tiêu hoặc có thay đổi xu hướng",
  "zaiAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn",
    "breakoutPotential": "LOW",
    "reasoning": "Phân tích dựa trên dữ liệu thị trường hiện tại."
  },
  "chatGPTAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn đến trung hạn (1-4 tuần)",
    "breakoutPotential": "LOW",
    "reasoning": "Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên quan sát và chờ đợi tín hiệu tốt hơn."
  }
}
 POST /api/ai-analysis?action=analyze&coinId=bitcoin 200 in 78ms
 GET / 200 in 177ms
 GET /api/ai-analysis-logs?action=stats 200 in 42ms
 GET /favicon.ico 200 in 43ms
prisma:query SELECT 1
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT 1
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`isActive` = ? ORDER BY `main`.`cryptocurrencies`.`isDefault` DESC, `main`.`cryptocurrencies`.`rank` ASC, `main`.`cryptocurrencies`.`createdAt` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`coin_data_collection`.`id`, `main`.`coin_data_collection`.`cryptoId`, `main`.`coin_data_collection`.`status`, `main`.`coin_data_collection`.`lastCollected`, `main`.`coin_data_collection`.`nextCollection`, `main`.`coin_data_collection`.`errorCount`, `main`.`coin_data_collection`.`lastError`, `main`.`coin_data_collection`.`metadata` FROM `main`.`coin_data_collection` WHERE `main`.`coin_data_collection`.`cryptoId` IN (?,?,?,?,?) LIMIT ? OFFSET ?
 GET /api/cryptocurrencies?activeOnly=true 200 in 96ms
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE `main`.`analysis_history`.`cryptoId` = ? ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/dashboard?coinId=bitcoin 200 in 116ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/trading-signals-fast?action=signal&coinId=bitcoin 200 in 78ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/alerts-fast?action=process-data&coinId=bitcoin 200 in 75ms
🤖 [1754882606435-te0kj0z2f] Starting AI analysis operation: AI_ENHANCED_ANALYSIS for bitcoin
📊 [1754882606435-te0kj0z2f] Request data: {
  "marketData": {
    "price": {
      "usd": 117775,
      "usd_24h_change": 0.8618738474048199,
      "usd_24h_vol": 33776641957.26242,
      "usd_market_cap": 2343795976558.965
    },
    "onChain": {
      "mvrv": 1.8,
      "nupl": 0.65,
      "sopr": 1.02,
      "activeAddresses": 950000,
      "exchangeInflow": 15000,
      "exchangeOutflow": 12000,
      "transactionVolume": 25000000000,
      "supplyDistribution": {
        "whaleHoldings": {
          "percentage": 42.3,
          "addressCount": 850
        },
        "retailHoldings": {
          "percentage": 38.7,
          "addressCount": 42000000
        },
        "exchangeHoldings": {
          "percentage": 12.5,
          "addressCount": 150
        },
        "otherHoldings": {
          "percentage": 6.5,
          "addressCount": 120000
        }
      },
      "whaleHoldingsPercentage": 42.3,
      "retailHoldingsPercentage": 38.7,
      "exchangeHoldingsPercentage": 12.5
    },
    "technical": {
      "rsi": 58.5,
      "ma50": 112000,
      "ma200": 108000,
      "macd": 145.5,
      "macdSignal": null,
      "bollingerUpper": 122000,
      "bollingerLower": 111000,
      "bollingerMiddle": 116627
    },
    "derivatives": {
      "openInterest": 18500000000,
      "fundingRate": 0.0125,
      "liquidationVolume": 45000000,
      "putCallRatio": 0.85
    },
    "sentiment": {
      "fearGreedIndex": 50,
      "fearGreedClassification": "Neutral",
      "social": {
        "twitterSentiment": 0.5,
        "redditSentiment": 0.5,
        "socialVolume": 45000,
        "engagementRate": 0.085,
        "influencerSentiment": 0.75,
        "trendingScore": 75
      },
      "news": {
        "newsSentiment": 0.5,
        "newsVolume": 1250,
        "positiveNewsCount": 780,
        "negativeNewsCount": 320,
        "neutralNewsCount": 150,
        "sentimentScore": 0.5,
        "buzzScore": 75
      },
      "googleTrends": {
        "trendsScore": 75,
        "searchVolume": 850000,
        "trendingKeywords": [
          "bitcoin price",
          "btc news",
          "bitcoin mining"
        ],
        "regionalInterest": {
          "US": 85,
          "CN": 72,
          "EU": 68,
          "JP": 45,
          "KR": 52
        },
        "relatedQueries": [
          {
            "query": "bitcoin price today",
            "score": 95,
            "rising": true
          },
          {
            "query": "bitcoin prediction",
            "score": 78,
            "rising": true
          },
          {
            "query": "bitcoin mining",
            "score": 65,
            "rising": false
          }
        ],
        "trendDirection": "stable"
      }
    },
    "analysis": {
      "signal": "GIỮ",
      "confidence": 60,
      "reasoning": "Z.AI: Phân tích dựa trên dữ liệu thị trường hiện tại.... | ChatGPT: Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên q...",
      "riskLevel": "MEDIUM",
      "aiModel": "Z.AI+ChatGPT"
    },
    "timestamp": "2025-08-11T03:23:25.954Z",
    "dataSource": "database"
  },
  "tradingSignal": {
    "signal": "HOLD",
    "confidence": 50,
    "reasoning": "Tín hiệu trung lập: Không đủ điều kiện để MUA hoặc BÁN. Cần theo dõi thêm.",
    "riskLevel": "MEDIUM",
    "conditions": {
      "mvrv": 1.8,
      "fearGreed": 50,
      "fundingRate": 0.0125,
      "sopr": 1.02,
      "rsi": 58.5,
      "nupl": 0.65,
      "volumeTrend": "increasing",
      "extremeDetected": false
    },
    "triggers": []
  },
  "alerts": [
    {
      "id": "alert_1754882606338_te0xt1t0t",
      "type": "WARNING",
      "category": "DERIVATIVES",
      "title": "High Open Interest Detected",
      "message": "Open interest at $18.5B is near historical highs - increased volatility risk.",
      "severity": "MEDIUM",
      "timestamp": "2025-08-11T03:23:26.338Z",
      "coinId": "bitcoin",
      "data": {
        "openInterest": 18500000000,
        "historicalHigh": 18500000000,
        "percentage": "100.0"
      },
      "triggeredBy": [
        "High open interest"
      ],
      "actionRequired": true,
      "recommendedAction": "Prepare for increased volatility and potential liquidations"
    }
  ],
  "coinId": "bitcoin"
}
🤖 Starting AI analysis for bitcoin...
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE (`main`.`analysis_history`.`coinId` = ? AND `main`.`analysis_history`.`analysisType` = ?) ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
🤖 Using cached AI analysis for bitcoin
💾 [1754882606435-te0kj0z2f] Using cached analysis for bitcoin (age: 638165ms)
✅ [1754882606435-te0kj0z2f] Completed AI_ENHANCED_ANALYSIS successfully (5ms)
🎯 [1754882606435-te0kj0z2f] Final result: {
  "recommendation": "GIỮ",
  "timeframe": "Ngắn hạn",
  "riskFactors": [
    "Thị trường biến động thông thường"
  ],
  "entryPoints": "Chờ tín hiệu rõ ràng hơn trước khi vào lệnh",
  "exitPoints": "Chốt lời khi có biến động giá mạnh hoặc đạt mục tiêu lợi nhuận",
  "stopLoss": "Quản lý rủi ro chặt chẽ, stop loss tại mức biến động chấp nhận được",
  "takeProfit": "Take profit khi đạt lợi nhuận mục tiêu hoặc có thay đổi xu hướng",
  "zaiAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn",
    "breakoutPotential": "LOW",
    "reasoning": "Phân tích dựa trên dữ liệu thị trường hiện tại."
  },
  "chatGPTAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn đến trung hạn (1-4 tuần)",
    "breakoutPotential": "LOW",
    "reasoning": "Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên quan sát và chờ đợi tín hiệu tốt hơn."
  }
}
 POST /api/ai-analysis?action=analyze&coinId=bitcoin 200 in 41ms
 GET / 200 in 68ms
 GET /favicon.ico 200 in 47ms
 GET /api/ai-analysis-logs?action=recent&count=10 200 in 61ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`isActive` = ? ORDER BY `main`.`cryptocurrencies`.`isDefault` DESC, `main`.`cryptocurrencies`.`rank` ASC, `main`.`cryptocurrencies`.`createdAt` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`coin_data_collection`.`id`, `main`.`coin_data_collection`.`cryptoId`, `main`.`coin_data_collection`.`status`, `main`.`coin_data_collection`.`lastCollected`, `main`.`coin_data_collection`.`nextCollection`, `main`.`coin_data_collection`.`errorCount`, `main`.`coin_data_collection`.`lastError`, `main`.`coin_data_collection`.`metadata` FROM `main`.`coin_data_collection` WHERE `main`.`coin_data_collection`.`cryptoId` IN (?,?,?,?,?) LIMIT ? OFFSET ?
 GET /api/cryptocurrencies?activeOnly=true 200 in 58ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE `main`.`analysis_history`.`cryptoId` = ? ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/dashboard?coinId=bitcoin 200 in 123ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/trading-signals-fast?action=signal&coinId=bitcoin 200 in 76ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/alerts-fast?action=process-data&coinId=bitcoin 200 in 76ms
🤖 [1754882610426-e48qf2qlx] Starting AI analysis operation: AI_ENHANCED_ANALYSIS for bitcoin
📊 [1754882610426-e48qf2qlx] Request data: {
  "marketData": {
    "price": {
      "usd": 117775,
      "usd_24h_change": 0.8618738474048199,
      "usd_24h_vol": 33776641957.26242,
      "usd_market_cap": 2343795976558.965
    },
    "onChain": {
      "mvrv": 1.8,
      "nupl": 0.65,
      "sopr": 1.02,
      "activeAddresses": 950000,
      "exchangeInflow": 15000,
      "exchangeOutflow": 12000,
      "transactionVolume": 25000000000,
      "supplyDistribution": {
        "whaleHoldings": {
          "percentage": 42.3,
          "addressCount": 850
        },
        "retailHoldings": {
          "percentage": 38.7,
          "addressCount": 42000000
        },
        "exchangeHoldings": {
          "percentage": 12.5,
          "addressCount": 150
        },
        "otherHoldings": {
          "percentage": 6.5,
          "addressCount": 120000
        }
      },
      "whaleHoldingsPercentage": 42.3,
      "retailHoldingsPercentage": 38.7,
      "exchangeHoldingsPercentage": 12.5
    },
    "technical": {
      "rsi": 58.5,
      "ma50": 112000,
      "ma200": 108000,
      "macd": 145.5,
      "macdSignal": null,
      "bollingerUpper": 122000,
      "bollingerLower": 111000,
      "bollingerMiddle": 116627
    },
    "derivatives": {
      "openInterest": 18500000000,
      "fundingRate": 0.0125,
      "liquidationVolume": 45000000,
      "putCallRatio": 0.85
    },
    "sentiment": {
      "fearGreedIndex": 50,
      "fearGreedClassification": "Neutral",
      "social": {
        "twitterSentiment": 0.5,
        "redditSentiment": 0.5,
        "socialVolume": 45000,
        "engagementRate": 0.085,
        "influencerSentiment": 0.75,
        "trendingScore": 75
      },
      "news": {
        "newsSentiment": 0.5,
        "newsVolume": 1250,
        "positiveNewsCount": 780,
        "negativeNewsCount": 320,
        "neutralNewsCount": 150,
        "sentimentScore": 0.5,
        "buzzScore": 75
      },
      "googleTrends": {
        "trendsScore": 75,
        "searchVolume": 850000,
        "trendingKeywords": [
          "bitcoin price",
          "btc news",
          "bitcoin mining"
        ],
        "regionalInterest": {
          "US": 85,
          "CN": 72,
          "EU": 68,
          "JP": 45,
          "KR": 52
        },
        "relatedQueries": [
          {
            "query": "bitcoin price today",
            "score": 95,
            "rising": true
          },
          {
            "query": "bitcoin prediction",
            "score": 78,
            "rising": true
          },
          {
            "query": "bitcoin mining",
            "score": 65,
            "rising": false
          }
        ],
        "trendDirection": "stable"
      }
    },
    "analysis": {
      "signal": "GIỮ",
      "confidence": 60,
      "reasoning": "Z.AI: Phân tích dựa trên dữ liệu thị trường hiện tại.... | ChatGPT: Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên q...",
      "riskLevel": "MEDIUM",
      "aiModel": "Z.AI+ChatGPT"
    },
    "timestamp": "2025-08-11T03:23:30.030Z",
    "dataSource": "database"
  },
  "tradingSignal": {
    "signal": "HOLD",
    "confidence": 50,
    "reasoning": "Tín hiệu trung lập: Không đủ điều kiện để MUA hoặc BÁN. Cần theo dõi thêm.",
    "riskLevel": "MEDIUM",
    "conditions": {
      "mvrv": 1.8,
      "fearGreed": 50,
      "fundingRate": 0.0125,
      "sopr": 1.02,
      "rsi": 58.5,
      "nupl": 0.65,
      "volumeTrend": "increasing",
      "extremeDetected": false
    },
    "triggers": []
  },
  "alerts": [],
  "coinId": "bitcoin"
}
🤖 Starting AI analysis for bitcoin...
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE (`main`.`analysis_history`.`coinId` = ? AND `main`.`analysis_history`.`analysisType` = ?) ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
🤖 Using cached AI analysis for bitcoin
💾 [1754882610426-e48qf2qlx] Using cached analysis for bitcoin (age: 642156ms)
✅ [1754882610426-e48qf2qlx] Completed AI_ENHANCED_ANALYSIS successfully (5ms)
🎯 [1754882610426-e48qf2qlx] Final result: {
  "recommendation": "GIỮ",
  "timeframe": "Ngắn hạn",
  "riskFactors": [
    "Thị trường biến động thông thường"
  ],
  "entryPoints": "Chờ tín hiệu rõ ràng hơn trước khi vào lệnh",
  "exitPoints": "Chốt lời khi có biến động giá mạnh hoặc đạt mục tiêu lợi nhuận",
  "stopLoss": "Quản lý rủi ro chặt chẽ, stop loss tại mức biến động chấp nhận được",
  "takeProfit": "Take profit khi đạt lợi nhuận mục tiêu hoặc có thay đổi xu hướng",
  "zaiAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn",
    "breakoutPotential": "LOW",
    "reasoning": "Phân tích dựa trên dữ liệu thị trường hiện tại."
  },
  "chatGPTAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn đến trung hạn (1-4 tuần)",
    "breakoutPotential": "LOW",
    "reasoning": "Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên quan sát và chờ đợi tín hiệu tốt hơn."
  }
}
 POST /api/ai-analysis?action=analyze&coinId=bitcoin 200 in 53ms
 GET / 200 in 75ms
 GET /favicon.ico 200 in 104ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
 GET /api/cryptocurrencies?activeOnly=true 200 in 88ms
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`isActive` = ? ORDER BY `main`.`cryptocurrencies`.`isDefault` DESC, `main`.`cryptocurrencies`.`rank` ASC, `main`.`cryptocurrencies`.`createdAt` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`coin_data_collection`.`id`, `main`.`coin_data_collection`.`cryptoId`, `main`.`coin_data_collection`.`status`, `main`.`coin_data_collection`.`lastCollected`, `main`.`coin_data_collection`.`nextCollection`, `main`.`coin_data_collection`.`errorCount`, `main`.`coin_data_collection`.`lastError`, `main`.`coin_data_collection`.`metadata` FROM `main`.`coin_data_collection` WHERE `main`.`coin_data_collection`.`cryptoId` IN (?,?,?,?,?) LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE `main`.`analysis_history`.`cryptoId` = ? ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/dashboard?coinId=bitcoin 200 in 117ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/trading-signals-fast?action=signal&coinId=bitcoin 200 in 75ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/alerts-fast?action=process-data&coinId=bitcoin 200 in 65ms
🤖 [1754882613492-ad19k5b8j] Starting AI analysis operation: AI_ENHANCED_ANALYSIS for bitcoin
📊 [1754882613492-ad19k5b8j] Request data: {
  "marketData": {
    "price": {
      "usd": 117775,
      "usd_24h_change": 0.8618738474048199,
      "usd_24h_vol": 33776641957.26242,
      "usd_market_cap": 2343795976558.965
    },
    "onChain": {
      "mvrv": 1.8,
      "nupl": 0.65,
      "sopr": 1.02,
      "activeAddresses": 950000,
      "exchangeInflow": 15000,
      "exchangeOutflow": 12000,
      "transactionVolume": 25000000000,
      "supplyDistribution": {
        "whaleHoldings": {
          "percentage": 42.3,
          "addressCount": 850
        },
        "retailHoldings": {
          "percentage": 38.7,
          "addressCount": 42000000
        },
        "exchangeHoldings": {
          "percentage": 12.5,
          "addressCount": 150
        },
        "otherHoldings": {
          "percentage": 6.5,
          "addressCount": 120000
        }
      },
      "whaleHoldingsPercentage": 42.3,
      "retailHoldingsPercentage": 38.7,
      "exchangeHoldingsPercentage": 12.5
    },
    "technical": {
      "rsi": 58.5,
      "ma50": 112000,
      "ma200": 108000,
      "macd": 145.5,
      "macdSignal": null,
      "bollingerUpper": 122000,
      "bollingerLower": 111000,
      "bollingerMiddle": 116627
    },
    "derivatives": {
      "openInterest": 18500000000,
      "fundingRate": 0.0125,
      "liquidationVolume": 45000000,
      "putCallRatio": 0.85
    },
    "sentiment": {
      "fearGreedIndex": 50,
      "fearGreedClassification": "Neutral",
      "social": {
        "twitterSentiment": 0.5,
        "redditSentiment": 0.5,
        "socialVolume": 45000,
        "engagementRate": 0.085,
        "influencerSentiment": 0.75,
        "trendingScore": 75
      },
      "news": {
        "newsSentiment": 0.5,
        "newsVolume": 1250,
        "positiveNewsCount": 780,
        "negativeNewsCount": 320,
        "neutralNewsCount": 150,
        "sentimentScore": 0.5,
        "buzzScore": 75
      },
      "googleTrends": {
        "trendsScore": 75,
        "searchVolume": 850000,
        "trendingKeywords": [
          "bitcoin price",
          "btc news",
          "bitcoin mining"
        ],
        "regionalInterest": {
          "US": 85,
          "CN": 72,
          "EU": 68,
          "JP": 45,
          "KR": 52
        },
        "relatedQueries": [
          {
            "query": "bitcoin price today",
            "score": 95,
            "rising": true
          },
          {
            "query": "bitcoin prediction",
            "score": 78,
            "rising": true
          },
          {
            "query": "bitcoin mining",
            "score": 65,
            "rising": false
          }
        ],
        "trendDirection": "stable"
      }
    },
    "analysis": {
      "signal": "GIỮ",
      "confidence": 60,
      "reasoning": "Z.AI: Phân tích dựa trên dữ liệu thị trường hiện tại.... | ChatGPT: Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên q...",
      "riskLevel": "MEDIUM",
      "aiModel": "Z.AI+ChatGPT"
    },
    "timestamp": "2025-08-11T03:23:32.907Z",
    "dataSource": "database"
  },
  "tradingSignal": {
    "signal": "HOLD",
    "confidence": 50,
    "reasoning": "Tín hiệu trung lập: Không đủ điều kiện để MUA hoặc BÁN. Cần theo dõi thêm.",
    "riskLevel": "MEDIUM",
    "conditions": {
      "mvrv": 1.8,
      "fearGreed": 50,
      "fundingRate": 0.0125,
      "sopr": 1.02,
      "rsi": 58.5,
      "nupl": 0.65,
      "volumeTrend": "increasing",
      "extremeDetected": false
    },
    "triggers": []
  },
  "alerts": [],
  "coinId": "bitcoin"
}
🤖 Starting AI analysis for bitcoin...
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE (`main`.`analysis_history`.`coinId` = ? AND `main`.`analysis_history`.`analysisType` = ?) ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
🤖 Using cached AI analysis for bitcoin
💾 [1754882613492-ad19k5b8j] Using cached analysis for bitcoin (age: 645223ms)
✅ [1754882613492-ad19k5b8j] Completed AI_ENHANCED_ANALYSIS successfully (6ms)
🎯 [1754882613492-ad19k5b8j] Final result: {
  "recommendation": "GIỮ",
  "timeframe": "Ngắn hạn",
  "riskFactors": [
    "Thị trường biến động thông thường"
  ],
  "entryPoints": "Chờ tín hiệu rõ ràng hơn trước khi vào lệnh",
  "exitPoints": "Chốt lời khi có biến động giá mạnh hoặc đạt mục tiêu lợi nhuận",
  "stopLoss": "Quản lý rủi ro chặt chẽ, stop loss tại mức biến động chấp nhận được",
  "takeProfit": "Take profit khi đạt lợi nhuận mục tiêu hoặc có thay đổi xu hướng",
  "zaiAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn",
    "breakoutPotential": "LOW",
    "reasoning": "Phân tích dựa trên dữ liệu thị trường hiện tại."
  },
  "chatGPTAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn đến trung hạn (1-4 tuần)",
    "breakoutPotential": "LOW",
    "reasoning": "Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên quan sát và chờ đợi tín hiệu tốt hơn."
  }
}
 POST /api/ai-analysis?action=analyze&coinId=bitcoin 200 in 51ms
🤖 [1754882615125-gu37f15cb] Starting AI analysis operation: AI_ENHANCED_ANALYSIS for ethereum
📊 [1754882615125-gu37f15cb] Request data: {
  "marketData": {
    "price": {
      "usd": 3000,
      "usd_24h_change": -1.2,
      "usd_24h_vol": 15000000000,
      "usd_market_cap": 360000000000
    },
    "technical": {
      "rsi": 45,
      "ma50": 3100,
      "ma200": 2900,
      "macd": -0.3
    },
    "onChain": {
      "mvrv": 1.2,
      "nupl": 0.1,
      "sopr": 0.9,
      "activeAddresses": 500000
    },
    "sentiment": {
      "fearGreedIndex": 45,
      "fearGreedClassification": "Fear"
    }
  }
}
🤖 Starting AI analysis for ethereum...
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE (`main`.`analysis_history`.`coinId` = ? AND `main`.`analysis_history`.`analysisType` = ?) ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
💬 [Z.AI] Sending prompt to Z.AI:
📝 [Z.AI] Prompt content: PHÂN TÍCH THỊ TRƯỜNG ETHEREUM
========================================

DỮ LIỆU GIÁ:
- Giá hiện tại: $3,000
- Thay đổi 24h: -1.20%
- Khối lượng 24h: $15.0B
- Vốn hóa thị trường: $0.4T

CHỈ BÁO ON-CHAIN:
- MVRV Ratio: 1.20
- NUPL: 0.10
- SOPR: 0.90
- Địa chỉ hoạt động: 500,000

CHỈ BÁO KỸ THUẬT:
- RSI: 45.00 (Trung lập)
- MA50: $3,100
- MA200: $2,900
- MACD: -0.30

TÂM LÝ THỊ TRƯỜNG:
- Fear & Greed Index: 45 (Fear)

YÊU CẦU PHÂN TÍCH:
==================
Hãy cung cấp phân tích chi tiết và khuyến nghị đầu tư cho Ethereum dựa trên tất cả dữ liệu trên. Cân nhắc:

1. PHÂN TÍCH KỸ THUẬT:
   - Đánh giá động lượng và xu hướng dựa trên RSI, MACD
   - Phân tích vị trí giá so với đường trung bình động
   - Xem xét biến động và dải Bollinger

2. PHÂN TÍCH ON-CHAIN:
   - Đánh giá định giá dựa trên MVRV và NUPL
   - Phân tích hành vi của holder và mức lợi nhuận/thua lỗ

3. TÂM LÝ THỊ TRƯỜNG:
   - Diễn giải Fear & Greed Index trong bối cảnh giá hiện tại
   - Đánh giá tâm lý thị trường và các điểm cực đoan

4. QUẢN LÝ RỦI RO:
   - Xác định các yếu tố rủi ro chính
   - Đề xuất mức stop-loss và take-profit phù hợp

5. KHUYẾN NGHỊ ĐẦU TƯ:
   - Tín hiệu rõ ràng: MUA MẠNH, MUA, GIỮ, BÁN, BÁN MẠNH
   - Mức độ tin cậy (0-100)
   - Khung thời gian phân tích
   - Tiềm năng breakout (LOW/MEDIUM/HIGH)
   - Lý do chi tiết

Định dạng trả lời JSON:
{
  "recommendation": "MUA|BÁN|GIỮ|MUA MẠNH|BÁN MẠNH",
  "confidence": 0-100,
  "timeframe": "ví dụ: Ngắn hạn (1-2 tuần)",
  "breakoutPotential": "LOW|MEDIUM|HIGH",
  "reasoning": "lý do chi tiết bằng tiếng Việt"
}

Failed to make API request: TypeError: fetch failed
    at async generateEnhancedAIAnalysis (src/app/api/ai-analysis/route.ts:332:27)
    at async performAIAnalysis (src/app/api/ai-analysis/route.ts:176:29)
    at async POST (src/app/api/ai-analysis/route.ts:55:13)
  330 |       
  331 |       try {
> 332 |         const completion = await zai.chat.completions.create({
      |                           ^
  333 |           messages: [
  334 |             {
  335 |               role: 'system', {
  [cause]: [Error: getaddrinfo ENOTFOUND api.z-ai.dev] {
    errno: -3008,
    code: 'ENOTFOUND',
    syscall: 'getaddrinfo',
    hostname: 'api.z-ai.dev'
  }
}
Z.AI analysis failed, using fallback: fetch failed
🤖 [Z.AI] Received response from Z.AI (246ms):
📋 [Z.AI] Response: {
  "error": "fetch failed"
}
🤖 [ChatGPT] Received response from ChatGPT (0ms):
📋 [ChatGPT] Response: {
  "recommendation": "GIỮ",
  "confidence": 60,
  "timeframe": "Ngắn hạn đến trung hạn (1-4 tuần)",
  "breakoutPotential": "LOW",
  "reasoning": "Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên quan sát và chờ đợi tín hiệu tốt hơn."
}
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query INSERT INTO `main`.`analysis_history` (`id`, `cryptoId`, `coinId`, `signal`, `confidence`, `reasoning`, `riskLevel`, `aiModel`, `analysisType`, `analysisData`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `cryptoId` AS `cryptoId`, `coinId` AS `coinId`, `signal` AS `signal`, `confidence` AS `confidence`, `reasoning` AS `reasoning`, `riskLevel` AS `riskLevel`, `aiModel` AS `aiModel`, `analysisType` AS `analysisType`, `analysisData` AS `analysisData`, `metricsData` AS `metricsData`, `timestamp` AS `timestamp`
✅ AI analysis saved to database for ethereum
💿 [1754882615125-gu37f15cb] Database save_analysis successful: {
  "cryptoId": "cme59qgpp0003pe499bz0lev5",
  "coinId": "ethereum",
  "analysisType": "AI_ENHANCED",
  "analysisData": "{\"recommendation\":\"GIỮ\",\"timeframe\":\"Ngắn hạn\",\"riskFactors\":[\"Thị trường biến động thông thường\"],\"entryPoints\":\"Chờ tín hiệu rõ ràng hơn trước khi vào lệnh\",\"exitPoints\":\"Chốt lời khi có biến động giá mạnh hoặc đạt mục tiêu lợi nhuận\",\"stopLoss\":\"Quản lý rủi ro chặt chẽ, stop loss tại mức biến động chấp nhận được\",\"takeProfit\":\"Take profit khi đạt lợi nhuận mục tiêu hoặc có thay đổi xu hướng\",\"zaiAnalysis\":{\"recommendation\":\"GIỮ\",\"confidence\":60,\"timeframe\":\"Ngắn hạn\",\"breakoutPotential\":\"LOW\",\"reasoning\":\"Phân tích dựa trên dữ liệu thị trường hiện tại.\"},\"chatGPTAnalysis\":{\"recommendation\":\"GIỮ\",\"confidence\":60,\"timeframe\":\"Ngắn hạn đến trung hạn (1-4 tuần)\",\"breakoutPotential\":\"LOW\",\"reasoning\":\"Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên quan sát và chờ đợi tín hiệu tốt hơn.\"}}",
  "signal": "GIỮ",
  "confidence": 60,
  "reasoning": "Z.AI: Phân tích dựa trên dữ liệu thị trường hiện tại.... | ChatGPT: Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên q...",
  "riskLevel": "MEDIUM",
  "aiModel": "Z.AI+ChatGPT"
}
✅ [3:23:35 AM] AI_ENHANCED_ANALYSIS - ethereum (650ms)
   Metadata: {
  analysisType: 'AI_ENHANCED',
  marketDataPoints: 4,
  alertsCount: 0,
  cacheUsed: false,
  aiModelsUsed: [ 'Z.AI', 'ChatGPT' ]
}
✅ [1754882615125-gu37f15cb] Completed AI_ENHANCED_ANALYSIS successfully (650ms)
🎯 [1754882615125-gu37f15cb] Final result: {
  "recommendation": "GIỮ",
  "timeframe": "Ngắn hạn",
  "riskFactors": [
    "Thị trường biến động thông thường"
  ],
  "entryPoints": "Chờ tín hiệu rõ ràng hơn trước khi vào lệnh",
  "exitPoints": "Chốt lời khi có biến động giá mạnh hoặc đạt mục tiêu lợi nhuận",
  "stopLoss": "Quản lý rủi ro chặt chẽ, stop loss tại mức biến động chấp nhận được",
  "takeProfit": "Take profit khi đạt lợi nhuận mục tiêu hoặc có thay đổi xu hướng",
  "zaiAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn",
    "breakoutPotential": "LOW",
    "reasoning": "Phân tích dựa trên dữ liệu thị trường hiện tại."
  },
  "chatGPTAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn đến trung hạn (1-4 tuần)",
    "breakoutPotential": "LOW",
    "reasoning": "Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên quan sát và chờ đợi tín hiệu tốt hơn."
  }
}
 POST /api/ai-analysis?action=analyze&coinId=ethereum 200 in 716ms
 GET / 200 in 61ms
 GET /favicon.ico 200 in 50ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`isActive` = ? ORDER BY `main`.`cryptocurrencies`.`isDefault` DESC, `main`.`cryptocurrencies`.`rank` ASC, `main`.`cryptocurrencies`.`createdAt` DESC LIMIT ? OFFSET ?
 GET /api/cryptocurrencies?activeOnly=true 200 in 63ms
prisma:query SELECT `main`.`coin_data_collection`.`id`, `main`.`coin_data_collection`.`cryptoId`, `main`.`coin_data_collection`.`status`, `main`.`coin_data_collection`.`lastCollected`, `main`.`coin_data_collection`.`nextCollection`, `main`.`coin_data_collection`.`errorCount`, `main`.`coin_data_collection`.`lastError`, `main`.`coin_data_collection`.`metadata` FROM `main`.`coin_data_collection` WHERE `main`.`coin_data_collection`.`cryptoId` IN (?,?,?,?,?) LIMIT ? OFFSET ?
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE `main`.`analysis_history`.`cryptoId` = ? ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/dashboard?coinId=bitcoin 200 in 94ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/trading-signals-fast?action=signal&coinId=bitcoin 200 in 89ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/alerts-fast?action=process-data&coinId=bitcoin 200 in 64ms
🤖 [1754882620101-nbx9pyt3b] Starting AI analysis operation: AI_ENHANCED_ANALYSIS for bitcoin
📊 [1754882620101-nbx9pyt3b] Request data: {
  "marketData": {
    "price": {
      "usd": 117775,
      "usd_24h_change": 0.8618738474048199,
      "usd_24h_vol": 33776641957.26242,
      "usd_market_cap": 2343795976558.965
    },
    "onChain": {
      "mvrv": 1.8,
      "nupl": 0.65,
      "sopr": 1.02,
      "activeAddresses": 950000,
      "exchangeInflow": 15000,
      "exchangeOutflow": 12000,
      "transactionVolume": 25000000000,
      "supplyDistribution": {
        "whaleHoldings": {
          "percentage": 42.3,
          "addressCount": 850
        },
        "retailHoldings": {
          "percentage": 38.7,
          "addressCount": 42000000
        },
        "exchangeHoldings": {
          "percentage": 12.5,
          "addressCount": 150
        },
        "otherHoldings": {
          "percentage": 6.5,
          "addressCount": 120000
        }
      },
      "whaleHoldingsPercentage": 42.3,
      "retailHoldingsPercentage": 38.7,
      "exchangeHoldingsPercentage": 12.5
    },
    "technical": {
      "rsi": 58.5,
      "ma50": 112000,
      "ma200": 108000,
      "macd": 145.5,
      "macdSignal": null,
      "bollingerUpper": 122000,
      "bollingerLower": 111000,
      "bollingerMiddle": 116627
    },
    "derivatives": {
      "openInterest": 18500000000,
      "fundingRate": 0.0125,
      "liquidationVolume": 45000000,
      "putCallRatio": 0.85
    },
    "sentiment": {
      "fearGreedIndex": 50,
      "fearGreedClassification": "Neutral",
      "social": {
        "twitterSentiment": 0.5,
        "redditSentiment": 0.5,
        "socialVolume": 45000,
        "engagementRate": 0.085,
        "influencerSentiment": 0.75,
        "trendingScore": 75
      },
      "news": {
        "newsSentiment": 0.5,
        "newsVolume": 1250,
        "positiveNewsCount": 780,
        "negativeNewsCount": 320,
        "neutralNewsCount": 150,
        "sentimentScore": 0.5,
        "buzzScore": 75
      },
      "googleTrends": {
        "trendsScore": 75,
        "searchVolume": 850000,
        "trendingKeywords": [
          "bitcoin price",
          "btc news",
          "bitcoin mining"
        ],
        "regionalInterest": {
          "US": 85,
          "CN": 72,
          "EU": 68,
          "JP": 45,
          "KR": 52
        },
        "relatedQueries": [
          {
            "query": "bitcoin price today",
            "score": 95,
            "rising": true
          },
          {
            "query": "bitcoin prediction",
            "score": 78,
            "rising": true
          },
          {
            "query": "bitcoin mining",
            "score": 65,
            "rising": false
          }
        ],
        "trendDirection": "stable"
      }
    },
    "analysis": {
      "signal": "GIỮ",
      "confidence": 60,
      "reasoning": "Z.AI: Phân tích dựa trên dữ liệu thị trường hiện tại.... | ChatGPT: Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên q...",
      "riskLevel": "MEDIUM",
      "aiModel": "Z.AI+ChatGPT"
    },
    "timestamp": "2025-08-11T03:23:39.683Z",
    "dataSource": "database"
  },
  "tradingSignal": {
    "signal": "HOLD",
    "confidence": 50,
    "reasoning": "Tín hiệu trung lập: Không đủ điều kiện để MUA hoặc BÁN. Cần theo dõi thêm.",
    "riskLevel": "MEDIUM",
    "conditions": {
      "mvrv": 1.8,
      "fearGreed": 50,
      "fundingRate": 0.0125,
      "sopr": 1.02,
      "rsi": 58.5,
      "nupl": 0.65,
      "volumeTrend": "increasing",
      "extremeDetected": false
    },
    "triggers": []
  },
  "alerts": [],
  "coinId": "bitcoin"
}
🤖 Starting AI analysis for bitcoin...
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE (`main`.`analysis_history`.`coinId` = ? AND `main`.`analysis_history`.`analysisType` = ?) ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
🤖 Using cached AI analysis for bitcoin
💾 [1754882620101-nbx9pyt3b] Using cached analysis for bitcoin (age: 651832ms)
✅ [1754882620101-nbx9pyt3b] Completed AI_ENHANCED_ANALYSIS successfully (6ms)
🎯 [1754882620101-nbx9pyt3b] Final result: {
  "recommendation": "GIỮ",
  "timeframe": "Ngắn hạn",
  "riskFactors": [
    "Thị trường biến động thông thường"
  ],
  "entryPoints": "Chờ tín hiệu rõ ràng hơn trước khi vào lệnh",
  "exitPoints": "Chốt lời khi có biến động giá mạnh hoặc đạt mục tiêu lợi nhuận",
  "stopLoss": "Quản lý rủi ro chặt chẽ, stop loss tại mức biến động chấp nhận được",
  "takeProfit": "Take profit khi đạt lợi nhuận mục tiêu hoặc có thay đổi xu hướng",
  "zaiAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn",
    "breakoutPotential": "LOW",
    "reasoning": "Phân tích dựa trên dữ liệu thị trường hiện tại."
  },
  "chatGPTAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn đến trung hạn (1-4 tuần)",
    "breakoutPotential": "LOW",
    "reasoning": "Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên quan sát và chờ đợi tín hiệu tốt hơn."
  }
}
 POST /api/ai-analysis?action=analyze&coinId=bitcoin 200 in 48ms
 GET / 200 in 61ms
 GET /favicon.ico 200 in 39ms
prisma:query SELECT 1
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`isActive` = ? ORDER BY `main`.`cryptocurrencies`.`isDefault` DESC, `main`.`cryptocurrencies`.`rank` ASC, `main`.`cryptocurrencies`.`createdAt` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`coin_data_collection`.`id`, `main`.`coin_data_collection`.`cryptoId`, `main`.`coin_data_collection`.`status`, `main`.`coin_data_collection`.`lastCollected`, `main`.`coin_data_collection`.`nextCollection`, `main`.`coin_data_collection`.`errorCount`, `main`.`coin_data_collection`.`lastError`, `main`.`coin_data_collection`.`metadata` FROM `main`.`coin_data_collection` WHERE `main`.`coin_data_collection`.`cryptoId` IN (?,?,?,?,?) LIMIT ? OFFSET ?
 GET /api/cryptocurrencies?activeOnly=true 200 in 69ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE `main`.`analysis_history`.`cryptoId` = ? ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/dashboard?coinId=bitcoin 200 in 116ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/trading-signals-fast?action=signal&coinId=bitcoin 200 in 71ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/alerts-fast?action=process-data&coinId=bitcoin 200 in 118ms
🤖 [1754882623751-oss4kkb6n] Starting AI analysis operation: AI_ENHANCED_ANALYSIS for bitcoin
📊 [1754882623751-oss4kkb6n] Request data: {
  "marketData": {
    "price": {
      "usd": 117775,
      "usd_24h_change": 0.8618738474048199,
      "usd_24h_vol": 33776641957.26242,
      "usd_market_cap": 2343795976558.965
    },
    "onChain": {
      "mvrv": 1.8,
      "nupl": 0.65,
      "sopr": 1.02,
      "activeAddresses": 950000,
      "exchangeInflow": 15000,
      "exchangeOutflow": 12000,
      "transactionVolume": 25000000000,
      "supplyDistribution": {
        "whaleHoldings": {
          "percentage": 42.3,
          "addressCount": 850
        },
        "retailHoldings": {
          "percentage": 38.7,
          "addressCount": 42000000
        },
        "exchangeHoldings": {
          "percentage": 12.5,
          "addressCount": 150
        },
        "otherHoldings": {
          "percentage": 6.5,
          "addressCount": 120000
        }
      },
      "whaleHoldingsPercentage": 42.3,
      "retailHoldingsPercentage": 38.7,
      "exchangeHoldingsPercentage": 12.5
    },
    "technical": {
      "rsi": 58.5,
      "ma50": 112000,
      "ma200": 108000,
      "macd": 145.5,
      "macdSignal": null,
      "bollingerUpper": 122000,
      "bollingerLower": 111000,
      "bollingerMiddle": 116627
    },
    "derivatives": {
      "openInterest": 18500000000,
      "fundingRate": 0.0125,
      "liquidationVolume": 45000000,
      "putCallRatio": 0.85
    },
    "sentiment": {
      "fearGreedIndex": 50,
      "fearGreedClassification": "Neutral",
      "social": {
        "twitterSentiment": 0.5,
        "redditSentiment": 0.5,
        "socialVolume": 45000,
        "engagementRate": 0.085,
        "influencerSentiment": 0.75,
        "trendingScore": 75
      },
      "news": {
        "newsSentiment": 0.5,
        "newsVolume": 1250,
        "positiveNewsCount": 780,
        "negativeNewsCount": 320,
        "neutralNewsCount": 150,
        "sentimentScore": 0.5,
        "buzzScore": 75
      },
      "googleTrends": {
        "trendsScore": 75,
        "searchVolume": 850000,
        "trendingKeywords": [
          "bitcoin price",
          "btc news",
          "bitcoin mining"
        ],
        "regionalInterest": {
          "US": 85,
          "CN": 72,
          "EU": 68,
          "JP": 45,
          "KR": 52
        },
        "relatedQueries": [
          {
            "query": "bitcoin price today",
            "score": 95,
            "rising": true
          },
          {
            "query": "bitcoin prediction",
            "score": 78,
            "rising": true
          },
          {
            "query": "bitcoin mining",
            "score": 65,
            "rising": false
          }
        ],
        "trendDirection": "stable"
      }
    },
    "analysis": {
      "signal": "GIỮ",
      "confidence": 60,
      "reasoning": "Z.AI: Phân tích dựa trên dữ liệu thị trường hiện tại.... | ChatGPT: Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên q...",
      "riskLevel": "MEDIUM",
      "aiModel": "Z.AI+ChatGPT"
    },
    "timestamp": "2025-08-11T03:23:43.143Z",
    "dataSource": "database"
  },
  "tradingSignal": {
    "signal": "HOLD",
    "confidence": 50,
    "reasoning": "Tín hiệu trung lập: Không đủ điều kiện để MUA hoặc BÁN. Cần theo dõi thêm.",
    "riskLevel": "MEDIUM",
    "conditions": {
      "mvrv": 1.8,
      "fearGreed": 50,
      "fundingRate": 0.0125,
      "sopr": 1.02,
      "rsi": 58.5,
      "nupl": 0.65,
      "volumeTrend": "increasing",
      "extremeDetected": false
    },
    "triggers": []
  },
  "alerts": [],
  "coinId": "bitcoin"
}
🤖 Starting AI analysis for bitcoin...
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE (`main`.`analysis_history`.`coinId` = ? AND `main`.`analysis_history`.`analysisType` = ?) ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
🤖 Using cached AI analysis for bitcoin
💾 [1754882623751-oss4kkb6n] Using cached analysis for bitcoin (age: 655482ms)
✅ [1754882623751-oss4kkb6n] Completed AI_ENHANCED_ANALYSIS successfully (6ms)
🎯 [1754882623751-oss4kkb6n] Final result: {
  "recommendation": "GIỮ",
  "timeframe": "Ngắn hạn",
  "riskFactors": [
    "Thị trường biến động thông thường"
  ],
  "entryPoints": "Chờ tín hiệu rõ ràng hơn trước khi vào lệnh",
  "exitPoints": "Chốt lời khi có biến động giá mạnh hoặc đạt mục tiêu lợi nhuận",
  "stopLoss": "Quản lý rủi ro chặt chẽ, stop loss tại mức biến động chấp nhận được",
  "takeProfit": "Take profit khi đạt lợi nhuận mục tiêu hoặc có thay đổi xu hướng",
  "zaiAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn",
    "breakoutPotential": "LOW",
    "reasoning": "Phân tích dựa trên dữ liệu thị trường hiện tại."
  },
  "chatGPTAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn đến trung hạn (1-4 tuần)",
    "breakoutPotential": "LOW",
    "reasoning": "Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên quan sát và chờ đợi tín hiệu tốt hơn."
  }
}
 POST /api/ai-analysis?action=analyze&coinId=bitcoin 200 in 43ms
🤖 [1754882626045-hops6n1dm] Starting AI analysis operation: AI_ENHANCED_ANALYSIS for solana
📊 [1754882626045-hops6n1dm] Request data: {
  "marketData": {
    "price": {
      "usd": 150,
      "usd_24h_change": 5.5,
      "usd_24h_vol": 2000000000,
      "usd_market_cap": 65000000000
    },
    "technical": {
      "rsi": 70,
      "ma50": 140,
      "ma200": 120,
      "macd": 1.2
    },
    "onChain": {
      "mvrv": 2.1,
      "nupl": 0.6,
      "sopr": 1.3,
      "activeAddresses": 200000
    },
    "sentiment": {
      "fearGreedIndex": 75,
      "fearGreedClassification": "Greed"
    }
  }
}
🤖 Starting AI analysis for solana...
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE (`main`.`analysis_history`.`coinId` = ? AND `main`.`analysis_history`.`analysisType` = ?) ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
💬 [Z.AI] Sending prompt to Z.AI:
📝 [Z.AI] Prompt content: PHÂN TÍCH THỊ TRƯỜNG SOLANA
========================================

DỮ LIỆU GIÁ:
- Giá hiện tại: $150
- Thay đổi 24h: 5.50%
- Khối lượng 24h: $2.0B
- Vốn hóa thị trường: $0.1T

CHỈ BÁO ON-CHAIN:
- MVRV Ratio: 2.10
- NUPL: 0.60
- SOPR: 1.30
- Địa chỉ hoạt động: 200,000

CHỈ BÁO KỸ THUẬT:
- RSI: 70.00 (Trung lập)
- MA50: $140
- MA200: $120
- MACD: 1.20

TÂM LÝ THỊ TRƯỜNG:
- Fear & Greed Index: 75 (Greed)

YÊU CẦU PHÂN TÍCH:
==================
Hãy cung cấp phân tích chi tiết và khuyến nghị đầu tư cho Solana dựa trên tất cả dữ liệu trên. Cân nhắc:

1. PHÂN TÍCH KỸ THUẬT:
   - Đánh giá động lượng và xu hướng dựa trên RSI, MACD
   - Phân tích vị trí giá so với đường trung bình động
   - Xem xét biến động và dải Bollinger

2. PHÂN TÍCH ON-CHAIN:
   - Đánh giá định giá dựa trên MVRV và NUPL
   - Phân tích hành vi của holder và mức lợi nhuận/thua lỗ

3. TÂM LÝ THỊ TRƯỜNG:
   - Diễn giải Fear & Greed Index trong bối cảnh giá hiện tại
   - Đánh giá tâm lý thị trường và các điểm cực đoan

4. QUẢN LÝ RỦI RO:
   - Xác định các yếu tố rủi ro chính
   - Đề xuất mức stop-loss và take-profit phù hợp

5. KHUYẾN NGHỊ ĐẦU TƯ:
   - Tín hiệu rõ ràng: MUA MẠNH, MUA, GIỮ, BÁN, BÁN MẠNH
   - Mức độ tin cậy (0-100)
   - Khung thời gian phân tích
   - Tiềm năng breakout (LOW/MEDIUM/HIGH)
   - Lý do chi tiết

Định dạng trả lời JSON:
{
  "recommendation": "MUA|BÁN|GIỮ|MUA MẠNH|BÁN MẠNH",
  "confidence": 0-100,
  "timeframe": "ví dụ: Ngắn hạn (1-2 tuần)",
  "breakoutPotential": "LOW|MEDIUM|HIGH",
  "reasoning": "lý do chi tiết bằng tiếng Việt"
}

Failed to make API request: TypeError: fetch failed
    at async generateEnhancedAIAnalysis (src/app/api/ai-analysis/route.ts:332:27)
    at async performAIAnalysis (src/app/api/ai-analysis/route.ts:176:29)
    at async POST (src/app/api/ai-analysis/route.ts:55:13)
  330 |       
  331 |       try {
> 332 |         const completion = await zai.chat.completions.create({
      |                           ^
  333 |           messages: [
  334 |             {
  335 |               role: 'system', {
  [cause]: [Error: getaddrinfo ENOTFOUND api.z-ai.dev] {
    errno: -3008,
    code: 'ENOTFOUND',
    syscall: 'getaddrinfo',
    hostname: 'api.z-ai.dev'
  }
}
Z.AI analysis failed, using fallback: fetch failed
🤖 [Z.AI] Received response from Z.AI (97ms):
📋 [Z.AI] Response: {
  "error": "fetch failed"
}
🤖 [ChatGPT] Received response from ChatGPT (0ms):
📋 [ChatGPT] Response: {
  "recommendation": "BÁN",
  "confidence": 71.66666666666667,
  "timeframe": "Ngắn hạn đến trung hạn (1-4 tuần)",
  "breakoutPotential": "LOW",
  "reasoning": "Các chỉ báo kỹ thuật và on-chain cho thấy tín hiệu tiêu cực. Thị trường có thể đang trong giai đoạn điều chỉnh hoặc đầu xu hướng giảm."
}
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query INSERT INTO `main`.`analysis_history` (`id`, `cryptoId`, `coinId`, `signal`, `confidence`, `reasoning`, `riskLevel`, `aiModel`, `analysisType`, `analysisData`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `cryptoId` AS `cryptoId`, `coinId` AS `coinId`, `signal` AS `signal`, `confidence` AS `confidence`, `reasoning` AS `reasoning`, `riskLevel` AS `riskLevel`, `aiModel` AS `aiModel`, `analysisType` AS `analysisType`, `analysisData` AS `analysisData`, `metricsData` AS `metricsData`, `timestamp` AS `timestamp`
✅ AI analysis saved to database for solana
💿 [1754882626045-hops6n1dm] Database save_analysis successful: {
  "cryptoId": "cme59qgw80009pe497umtcjfu",
  "coinId": "solana",
  "analysisType": "AI_ENHANCED",
  "analysisData": "{\"recommendation\":\"GIỮ\",\"timeframe\":\"Ngắn hạn\",\"riskFactors\":[\"Thị trường biến động thông thường\"],\"entryPoints\":\"Chờ tín hiệu rõ ràng hơn trước khi vào lệnh\",\"exitPoints\":\"Chốt lời khi có biến động giá mạnh hoặc đạt mục tiêu lợi nhuận\",\"stopLoss\":\"Quản lý rủi ro chặt chẽ, stop loss tại mức biến động chấp nhận được\",\"takeProfit\":\"Take profit khi đạt lợi nhuận mục tiêu hoặc có thay đổi xu hướng\",\"zaiAnalysis\":{\"recommendation\":\"GIỮ\",\"confidence\":60,\"timeframe\":\"Ngắn hạn\",\"breakoutPotential\":\"LOW\",\"reasoning\":\"Phân tích dựa trên dữ liệu thị trường hiện tại.\"},\"chatGPTAnalysis\":{\"recommendation\":\"BÁN\",\"confidence\":71.66666666666667,\"timeframe\":\"Ngắn hạn đến trung hạn (1-4 tuần)\",\"breakoutPotential\":\"LOW\",\"reasoning\":\"Các chỉ báo kỹ thuật và on-chain cho thấy tín hiệu tiêu cực. Thị trường có thể đang trong giai đoạn điều chỉnh hoặc đầu xu hướng giảm.\"}}",
  "signal": "GIỮ",
  "confidence": 71.66666666666667,
  "reasoning": "Z.AI: Phân tích dựa trên dữ liệu thị trường hiện tại.... | ChatGPT: Các chỉ báo kỹ thuật và on-chain cho thấy tín hiệu tiêu cực. Thị trường có thể đang trong giai đoạn ...",
  "riskLevel": "MEDIUM",
  "aiModel": "Z.AI+ChatGPT"
}
✅ [3:23:46 AM] AI_ENHANCED_ANALYSIS - solana (164ms)
   Metadata: {
  analysisType: 'AI_ENHANCED',
  marketDataPoints: 4,
  alertsCount: 0,
  cacheUsed: false,
  aiModelsUsed: [ 'Z.AI', 'ChatGPT' ]
}
✅ [1754882626045-hops6n1dm] Completed AI_ENHANCED_ANALYSIS successfully (164ms)
🎯 [1754882626045-hops6n1dm] Final result: {
  "recommendation": "GIỮ",
  "timeframe": "Ngắn hạn",
  "riskFactors": [
    "Thị trường biến động thông thường"
  ],
  "entryPoints": "Chờ tín hiệu rõ ràng hơn trước khi vào lệnh",
  "exitPoints": "Chốt lời khi có biến động giá mạnh hoặc đạt mục tiêu lợi nhuận",
  "stopLoss": "Quản lý rủi ro chặt chẽ, stop loss tại mức biến động chấp nhận được",
  "takeProfit": "Take profit khi đạt lợi nhuận mục tiêu hoặc có thay đổi xu hướng",
  "zaiAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn",
    "breakoutPotential": "LOW",
    "reasoning": "Phân tích dựa trên dữ liệu thị trường hiện tại."
  },
  "chatGPTAnalysis": {
    "recommendation": "BÁN",
    "confidence": 71.66666666666667,
    "timeframe": "Ngắn hạn đến trung hạn (1-4 tuần)",
    "breakoutPotential": "LOW",
    "reasoning": "Các chỉ báo kỹ thuật và on-chain cho thấy tín hiệu tiêu cực. Thị trường có thể đang trong giai đoạn điều chỉnh hoặc đầu xu hướng giảm."
  }
}
 POST /api/ai-analysis?action=analyze&coinId=solana 200 in 205ms
 GET / 200 in 63ms
 GET /favicon.ico 200 in 47ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE `main`.`analysis_history`.`cryptoId` = ? ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/dashboard?coinId=bitcoin 200 in 87ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/trading-signals-fast?action=signal&coinId=bitcoin 200 in 71ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/alerts-fast?action=process-data&coinId=bitcoin 200 in 72ms
🤖 [1754882630951-cdr66gzcf] Starting AI analysis operation: AI_ENHANCED_ANALYSIS for bitcoin
📊 [1754882630951-cdr66gzcf] Request data: {
  "marketData": {
    "price": {
      "usd": 117775,
      "usd_24h_change": 0.8618738474048199,
      "usd_24h_vol": 33776641957.26242,
      "usd_market_cap": 2343795976558.965
    },
    "onChain": {
      "mvrv": 1.8,
      "nupl": 0.65,
      "sopr": 1.02,
      "activeAddresses": 950000,
      "exchangeInflow": 15000,
      "exchangeOutflow": 12000,
      "transactionVolume": 25000000000,
      "supplyDistribution": {
        "whaleHoldings": {
          "percentage": 42.3,
          "addressCount": 850
        },
        "retailHoldings": {
          "percentage": 38.7,
          "addressCount": 42000000
        },
        "exchangeHoldings": {
          "percentage": 12.5,
          "addressCount": 150
        },
        "otherHoldings": {
          "percentage": 6.5,
          "addressCount": 120000
        }
      },
      "whaleHoldingsPercentage": 42.3,
      "retailHoldingsPercentage": 38.7,
      "exchangeHoldingsPercentage": 12.5
    },
    "technical": {
      "rsi": 58.5,
      "ma50": 112000,
      "ma200": 108000,
      "macd": 145.5,
      "macdSignal": null,
      "bollingerUpper": 122000,
      "bollingerLower": 111000,
      "bollingerMiddle": 116627
    },
    "derivatives": {
      "openInterest": 18500000000,
      "fundingRate": 0.0125,
      "liquidationVolume": 45000000,
      "putCallRatio": 0.85
    },
    "sentiment": {
      "fearGreedIndex": 50,
      "fearGreedClassification": "Neutral",
      "social": {
        "twitterSentiment": 0.5,
        "redditSentiment": 0.5,
        "socialVolume": 45000,
        "engagementRate": 0.085,
        "influencerSentiment": 0.75,
        "trendingScore": 75
      },
      "news": {
        "newsSentiment": 0.5,
        "newsVolume": 1250,
        "positiveNewsCount": 780,
        "negativeNewsCount": 320,
        "neutralNewsCount": 150,
        "sentimentScore": 0.5,
        "buzzScore": 75
      },
      "googleTrends": {
        "trendsScore": 75,
        "searchVolume": 850000,
        "trendingKeywords": [
          "bitcoin price",
          "btc news",
          "bitcoin mining"
        ],
        "regionalInterest": {
          "US": 85,
          "CN": 72,
          "EU": 68,
          "JP": 45,
          "KR": 52
        },
        "relatedQueries": [
          {
            "query": "bitcoin price today",
            "score": 95,
            "rising": true
          },
          {
            "query": "bitcoin prediction",
            "score": 78,
            "rising": true
          },
          {
            "query": "bitcoin mining",
            "score": 65,
            "rising": false
          }
        ],
        "trendDirection": "stable"
      }
    },
    "analysis": {
      "signal": "GIỮ",
      "confidence": 60,
      "reasoning": "Z.AI: Phân tích dựa trên dữ liệu thị trường hiện tại.... | ChatGPT: Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên q...",
      "riskLevel": "MEDIUM",
      "aiModel": "Z.AI+ChatGPT"
    },
    "timestamp": "2025-08-11T03:23:50.533Z",
    "dataSource": "database"
  },
  "tradingSignal": {
    "signal": "HOLD",
    "confidence": 50,
    "reasoning": "Tín hiệu trung lập: Không đủ điều kiện để MUA hoặc BÁN. Cần theo dõi thêm.",
    "riskLevel": "MEDIUM",
    "conditions": {
      "mvrv": 1.8,
      "fearGreed": 50,
      "fundingRate": 0.0125,
      "sopr": 1.02,
      "rsi": 58.5,
      "nupl": 0.65,
      "volumeTrend": "increasing",
      "extremeDetected": false
    },
    "triggers": []
  },
  "alerts": [],
  "coinId": "bitcoin"
}
🤖 Starting AI analysis for bitcoin...
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE (`main`.`analysis_history`.`coinId` = ? AND `main`.`analysis_history`.`analysisType` = ?) ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
🤖 Using cached AI analysis for bitcoin
💾 [1754882630951-cdr66gzcf] Using cached analysis for bitcoin (age: 662682ms)
✅ [1754882630951-cdr66gzcf] Completed AI_ENHANCED_ANALYSIS successfully (6ms)
🎯 [1754882630951-cdr66gzcf] Final result: {
  "recommendation": "GIỮ",
  "timeframe": "Ngắn hạn",
  "riskFactors": [
    "Thị trường biến động thông thường"
  ],
  "entryPoints": "Chờ tín hiệu rõ ràng hơn trước khi vào lệnh",
  "exitPoints": "Chốt lời khi có biến động giá mạnh hoặc đạt mục tiêu lợi nhuận",
  "stopLoss": "Quản lý rủi ro chặt chẽ, stop loss tại mức biến động chấp nhận được",
  "takeProfit": "Take profit khi đạt lợi nhuận mục tiêu hoặc có thay đổi xu hướng",
  "zaiAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn",
    "breakoutPotential": "LOW",
    "reasoning": "Phân tích dựa trên dữ liệu thị trường hiện tại."
  },
  "chatGPTAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn đến trung hạn (1-4 tuần)",
    "breakoutPotential": "LOW",
    "reasoning": "Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên quan sát và chờ đợi tín hiệu tốt hơn."
  }
}
 POST /api/ai-analysis?action=analyze&coinId=bitcoin 200 in 46ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`isActive` = ? ORDER BY `main`.`cryptocurrencies`.`isDefault` DESC, `main`.`cryptocurrencies`.`rank` ASC, `main`.`cryptocurrencies`.`createdAt` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`coin_data_collection`.`id`, `main`.`coin_data_collection`.`cryptoId`, `main`.`coin_data_collection`.`status`, `main`.`coin_data_collection`.`lastCollected`, `main`.`coin_data_collection`.`nextCollection`, `main`.`coin_data_collection`.`errorCount`, `main`.`coin_data_collection`.`lastError`, `main`.`coin_data_collection`.`metadata` FROM `main`.`coin_data_collection` WHERE `main`.`coin_data_collection`.`cryptoId` IN (?,?,?,?,?) LIMIT ? OFFSET ?
 GET /api/cryptocurrencies?activeOnly=true 200 in 55ms
 GET / 200 in 83ms
 GET /favicon.ico 200 in 55ms
 GET /api/ai-analysis-logs?action=recent&count=5 200 in 64ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT 1
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`isActive` = ? ORDER BY `main`.`cryptocurrencies`.`isDefault` DESC, `main`.`cryptocurrencies`.`rank` ASC, `main`.`cryptocurrencies`.`createdAt` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`coin_data_collection`.`id`, `main`.`coin_data_collection`.`cryptoId`, `main`.`coin_data_collection`.`status`, `main`.`coin_data_collection`.`lastCollected`, `main`.`coin_data_collection`.`nextCollection`, `main`.`coin_data_collection`.`errorCount`, `main`.`coin_data_collection`.`lastError`, `main`.`coin_data_collection`.`metadata` FROM `main`.`coin_data_collection` WHERE `main`.`coin_data_collection`.`cryptoId` IN (?,?,?,?,?) LIMIT ? OFFSET ?
 GET /api/cryptocurrencies?activeOnly=true 200 in 75ms
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE `main`.`analysis_history`.`cryptoId` = ? ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/dashboard?coinId=bitcoin 200 in 162ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/trading-signals-fast?action=signal&coinId=bitcoin 200 in 96ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/alerts-fast?action=process-data&coinId=bitcoin 200 in 81ms
🤖 [1754882635126-xh5k9ye6b] Starting AI analysis operation: AI_ENHANCED_ANALYSIS for bitcoin
📊 [1754882635126-xh5k9ye6b] Request data: {
  "marketData": {
    "price": {
      "usd": 117775,
      "usd_24h_change": 0.8618738474048199,
      "usd_24h_vol": 33776641957.26242,
      "usd_market_cap": 2343795976558.965
    },
    "onChain": {
      "mvrv": 1.8,
      "nupl": 0.65,
      "sopr": 1.02,
      "activeAddresses": 950000,
      "exchangeInflow": 15000,
      "exchangeOutflow": 12000,
      "transactionVolume": 25000000000,
      "supplyDistribution": {
        "whaleHoldings": {
          "percentage": 42.3,
          "addressCount": 850
        },
        "retailHoldings": {
          "percentage": 38.7,
          "addressCount": 42000000
        },
        "exchangeHoldings": {
          "percentage": 12.5,
          "addressCount": 150
        },
        "otherHoldings": {
          "percentage": 6.5,
          "addressCount": 120000
        }
      },
      "whaleHoldingsPercentage": 42.3,
      "retailHoldingsPercentage": 38.7,
      "exchangeHoldingsPercentage": 12.5
    },
    "technical": {
      "rsi": 58.5,
      "ma50": 112000,
      "ma200": 108000,
      "macd": 145.5,
      "macdSignal": null,
      "bollingerUpper": 122000,
      "bollingerLower": 111000,
      "bollingerMiddle": 116627
    },
    "derivatives": {
      "openInterest": 18500000000,
      "fundingRate": 0.0125,
      "liquidationVolume": 45000000,
      "putCallRatio": 0.85
    },
    "sentiment": {
      "fearGreedIndex": 50,
      "fearGreedClassification": "Neutral",
      "social": {
        "twitterSentiment": 0.5,
        "redditSentiment": 0.5,
        "socialVolume": 45000,
        "engagementRate": 0.085,
        "influencerSentiment": 0.75,
        "trendingScore": 75
      },
      "news": {
        "newsSentiment": 0.5,
        "newsVolume": 1250,
        "positiveNewsCount": 780,
        "negativeNewsCount": 320,
        "neutralNewsCount": 150,
        "sentimentScore": 0.5,
        "buzzScore": 75
      },
      "googleTrends": {
        "trendsScore": 75,
        "searchVolume": 850000,
        "trendingKeywords": [
          "bitcoin price",
          "btc news",
          "bitcoin mining"
        ],
        "regionalInterest": {
          "US": 85,
          "CN": 72,
          "EU": 68,
          "JP": 45,
          "KR": 52
        },
        "relatedQueries": [
          {
            "query": "bitcoin price today",
            "score": 95,
            "rising": true
          },
          {
            "query": "bitcoin prediction",
            "score": 78,
            "rising": true
          },
          {
            "query": "bitcoin mining",
            "score": 65,
            "rising": false
          }
        ],
        "trendDirection": "stable"
      }
    },
    "analysis": {
      "signal": "GIỮ",
      "confidence": 60,
      "reasoning": "Z.AI: Phân tích dựa trên dữ liệu thị trường hiện tại.... | ChatGPT: Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên q...",
      "riskLevel": "MEDIUM",
      "aiModel": "Z.AI+ChatGPT"
    },
    "timestamp": "2025-08-11T03:23:54.533Z",
    "dataSource": "database"
  },
  "tradingSignal": {
    "signal": "HOLD",
    "confidence": 50,
    "reasoning": "Tín hiệu trung lập: Không đủ điều kiện để MUA hoặc BÁN. Cần theo dõi thêm.",
    "riskLevel": "MEDIUM",
    "conditions": {
      "mvrv": 1.8,
      "fearGreed": 50,
      "fundingRate": 0.0125,
      "sopr": 1.02,
      "rsi": 58.5,
      "nupl": 0.65,
      "volumeTrend": "increasing",
      "extremeDetected": false
    },
    "triggers": []
  },
  "alerts": [],
  "coinId": "bitcoin"
}
🤖 Starting AI analysis for bitcoin...
 POST /api/ai-analysis?action=analyze&coinId=bitcoin 200 in 88ms
🤖 Using cached AI analysis for bitcoin
💾 [1754882635126-xh5k9ye6b] Using cached analysis for bitcoin (age: 666899ms)
✅ [1754882635126-xh5k9ye6b] Completed AI_ENHANCED_ANALYSIS successfully (49ms)
🎯 [1754882635126-xh5k9ye6b] Final result: {
  "recommendation": "GIỮ",
  "timeframe": "Ngắn hạn",
  "riskFactors": [
    "Thị trường biến động thông thường"
  ],
  "entryPoints": "Chờ tín hiệu rõ ràng hơn trước khi vào lệnh",
  "exitPoints": "Chốt lời khi có biến động giá mạnh hoặc đạt mục tiêu lợi nhuận",
  "stopLoss": "Quản lý rủi ro chặt chẽ, stop loss tại mức biến động chấp nhận được",
  "takeProfit": "Take profit khi đạt lợi nhuận mục tiêu hoặc có thay đổi xu hướng",
  "zaiAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn",
    "breakoutPotential": "LOW",
    "reasoning": "Phân tích dựa trên dữ liệu thị trường hiện tại."
  },
  "chatGPTAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn đến trung hạn (1-4 tuần)",
    "breakoutPotential": "LOW",
    "reasoning": "Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên quan sát và chờ đợi tín hiệu tốt hơn."
  }
}
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE (`main`.`analysis_history`.`coinId` = ? AND `main`.`analysis_history`.`analysisType` = ?) ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/ai-analysis-logs?action=stats 200 in 62ms
 GET / 200 in 129ms
 GET /favicon.ico 200 in 44ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`isActive` = ? ORDER BY `main`.`cryptocurrencies`.`isDefault` DESC, `main`.`cryptocurrencies`.`rank` ASC, `main`.`cryptocurrencies`.`createdAt` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE `main`.`analysis_history`.`cryptoId` = ? ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/dashboard?coinId=bitcoin 200 in 80ms
prisma:query SELECT `main`.`coin_data_collection`.`id`, `main`.`coin_data_collection`.`cryptoId`, `main`.`coin_data_collection`.`status`, `main`.`coin_data_collection`.`lastCollected`, `main`.`coin_data_collection`.`nextCollection`, `main`.`coin_data_collection`.`errorCount`, `main`.`coin_data_collection`.`lastError`, `main`.`coin_data_collection`.`metadata` FROM `main`.`coin_data_collection` WHERE `main`.`coin_data_collection`.`cryptoId` IN (?,?,?,?,?) LIMIT ? OFFSET ?
 GET /api/cryptocurrencies?activeOnly=true 200 in 96ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/trading-signals-fast?action=signal&coinId=bitcoin 200 in 78ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/alerts-fast?action=process-data&coinId=bitcoin 200 in 106ms
🤖 [1754882637749-5pbp4ra3i] Starting AI analysis operation: AI_ENHANCED_ANALYSIS for bitcoin
📊 [1754882637749-5pbp4ra3i] Request data: {
  "marketData": {
    "price": {
      "usd": 117775,
      "usd_24h_change": 0.8618738474048199,
      "usd_24h_vol": 33776641957.26242,
      "usd_market_cap": 2343795976558.965
    },
    "onChain": {
      "mvrv": 1.8,
      "nupl": 0.65,
      "sopr": 1.02,
      "activeAddresses": 950000,
      "exchangeInflow": 15000,
      "exchangeOutflow": 12000,
      "transactionVolume": 25000000000,
      "supplyDistribution": {
        "whaleHoldings": {
          "percentage": 42.3,
          "addressCount": 850
        },
        "retailHoldings": {
          "percentage": 38.7,
          "addressCount": 42000000
        },
        "exchangeHoldings": {
          "percentage": 12.5,
          "addressCount": 150
        },
        "otherHoldings": {
          "percentage": 6.5,
          "addressCount": 120000
        }
      },
      "whaleHoldingsPercentage": 42.3,
      "retailHoldingsPercentage": 38.7,
      "exchangeHoldingsPercentage": 12.5
    },
    "technical": {
      "rsi": 58.5,
      "ma50": 112000,
      "ma200": 108000,
      "macd": 145.5,
      "macdSignal": null,
      "bollingerUpper": 122000,
      "bollingerLower": 111000,
      "bollingerMiddle": 116627
    },
    "derivatives": {
      "openInterest": 18500000000,
      "fundingRate": 0.0125,
      "liquidationVolume": 45000000,
      "putCallRatio": 0.85
    },
    "sentiment": {
      "fearGreedIndex": 50,
      "fearGreedClassification": "Neutral",
      "social": {
        "twitterSentiment": 0.5,
        "redditSentiment": 0.5,
        "socialVolume": 45000,
        "engagementRate": 0.085,
        "influencerSentiment": 0.75,
        "trendingScore": 75
      },
      "news": {
        "newsSentiment": 0.5,
        "newsVolume": 1250,
        "positiveNewsCount": 780,
        "negativeNewsCount": 320,
        "neutralNewsCount": 150,
        "sentimentScore": 0.5,
        "buzzScore": 75
      },
      "googleTrends": {
        "trendsScore": 75,
        "searchVolume": 850000,
        "trendingKeywords": [
          "bitcoin price",
          "btc news",
          "bitcoin mining"
        ],
        "regionalInterest": {
          "US": 85,
          "CN": 72,
          "EU": 68,
          "JP": 45,
          "KR": 52
        },
        "relatedQueries": [
          {
            "query": "bitcoin price today",
            "score": 95,
            "rising": true
          },
          {
            "query": "bitcoin prediction",
            "score": 78,
            "rising": true
          },
          {
            "query": "bitcoin mining",
            "score": 65,
            "rising": false
          }
        ],
        "trendDirection": "stable"
      }
    },
    "analysis": {
      "signal": "GIỮ",
      "confidence": 60,
      "reasoning": "Z.AI: Phân tích dựa trên dữ liệu thị trường hiện tại.... | ChatGPT: Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên q...",
      "riskLevel": "MEDIUM",
      "aiModel": "Z.AI+ChatGPT"
    },
    "timestamp": "2025-08-11T03:23:57.301Z",
    "dataSource": "database"
  },
  "tradingSignal": {
    "signal": "HOLD",
    "confidence": 50,
    "reasoning": "Tín hiệu trung lập: Không đủ điều kiện để MUA hoặc BÁN. Cần theo dõi thêm.",
    "riskLevel": "MEDIUM",
    "conditions": {
      "mvrv": 1.8,
      "fearGreed": 50,
      "fundingRate": 0.0125,
      "sopr": 1.02,
      "rsi": 58.5,
      "nupl": 0.65,
      "volumeTrend": "increasing",
      "extremeDetected": false
    },
    "triggers": []
  },
  "alerts": [],
  "coinId": "bitcoin"
}
🤖 Starting AI analysis for bitcoin...
 GET /api/ai-analysis-logs?action=coin&coinId=solana&count=1 200 in 55ms
🤖 Using cached AI analysis for bitcoin
💾 [1754882637749-5pbp4ra3i] Using cached analysis for bitcoin (age: 669483ms)
✅ [1754882637749-5pbp4ra3i] Completed AI_ENHANCED_ANALYSIS successfully (9ms)
🎯 [1754882637749-5pbp4ra3i] Final result: {
  "recommendation": "GIỮ",
  "timeframe": "Ngắn hạn",
  "riskFactors": [
    "Thị trường biến động thông thường"
  ],
  "entryPoints": "Chờ tín hiệu rõ ràng hơn trước khi vào lệnh",
  "exitPoints": "Chốt lời khi có biến động giá mạnh hoặc đạt mục tiêu lợi nhuận",
  "stopLoss": "Quản lý rủi ro chặt chẽ, stop loss tại mức biến động chấp nhận được",
  "takeProfit": "Take profit khi đạt lợi nhuận mục tiêu hoặc có thay đổi xu hướng",
  "zaiAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn",
    "breakoutPotential": "LOW",
    "reasoning": "Phân tích dựa trên dữ liệu thị trường hiện tại."
  },
  "chatGPTAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn đến trung hạn (1-4 tuần)",
    "breakoutPotential": "LOW",
    "reasoning": "Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên quan sát và chờ đợi tín hiệu tốt hơn."
  }
}
 POST /api/ai-analysis?action=analyze&coinId=bitcoin 200 in 65ms
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE (`main`.`analysis_history`.`coinId` = ? AND `main`.`analysis_history`.`analysisType` = ?) ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?

📊 AI Analysis Log Summary
==========================
Total logs: 2
Successful operations: 2
Failed operations: 0
Average execution time: 407ms
Coins analyzed: ethereum, solana

Operations by type:
  AI_ENHANCED_ANALYSIS: 2
==========================

 GET /api/ai-analysis-logs?action=summary 200 in 57ms
 GET / 200 in 93ms
 GET /favicon.ico 200 in 38ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE `main`.`analysis_history`.`cryptoId` = ? ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/dashboard?coinId=bitcoin 200 in 77ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/trading-signals-fast?action=signal&coinId=bitcoin 200 in 71ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/alerts-fast?action=process-data&coinId=bitcoin 200 in 86ms
🤖 [1754882643707-a7ljd66ic] Starting AI analysis operation: AI_ENHANCED_ANALYSIS for bitcoin
📊 [1754882643707-a7ljd66ic] Request data: {
  "marketData": {
    "price": {
      "usd": 117775,
      "usd_24h_change": 0.8618738474048199,
      "usd_24h_vol": 33776641957.26242,
      "usd_market_cap": 2343795976558.965
    },
    "onChain": {
      "mvrv": 1.8,
      "nupl": 0.65,
      "sopr": 1.02,
      "activeAddresses": 950000,
      "exchangeInflow": 15000,
      "exchangeOutflow": 12000,
      "transactionVolume": 25000000000,
      "supplyDistribution": {
        "whaleHoldings": {
          "percentage": 42.3,
          "addressCount": 850
        },
        "retailHoldings": {
          "percentage": 38.7,
          "addressCount": 42000000
        },
        "exchangeHoldings": {
          "percentage": 12.5,
          "addressCount": 150
        },
        "otherHoldings": {
          "percentage": 6.5,
          "addressCount": 120000
        }
      },
      "whaleHoldingsPercentage": 42.3,
      "retailHoldingsPercentage": 38.7,
      "exchangeHoldingsPercentage": 12.5
    },
    "technical": {
      "rsi": 58.5,
      "ma50": 112000,
      "ma200": 108000,
      "macd": 145.5,
      "macdSignal": null,
      "bollingerUpper": 122000,
      "bollingerLower": 111000,
      "bollingerMiddle": 116627
    },
    "derivatives": {
      "openInterest": 18500000000,
      "fundingRate": 0.0125,
      "liquidationVolume": 45000000,
      "putCallRatio": 0.85
    },
    "sentiment": {
      "fearGreedIndex": 50,
      "fearGreedClassification": "Neutral",
      "social": {
        "twitterSentiment": 0.5,
        "redditSentiment": 0.5,
        "socialVolume": 45000,
        "engagementRate": 0.085,
        "influencerSentiment": 0.75,
        "trendingScore": 75
      },
      "news": {
        "newsSentiment": 0.5,
        "newsVolume": 1250,
        "positiveNewsCount": 780,
        "negativeNewsCount": 320,
        "neutralNewsCount": 150,
        "sentimentScore": 0.5,
        "buzzScore": 75
      },
      "googleTrends": {
        "trendsScore": 75,
        "searchVolume": 850000,
        "trendingKeywords": [
          "bitcoin price",
          "btc news",
          "bitcoin mining"
        ],
        "regionalInterest": {
          "US": 85,
          "CN": 72,
          "EU": 68,
          "JP": 45,
          "KR": 52
        },
        "relatedQueries": [
          {
            "query": "bitcoin price today",
            "score": 95,
            "rising": true
          },
          {
            "query": "bitcoin prediction",
            "score": 78,
            "rising": true
          },
          {
            "query": "bitcoin mining",
            "score": 65,
            "rising": false
          }
        ],
        "trendDirection": "stable"
      }
    },
    "analysis": {
      "signal": "GIỮ",
      "confidence": 60,
      "reasoning": "Z.AI: Phân tích dựa trên dữ liệu thị trường hiện tại.... | ChatGPT: Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên q...",
      "riskLevel": "MEDIUM",
      "aiModel": "Z.AI+ChatGPT"
    },
    "timestamp": "2025-08-11T03:24:03.311Z",
    "dataSource": "database"
  },
  "tradingSignal": {
    "signal": "HOLD",
    "confidence": 50,
    "reasoning": "Tín hiệu trung lập: Không đủ điều kiện để MUA hoặc BÁN. Cần theo dõi thêm.",
    "riskLevel": "MEDIUM",
    "conditions": {
      "mvrv": 1.8,
      "fearGreed": 50,
      "fundingRate": 0.0125,
      "sopr": 1.02,
      "rsi": 58.5,
      "nupl": 0.65,
      "volumeTrend": "increasing",
      "extremeDetected": false
    },
    "triggers": []
  },
  "alerts": [],
  "coinId": "bitcoin"
}
🤖 Starting AI analysis for bitcoin...
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE (`main`.`analysis_history`.`coinId` = ? AND `main`.`analysis_history`.`analysisType` = ?) ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
🤖 Using cached AI analysis for bitcoin
💾 [1754882643707-a7ljd66ic] Using cached analysis for bitcoin (age: 675438ms)
✅ [1754882643707-a7ljd66ic] Completed AI_ENHANCED_ANALYSIS successfully (6ms)
🎯 [1754882643707-a7ljd66ic] Final result: {
  "recommendation": "GIỮ",
  "timeframe": "Ngắn hạn",
  "riskFactors": [
    "Thị trường biến động thông thường"
  ],
  "entryPoints": "Chờ tín hiệu rõ ràng hơn trước khi vào lệnh",
  "exitPoints": "Chốt lời khi có biến động giá mạnh hoặc đạt mục tiêu lợi nhuận",
  "stopLoss": "Quản lý rủi ro chặt chẽ, stop loss tại mức biến động chấp nhận được",
  "takeProfit": "Take profit khi đạt lợi nhuận mục tiêu hoặc có thay đổi xu hướng",
  "zaiAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn",
    "breakoutPotential": "LOW",
    "reasoning": "Phân tích dựa trên dữ liệu thị trường hiện tại."
  },
  "chatGPTAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn đến trung hạn (1-4 tuần)",
    "breakoutPotential": "LOW",
    "reasoning": "Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên quan sát và chờ đợi tín hiệu tốt hơn."
  }
}
 POST /api/ai-analysis?action=analyze&coinId=bitcoin 200 in 47ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`isActive` = ? ORDER BY `main`.`cryptocurrencies`.`isDefault` DESC, `main`.`cryptocurrencies`.`rank` ASC, `main`.`cryptocurrencies`.`createdAt` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`coin_data_collection`.`id`, `main`.`coin_data_collection`.`cryptoId`, `main`.`coin_data_collection`.`status`, `main`.`coin_data_collection`.`lastCollected`, `main`.`coin_data_collection`.`nextCollection`, `main`.`coin_data_collection`.`errorCount`, `main`.`coin_data_collection`.`lastError`, `main`.`coin_data_collection`.`metadata` FROM `main`.`coin_data_collection` WHERE `main`.`coin_data_collection`.`cryptoId` IN (?,?,?,?,?) LIMIT ? OFFSET ?
 GET /api/cryptocurrencies?activeOnly=true 200 in 47ms
 GET / 200 in 92ms
 GET /favicon.ico 200 in 54ms
prisma:query SELECT 1
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`isActive` = ? ORDER BY `main`.`cryptocurrencies`.`isDefault` DESC, `main`.`cryptocurrencies`.`rank` ASC, `main`.`cryptocurrencies`.`createdAt` DESC LIMIT ? OFFSET ?
prisma:query SELECT 1
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`coin_data_collection`.`id`, `main`.`coin_data_collection`.`cryptoId`, `main`.`coin_data_collection`.`status`, `main`.`coin_data_collection`.`lastCollected`, `main`.`coin_data_collection`.`nextCollection`, `main`.`coin_data_collection`.`errorCount`, `main`.`coin_data_collection`.`lastError`, `main`.`coin_data_collection`.`metadata` FROM `main`.`coin_data_collection` WHERE `main`.`coin_data_collection`.`cryptoId` IN (?,?,?,?,?) LIMIT ? OFFSET ?
 GET /api/cryptocurrencies?activeOnly=true 200 in 95ms
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE `main`.`analysis_history`.`cryptoId` = ? ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/dashboard?coinId=bitcoin 200 in 129ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/trading-signals-fast?action=signal&coinId=bitcoin 200 in 139ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/alerts-fast?action=process-data&coinId=bitcoin 200 in 85ms
🤖 [1754883130279-qzgvlmn07] Starting AI analysis operation: AI_ENHANCED_ANALYSIS for bitcoin
📊 [1754883130279-qzgvlmn07] Request data: {
  "marketData": {
    "price": {
      "usd": 117775,
      "usd_24h_change": 0.8618738474048199,
      "usd_24h_vol": 33776641957.26242,
      "usd_market_cap": 2343795976558.965
    },
    "onChain": {
      "mvrv": 1.8,
      "nupl": 0.65,
      "sopr": 1.02,
      "activeAddresses": 950000,
      "exchangeInflow": 15000,
      "exchangeOutflow": 12000,
      "transactionVolume": 25000000000,
      "supplyDistribution": {
        "whaleHoldings": {
          "percentage": 42.3,
          "addressCount": 850
        },
        "retailHoldings": {
          "percentage": 38.7,
          "addressCount": 42000000
        },
        "exchangeHoldings": {
          "percentage": 12.5,
          "addressCount": 150
        },
        "otherHoldings": {
          "percentage": 6.5,
          "addressCount": 120000
        }
      },
      "whaleHoldingsPercentage": 42.3,
      "retailHoldingsPercentage": 38.7,
      "exchangeHoldingsPercentage": 12.5
    },
    "technical": {
      "rsi": 58.5,
      "ma50": 112000,
      "ma200": 108000,
      "macd": 145.5,
      "macdSignal": null,
      "bollingerUpper": 122000,
      "bollingerLower": 111000,
      "bollingerMiddle": 116627
    },
    "derivatives": {
      "openInterest": 18500000000,
      "fundingRate": 0.0125,
      "liquidationVolume": 45000000,
      "putCallRatio": 0.85
    },
    "sentiment": {
      "fearGreedIndex": 50,
      "fearGreedClassification": "Neutral",
      "social": {
        "twitterSentiment": 0.5,
        "redditSentiment": 0.5,
        "socialVolume": 45000,
        "engagementRate": 0.085,
        "influencerSentiment": 0.75,
        "trendingScore": 75
      },
      "news": {
        "newsSentiment": 0.5,
        "newsVolume": 1250,
        "positiveNewsCount": 780,
        "negativeNewsCount": 320,
        "neutralNewsCount": 150,
        "sentimentScore": 0.5,
        "buzzScore": 75
      },
      "googleTrends": {
        "trendsScore": 75,
        "searchVolume": 850000,
        "trendingKeywords": [
          "bitcoin price",
          "btc news",
          "bitcoin mining"
        ],
        "regionalInterest": {
          "US": 85,
          "CN": 72,
          "EU": 68,
          "JP": 45,
          "KR": 52
        },
        "relatedQueries": [
          {
            "query": "bitcoin price today",
            "score": 95,
            "rising": true
          },
          {
            "query": "bitcoin prediction",
            "score": 78,
            "rising": true
          },
          {
            "query": "bitcoin mining",
            "score": 65,
            "rising": false
          }
        ],
        "trendDirection": "stable"
      }
    },
    "analysis": {
      "signal": "GIỮ",
      "confidence": 60,
      "reasoning": "Z.AI: Phân tích dựa trên dữ liệu thị trường hiện tại.... | ChatGPT: Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên q...",
      "riskLevel": "MEDIUM",
      "aiModel": "Z.AI+ChatGPT"
    },
    "timestamp": "2025-08-11T03:32:08.624Z",
    "dataSource": "database"
  },
  "tradingSignal": {
    "signal": "HOLD",
    "confidence": 50,
    "reasoning": "Tín hiệu trung lập: Không đủ điều kiện để MUA hoặc BÁN. Cần theo dõi thêm.",
    "riskLevel": "MEDIUM",
    "conditions": {
      "mvrv": 1.8,
      "fearGreed": 50,
      "fundingRate": 0.0125,
      "sopr": 1.02,
      "rsi": 58.5,
      "nupl": 0.65,
      "volumeTrend": "increasing",
      "extremeDetected": false
    },
    "triggers": []
  },
  "alerts": [],
  "coinId": "bitcoin"
}
🤖 Starting AI analysis for bitcoin...
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE (`main`.`analysis_history`.`coinId` = ? AND `main`.`analysis_history`.`analysisType` = ?) ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
🤖 Using cached AI analysis for bitcoin
💾 [1754883130279-qzgvlmn07] Using cached analysis for bitcoin (age: 1162009ms)
✅ [1754883130279-qzgvlmn07] Completed AI_ENHANCED_ANALYSIS successfully (5ms)
🎯 [1754883130279-qzgvlmn07] Final result: {
  "recommendation": "GIỮ",
  "timeframe": "Ngắn hạn",
  "riskFactors": [
    "Thị trường biến động thông thường"
  ],
  "entryPoints": "Chờ tín hiệu rõ ràng hơn trước khi vào lệnh",
  "exitPoints": "Chốt lời khi có biến động giá mạnh hoặc đạt mục tiêu lợi nhuận",
  "stopLoss": "Quản lý rủi ro chặt chẽ, stop loss tại mức biến động chấp nhận được",
  "takeProfit": "Take profit khi đạt lợi nhuận mục tiêu hoặc có thay đổi xu hướng",
  "zaiAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn",
    "breakoutPotential": "LOW",
    "reasoning": "Phân tích dựa trên dữ liệu thị trường hiện tại."
  },
  "chatGPTAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn đến trung hạn (1-4 tuần)",
    "breakoutPotential": "LOW",
    "reasoning": "Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên quan sát và chờ đợi tín hiệu tốt hơn."
  }
}
 POST /api/ai-analysis?action=analyze&coinId=bitcoin 200 in 42ms
 GET / 200 in 67ms
 GET /favicon.ico 200 in 47ms
prisma:query SELECT 1
prisma:query SELECT 1
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`isActive` = ? ORDER BY `main`.`cryptocurrencies`.`isDefault` DESC, `main`.`cryptocurrencies`.`rank` ASC, `main`.`cryptocurrencies`.`createdAt` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`coin_data_collection`.`id`, `main`.`coin_data_collection`.`cryptoId`, `main`.`coin_data_collection`.`status`, `main`.`coin_data_collection`.`lastCollected`, `main`.`coin_data_collection`.`nextCollection`, `main`.`coin_data_collection`.`errorCount`, `main`.`coin_data_collection`.`lastError`, `main`.`coin_data_collection`.`metadata` FROM `main`.`coin_data_collection` WHERE `main`.`coin_data_collection`.`cryptoId` IN (?,?,?,?,?) LIMIT ? OFFSET ?
 GET /api/cryptocurrencies?activeOnly=true 200 in 80ms
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE `main`.`analysis_history`.`cryptoId` = ? ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/dashboard?coinId=bitcoin 200 in 106ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/trading-signals-fast?action=signal&coinId=bitcoin 200 in 72ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/alerts-fast?action=process-data&coinId=bitcoin 200 in 67ms
🤖 [1754883360149-4cbtnf0o1] Starting AI analysis operation: AI_ENHANCED_ANALYSIS for bitcoin
📊 [1754883360149-4cbtnf0o1] Request data: {
  "marketData": {
    "price": {
      "usd": 117775,
      "usd_24h_change": 0.8618738474048199,
      "usd_24h_vol": 33776641957.26242,
      "usd_market_cap": 2343795976558.965
    },
    "onChain": {
      "mvrv": 1.8,
      "nupl": 0.65,
      "sopr": 1.02,
      "activeAddresses": 950000,
      "exchangeInflow": 15000,
      "exchangeOutflow": 12000,
      "transactionVolume": 25000000000,
      "supplyDistribution": {
        "whaleHoldings": {
          "percentage": 42.3,
          "addressCount": 850
        },
        "retailHoldings": {
          "percentage": 38.7,
          "addressCount": 42000000
        },
        "exchangeHoldings": {
          "percentage": 12.5,
          "addressCount": 150
        },
        "otherHoldings": {
          "percentage": 6.5,
          "addressCount": 120000
        }
      },
      "whaleHoldingsPercentage": 42.3,
      "retailHoldingsPercentage": 38.7,
      "exchangeHoldingsPercentage": 12.5
    },
    "technical": {
      "rsi": 58.5,
      "ma50": 112000,
      "ma200": 108000,
      "macd": 145.5,
      "macdSignal": null,
      "bollingerUpper": 122000,
      "bollingerLower": 111000,
      "bollingerMiddle": 116627
    },
    "derivatives": {
      "openInterest": 18500000000,
      "fundingRate": 0.0125,
      "liquidationVolume": 45000000,
      "putCallRatio": 0.85
    },
    "sentiment": {
      "fearGreedIndex": 50,
      "fearGreedClassification": "Neutral",
      "social": {
        "twitterSentiment": 0.5,
        "redditSentiment": 0.5,
        "socialVolume": 45000,
        "engagementRate": 0.085,
        "influencerSentiment": 0.75,
        "trendingScore": 75
      },
      "news": {
        "newsSentiment": 0.5,
        "newsVolume": 1250,
        "positiveNewsCount": 780,
        "negativeNewsCount": 320,
        "neutralNewsCount": 150,
        "sentimentScore": 0.5,
        "buzzScore": 75
      },
      "googleTrends": {
        "trendsScore": 75,
        "searchVolume": 850000,
        "trendingKeywords": [
          "bitcoin price",
          "btc news",
          "bitcoin mining"
        ],
        "regionalInterest": {
          "US": 85,
          "CN": 72,
          "EU": 68,
          "JP": 45,
          "KR": 52
        },
        "relatedQueries": [
          {
            "query": "bitcoin price today",
            "score": 95,
            "rising": true
          },
          {
            "query": "bitcoin prediction",
            "score": 78,
            "rising": true
          },
          {
            "query": "bitcoin mining",
            "score": 65,
            "rising": false
          }
        ],
        "trendDirection": "stable"
      }
    },
    "analysis": {
      "signal": "GIỮ",
      "confidence": 60,
      "reasoning": "Z.AI: Phân tích dựa trên dữ liệu thị trường hiện tại.... | ChatGPT: Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên q...",
      "riskLevel": "MEDIUM",
      "aiModel": "Z.AI+ChatGPT"
    },
    "timestamp": "2025-08-11T03:35:58.494Z",
    "dataSource": "database"
  },
  "tradingSignal": {
    "signal": "HOLD",
    "confidence": 50,
    "reasoning": "Tín hiệu trung lập: Không đủ điều kiện để MUA hoặc BÁN. Cần theo dõi thêm.",
    "riskLevel": "MEDIUM",
    "conditions": {
      "mvrv": 1.8,
      "fearGreed": 50,
      "fundingRate": 0.0125,
      "sopr": 1.02,
      "rsi": 58.5,
      "nupl": 0.65,
      "volumeTrend": "increasing",
      "extremeDetected": false
    },
    "triggers": []
  },
  "alerts": [],
  "coinId": "bitcoin"
}
🤖 Starting AI analysis for bitcoin...
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE (`main`.`analysis_history`.`coinId` = ? AND `main`.`analysis_history`.`analysisType` = ?) ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
🤖 Using cached AI analysis for bitcoin
💾 [1754883360149-4cbtnf0o1] Using cached analysis for bitcoin (age: 1391890ms)
✅ [1754883360149-4cbtnf0o1] Completed AI_ENHANCED_ANALYSIS successfully (17ms)
🎯 [1754883360149-4cbtnf0o1] Final result: {
  "recommendation": "GIỮ",
  "timeframe": "Ngắn hạn",
  "riskFactors": [
    "Thị trường biến động thông thường"
  ],
  "entryPoints": "Chờ tín hiệu rõ ràng hơn trước khi vào lệnh",
  "exitPoints": "Chốt lời khi có biến động giá mạnh hoặc đạt mục tiêu lợi nhuận",
  "stopLoss": "Quản lý rủi ro chặt chẽ, stop loss tại mức biến động chấp nhận được",
  "takeProfit": "Take profit khi đạt lợi nhuận mục tiêu hoặc có thay đổi xu hướng",
  "zaiAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn",
    "breakoutPotential": "LOW",
    "reasoning": "Phân tích dựa trên dữ liệu thị trường hiện tại."
  },
  "chatGPTAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn đến trung hạn (1-4 tuần)",
    "breakoutPotential": "LOW",
    "reasoning": "Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên quan sát và chờ đợi tín hiệu tốt hơn."
  }
}
 POST /api/ai-analysis?action=analyze&coinId=bitcoin 200 in 60ms
 GET / 200 in 101ms
 GET /favicon.ico 200 in 40ms
 GET / 200 in 61ms
 GET /favicon.ico 200 in 47ms
prisma:query SELECT 1
prisma:query SELECT 1
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`isActive` = ? ORDER BY `main`.`cryptocurrencies`.`isDefault` DESC, `main`.`cryptocurrencies`.`rank` ASC, `main`.`cryptocurrencies`.`createdAt` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`coin_data_collection`.`id`, `main`.`coin_data_collection`.`cryptoId`, `main`.`coin_data_collection`.`status`, `main`.`coin_data_collection`.`lastCollected`, `main`.`coin_data_collection`.`nextCollection`, `main`.`coin_data_collection`.`errorCount`, `main`.`coin_data_collection`.`lastError`, `main`.`coin_data_collection`.`metadata` FROM `main`.`coin_data_collection` WHERE `main`.`coin_data_collection`.`cryptoId` IN (?,?,?,?,?) LIMIT ? OFFSET ?
 GET /api/cryptocurrencies?activeOnly=true 200 in 72ms
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE `main`.`analysis_history`.`cryptoId` = ? ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/dashboard?coinId=bitcoin 200 in 100ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/trading-signals-fast?action=signal&coinId=bitcoin 200 in 70ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/alerts-fast?action=process-data&coinId=bitcoin 200 in 128ms
🤖 [1754883891024-n53a84b3b] Starting AI analysis operation: AI_ENHANCED_ANALYSIS for bitcoin
📊 [1754883891024-n53a84b3b] Request data: {
  "marketData": {
    "price": {
      "usd": 117775,
      "usd_24h_change": 0.8618738474048199,
      "usd_24h_vol": 33776641957.26242,
      "usd_market_cap": 2343795976558.965
    },
    "onChain": {
      "mvrv": 1.8,
      "nupl": 0.65,
      "sopr": 1.02,
      "activeAddresses": 950000,
      "exchangeInflow": 15000,
      "exchangeOutflow": 12000,
      "transactionVolume": 25000000000,
      "supplyDistribution": {
        "whaleHoldings": {
          "percentage": 42.3,
          "addressCount": 850
        },
        "retailHoldings": {
          "percentage": 38.7,
          "addressCount": 42000000
        },
        "exchangeHoldings": {
          "percentage": 12.5,
          "addressCount": 150
        },
        "otherHoldings": {
          "percentage": 6.5,
          "addressCount": 120000
        }
      },
      "whaleHoldingsPercentage": 42.3,
      "retailHoldingsPercentage": 38.7,
      "exchangeHoldingsPercentage": 12.5
    },
    "technical": {
      "rsi": 58.5,
      "ma50": 112000,
      "ma200": 108000,
      "macd": 145.5,
      "macdSignal": null,
      "bollingerUpper": 122000,
      "bollingerLower": 111000,
      "bollingerMiddle": 116627
    },
    "derivatives": {
      "openInterest": 18500000000,
      "fundingRate": 0.0125,
      "liquidationVolume": 45000000,
      "putCallRatio": 0.85
    },
    "sentiment": {
      "fearGreedIndex": 50,
      "fearGreedClassification": "Neutral",
      "social": {
        "twitterSentiment": 0.5,
        "redditSentiment": 0.5,
        "socialVolume": 45000,
        "engagementRate": 0.085,
        "influencerSentiment": 0.75,
        "trendingScore": 75
      },
      "news": {
        "newsSentiment": 0.5,
        "newsVolume": 1250,
        "positiveNewsCount": 780,
        "negativeNewsCount": 320,
        "neutralNewsCount": 150,
        "sentimentScore": 0.5,
        "buzzScore": 75
      },
      "googleTrends": {
        "trendsScore": 75,
        "searchVolume": 850000,
        "trendingKeywords": [
          "bitcoin price",
          "btc news",
          "bitcoin mining"
        ],
        "regionalInterest": {
          "US": 85,
          "CN": 72,
          "EU": 68,
          "JP": 45,
          "KR": 52
        },
        "relatedQueries": [
          {
            "query": "bitcoin price today",
            "score": 95,
            "rising": true
          },
          {
            "query": "bitcoin prediction",
            "score": 78,
            "rising": true
          },
          {
            "query": "bitcoin mining",
            "score": 65,
            "rising": false
          }
        ],
        "trendDirection": "stable"
      }
    },
    "analysis": {
      "signal": "GIỮ",
      "confidence": 60,
      "reasoning": "Z.AI: Phân tích dựa trên dữ liệu thị trường hiện tại.... | ChatGPT: Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên q...",
      "riskLevel": "MEDIUM",
      "aiModel": "Z.AI+ChatGPT"
    },
    "timestamp": "2025-08-11T03:44:50.577Z",
    "dataSource": "database"
  },
  "tradingSignal": {
    "signal": "HOLD",
    "confidence": 50,
    "reasoning": "Tín hiệu trung lập: Không đủ điều kiện để MUA hoặc BÁN. Cần theo dõi thêm.",
    "riskLevel": "MEDIUM",
    "conditions": {
      "mvrv": 1.8,
      "fearGreed": 50,
      "fundingRate": 0.0125,
      "sopr": 1.02,
      "rsi": 58.5,
      "nupl": 0.65,
      "volumeTrend": "increasing",
      "extremeDetected": false
    },
    "triggers": []
  },
  "alerts": [],
  "coinId": "bitcoin"
}
🤖 Starting AI analysis for bitcoin...
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE (`main`.`analysis_history`.`coinId` = ? AND `main`.`analysis_history`.`analysisType` = ?) ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
🤖 Using cached AI analysis for bitcoin
💾 [1754883891024-n53a84b3b] Using cached analysis for bitcoin (age: 1922754ms)
✅ [1754883891024-n53a84b3b] Completed AI_ENHANCED_ANALYSIS successfully (5ms)
🎯 [1754883891024-n53a84b3b] Final result: {
  "recommendation": "GIỮ",
  "timeframe": "Ngắn hạn",
  "riskFactors": [
    "Thị trường biến động thông thường"
  ],
  "entryPoints": "Chờ tín hiệu rõ ràng hơn trước khi vào lệnh",
  "exitPoints": "Chốt lời khi có biến động giá mạnh hoặc đạt mục tiêu lợi nhuận",
  "stopLoss": "Quản lý rủi ro chặt chẽ, stop loss tại mức biến động chấp nhận được",
  "takeProfit": "Take profit khi đạt lợi nhuận mục tiêu hoặc có thay đổi xu hướng",
  "zaiAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn",
    "breakoutPotential": "LOW",
    "reasoning": "Phân tích dựa trên dữ liệu thị trường hiện tại."
  },
  "chatGPTAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn đến trung hạn (1-4 tuần)",
    "breakoutPotential": "LOW",
    "reasoning": "Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên quan sát và chờ đợi tín hiệu tốt hơn."
  }
}
 POST /api/ai-analysis?action=analyze&coinId=bitcoin 200 in 61ms
 GET / 200 in 72ms
 GET /favicon.ico 200 in 50ms
prisma:query SELECT 1
prisma:query SELECT 1
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`isActive` = ? ORDER BY `main`.`cryptocurrencies`.`isDefault` DESC, `main`.`cryptocurrencies`.`rank` ASC, `main`.`cryptocurrencies`.`createdAt` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`coin_data_collection`.`id`, `main`.`coin_data_collection`.`cryptoId`, `main`.`coin_data_collection`.`status`, `main`.`coin_data_collection`.`lastCollected`, `main`.`coin_data_collection`.`nextCollection`, `main`.`coin_data_collection`.`errorCount`, `main`.`coin_data_collection`.`lastError`, `main`.`coin_data_collection`.`metadata` FROM `main`.`coin_data_collection` WHERE `main`.`coin_data_collection`.`cryptoId` IN (?,?,?,?,?) LIMIT ? OFFSET ?
 GET /api/cryptocurrencies?activeOnly=true 200 in 93ms
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE `main`.`analysis_history`.`cryptoId` = ? ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/dashboard?coinId=bitcoin 200 in 123ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/trading-signals-fast?action=signal&coinId=bitcoin 200 in 90ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/alerts-fast?action=process-data&coinId=bitcoin 200 in 97ms
🤖 [1754883978405-6arp7zcfx] Starting AI analysis operation: AI_ENHANCED_ANALYSIS for bitcoin
📊 [1754883978405-6arp7zcfx] Request data: {
  "marketData": {
    "price": {
      "usd": 117775,
      "usd_24h_change": 0.8618738474048199,
      "usd_24h_vol": 33776641957.26242,
      "usd_market_cap": 2343795976558.965
    },
    "onChain": {
      "mvrv": 1.8,
      "nupl": 0.65,
      "sopr": 1.02,
      "activeAddresses": 950000,
      "exchangeInflow": 15000,
      "exchangeOutflow": 12000,
      "transactionVolume": 25000000000,
      "supplyDistribution": {
        "whaleHoldings": {
          "percentage": 42.3,
          "addressCount": 850
        },
        "retailHoldings": {
          "percentage": 38.7,
          "addressCount": 42000000
        },
        "exchangeHoldings": {
          "percentage": 12.5,
          "addressCount": 150
        },
        "otherHoldings": {
          "percentage": 6.5,
          "addressCount": 120000
        }
      },
      "whaleHoldingsPercentage": 42.3,
      "retailHoldingsPercentage": 38.7,
      "exchangeHoldingsPercentage": 12.5
    },
    "technical": {
      "rsi": 58.5,
      "ma50": 112000,
      "ma200": 108000,
      "macd": 145.5,
      "macdSignal": null,
      "bollingerUpper": 122000,
      "bollingerLower": 111000,
      "bollingerMiddle": 116627
    },
    "derivatives": {
      "openInterest": 18500000000,
      "fundingRate": 0.0125,
      "liquidationVolume": 45000000,
      "putCallRatio": 0.85
    },
    "sentiment": {
      "fearGreedIndex": 50,
      "fearGreedClassification": "Neutral",
      "social": {
        "twitterSentiment": 0.5,
        "redditSentiment": 0.5,
        "socialVolume": 45000,
        "engagementRate": 0.085,
        "influencerSentiment": 0.75,
        "trendingScore": 75
      },
      "news": {
        "newsSentiment": 0.5,
        "newsVolume": 1250,
        "positiveNewsCount": 780,
        "negativeNewsCount": 320,
        "neutralNewsCount": 150,
        "sentimentScore": 0.5,
        "buzzScore": 75
      },
      "googleTrends": {
        "trendsScore": 75,
        "searchVolume": 850000,
        "trendingKeywords": [
          "bitcoin price",
          "btc news",
          "bitcoin mining"
        ],
        "regionalInterest": {
          "US": 85,
          "CN": 72,
          "EU": 68,
          "JP": 45,
          "KR": 52
        },
        "relatedQueries": [
          {
            "query": "bitcoin price today",
            "score": 95,
            "rising": true
          },
          {
            "query": "bitcoin prediction",
            "score": 78,
            "rising": true
          },
          {
            "query": "bitcoin mining",
            "score": 65,
            "rising": false
          }
        ],
        "trendDirection": "stable"
      }
    },
    "analysis": {
      "signal": "GIỮ",
      "confidence": 60,
      "reasoning": "Z.AI: Phân tích dựa trên dữ liệu thị trường hiện tại.... | ChatGPT: Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên q...",
      "riskLevel": "MEDIUM",
      "aiModel": "Z.AI+ChatGPT"
    },
    "timestamp": "2025-08-11T03:46:17.933Z",
    "dataSource": "database"
  },
  "tradingSignal": {
    "signal": "HOLD",
    "confidence": 50,
    "reasoning": "Tín hiệu trung lập: Không đủ điều kiện để MUA hoặc BÁN. Cần theo dõi thêm.",
    "riskLevel": "MEDIUM",
    "conditions": {
      "mvrv": 1.8,
      "fearGreed": 50,
      "fundingRate": 0.0125,
      "sopr": 1.02,
      "rsi": 58.5,
      "nupl": 0.65,
      "volumeTrend": "increasing",
      "extremeDetected": false
    },
    "triggers": []
  },
  "alerts": [],
  "coinId": "bitcoin"
}
🤖 Starting AI analysis for bitcoin...
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE (`main`.`analysis_history`.`coinId` = ? AND `main`.`analysis_history`.`analysisType` = ?) ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
🤖 Using cached AI analysis for bitcoin
💾 [1754883978405-6arp7zcfx] Using cached analysis for bitcoin (age: 2010136ms)
✅ [1754883978405-6arp7zcfx] Completed AI_ENHANCED_ANALYSIS successfully (6ms)
🎯 [1754883978405-6arp7zcfx] Final result: {
  "recommendation": "GIỮ",
  "timeframe": "Ngắn hạn",
  "riskFactors": [
    "Thị trường biến động thông thường"
  ],
  "entryPoints": "Chờ tín hiệu rõ ràng hơn trước khi vào lệnh",
  "exitPoints": "Chốt lời khi có biến động giá mạnh hoặc đạt mục tiêu lợi nhuận",
  "stopLoss": "Quản lý rủi ro chặt chẽ, stop loss tại mức biến động chấp nhận được",
  "takeProfit": "Take profit khi đạt lợi nhuận mục tiêu hoặc có thay đổi xu hướng",
  "zaiAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn",
    "breakoutPotential": "LOW",
    "reasoning": "Phân tích dựa trên dữ liệu thị trường hiện tại."
  },
  "chatGPTAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn đến trung hạn (1-4 tuần)",
    "breakoutPotential": "LOW",
    "reasoning": "Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên quan sát và chờ đợi tín hiệu tốt hơn."
  }
}
 POST /api/ai-analysis?action=analyze&coinId=bitcoin 200 in 52ms
 GET / 200 in 75ms
 GET /favicon.ico 200 in 37ms
prisma:query SELECT 1
prisma:query SELECT 1
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`isActive` = ? ORDER BY `main`.`cryptocurrencies`.`isDefault` DESC, `main`.`cryptocurrencies`.`rank` ASC, `main`.`cryptocurrencies`.`createdAt` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`coin_data_collection`.`id`, `main`.`coin_data_collection`.`cryptoId`, `main`.`coin_data_collection`.`status`, `main`.`coin_data_collection`.`lastCollected`, `main`.`coin_data_collection`.`nextCollection`, `main`.`coin_data_collection`.`errorCount`, `main`.`coin_data_collection`.`lastError`, `main`.`coin_data_collection`.`metadata` FROM `main`.`coin_data_collection` WHERE `main`.`coin_data_collection`.`cryptoId` IN (?,?,?,?,?) LIMIT ? OFFSET ?
 GET /api/cryptocurrencies?activeOnly=true 200 in 93ms
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE `main`.`analysis_history`.`cryptoId` = ? ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/dashboard?coinId=bitcoin 200 in 122ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/trading-signals-fast?action=signal&coinId=bitcoin 200 in 70ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/alerts-fast?action=process-data&coinId=bitcoin 200 in 65ms
 GET / 200 in 94ms
 GET /favicon.ico 200 in 40ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`isActive` = ? ORDER BY `main`.`cryptocurrencies`.`isDefault` DESC, `main`.`cryptocurrencies`.`rank` ASC, `main`.`cryptocurrencies`.`createdAt` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`coin_data_collection`.`id`, `main`.`coin_data_collection`.`cryptoId`, `main`.`coin_data_collection`.`status`, `main`.`coin_data_collection`.`lastCollected`, `main`.`coin_data_collection`.`nextCollection`, `main`.`coin_data_collection`.`errorCount`, `main`.`coin_data_collection`.`lastError`, `main`.`coin_data_collection`.`metadata` FROM `main`.`coin_data_collection` WHERE `main`.`coin_data_collection`.`cryptoId` IN (?,?,?,?,?) LIMIT ? OFFSET ?
 GET /api/cryptocurrencies?activeOnly=true 200 in 83ms
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE `main`.`analysis_history`.`cryptoId` = ? ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/dashboard?coinId=bitcoin 200 in 116ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/trading-signals-fast?action=signal&coinId=bitcoin 200 in 74ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/alerts-fast?action=process-data&coinId=bitcoin 200 in 72ms
🤖 [1754884119899-tmloajj8v] Starting AI analysis operation: AI_ENHANCED_ANALYSIS for bitcoin
📊 [1754884119899-tmloajj8v] Request data: {
  "marketData": {
    "price": {
      "usd": 117775,
      "usd_24h_change": 0.8618738474048199,
      "usd_24h_vol": 33776641957.26242,
      "usd_market_cap": 2343795976558.965
    },
    "onChain": {
      "mvrv": 1.8,
      "nupl": 0.65,
      "sopr": 1.02,
      "activeAddresses": 950000,
      "exchangeInflow": 15000,
      "exchangeOutflow": 12000,
      "transactionVolume": 25000000000,
      "supplyDistribution": {
        "whaleHoldings": {
          "percentage": 42.3,
          "addressCount": 850
        },
        "retailHoldings": {
          "percentage": 38.7,
          "addressCount": 42000000
        },
        "exchangeHoldings": {
          "percentage": 12.5,
          "addressCount": 150
        },
        "otherHoldings": {
          "percentage": 6.5,
          "addressCount": 120000
        }
      },
      "whaleHoldingsPercentage": 42.3,
      "retailHoldingsPercentage": 38.7,
      "exchangeHoldingsPercentage": 12.5
    },
    "technical": {
      "rsi": 58.5,
      "ma50": 112000,
      "ma200": 108000,
      "macd": 145.5,
      "macdSignal": null,
      "bollingerUpper": 122000,
      "bollingerLower": 111000,
      "bollingerMiddle": 116627
    },
    "derivatives": {
      "openInterest": 18500000000,
      "fundingRate": 0.0125,
      "liquidationVolume": 45000000,
      "putCallRatio": 0.85
    },
    "sentiment": {
      "fearGreedIndex": 50,
      "fearGreedClassification": "Neutral",
      "social": {
        "twitterSentiment": 0.5,
        "redditSentiment": 0.5,
        "socialVolume": 45000,
        "engagementRate": 0.085,
        "influencerSentiment": 0.75,
        "trendingScore": 75
      },
      "news": {
        "newsSentiment": 0.5,
        "newsVolume": 1250,
        "positiveNewsCount": 780,
        "negativeNewsCount": 320,
        "neutralNewsCount": 150,
        "sentimentScore": 0.5,
        "buzzScore": 75
      },
      "googleTrends": {
        "trendsScore": 75,
        "searchVolume": 850000,
        "trendingKeywords": [
          "bitcoin price",
          "btc news",
          "bitcoin mining"
        ],
        "regionalInterest": {
          "US": 85,
          "CN": 72,
          "EU": 68,
          "JP": 45,
          "KR": 52
        },
        "relatedQueries": [
          {
            "query": "bitcoin price today",
            "score": 95,
            "rising": true
          },
          {
            "query": "bitcoin prediction",
            "score": 78,
            "rising": true
          },
          {
            "query": "bitcoin mining",
            "score": 65,
            "rising": false
          }
        ],
        "trendDirection": "stable"
      }
    },
    "analysis": {
      "signal": "GIỮ",
      "confidence": 60,
      "reasoning": "Z.AI: Phân tích dựa trên dữ liệu thị trường hiện tại.... | ChatGPT: Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên q...",
      "riskLevel": "MEDIUM",
      "aiModel": "Z.AI+ChatGPT"
    },
    "timestamp": "2025-08-11T03:48:39.496Z",
    "dataSource": "database"
  },
  "tradingSignal": {
    "signal": "HOLD",
    "confidence": 50,
    "reasoning": "Tín hiệu trung lập: Không đủ điều kiện để MUA hoặc BÁN. Cần theo dõi thêm.",
    "riskLevel": "MEDIUM",
    "conditions": {
      "mvrv": 1.8,
      "fearGreed": 50,
      "fundingRate": 0.0125,
      "sopr": 1.02,
      "rsi": 58.5,
      "nupl": 0.65,
      "volumeTrend": "increasing",
      "extremeDetected": false
    },
    "triggers": []
  },
  "alerts": [],
  "coinId": "bitcoin"
}
🤖 Starting AI analysis for bitcoin...
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE (`main`.`analysis_history`.`coinId` = ? AND `main`.`analysis_history`.`analysisType` = ?) ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
🤖 Using cached AI analysis for bitcoin
💾 [1754884119899-tmloajj8v] Using cached analysis for bitcoin (age: 2151629ms)
✅ [1754884119899-tmloajj8v] Completed AI_ENHANCED_ANALYSIS successfully (5ms)
🎯 [1754884119899-tmloajj8v] Final result: {
  "recommendation": "GIỮ",
  "timeframe": "Ngắn hạn",
  "riskFactors": [
    "Thị trường biến động thông thường"
  ],
  "entryPoints": "Chờ tín hiệu rõ ràng hơn trước khi vào lệnh",
  "exitPoints": "Chốt lời khi có biến động giá mạnh hoặc đạt mục tiêu lợi nhuận",
  "stopLoss": "Quản lý rủi ro chặt chẽ, stop loss tại mức biến động chấp nhận được",
  "takeProfit": "Take profit khi đạt lợi nhuận mục tiêu hoặc có thay đổi xu hướng",
  "zaiAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn",
    "breakoutPotential": "LOW",
    "reasoning": "Phân tích dựa trên dữ liệu thị trường hiện tại."
  },
  "chatGPTAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn đến trung hạn (1-4 tuần)",
    "breakoutPotential": "LOW",
    "reasoning": "Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên quan sát và chờ đợi tín hiệu tốt hơn."
  }
}
 POST /api/ai-analysis?action=analyze&coinId=bitcoin 200 in 48ms
 GET / 200 in 69ms
 GET /favicon.ico 200 in 44ms
prisma:query SELECT 1
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`isActive` = ? ORDER BY `main`.`cryptocurrencies`.`isDefault` DESC, `main`.`cryptocurrencies`.`rank` ASC, `main`.`cryptocurrencies`.`createdAt` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`coin_data_collection`.`id`, `main`.`coin_data_collection`.`cryptoId`, `main`.`coin_data_collection`.`status`, `main`.`coin_data_collection`.`lastCollected`, `main`.`coin_data_collection`.`nextCollection`, `main`.`coin_data_collection`.`errorCount`, `main`.`coin_data_collection`.`lastError`, `main`.`coin_data_collection`.`metadata` FROM `main`.`coin_data_collection` WHERE `main`.`coin_data_collection`.`cryptoId` IN (?,?,?,?,?) LIMIT ? OFFSET ?
 GET /api/cryptocurrencies?activeOnly=true 200 in 72ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE `main`.`analysis_history`.`cryptoId` = ? ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/dashboard?coinId=bitcoin 200 in 119ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/trading-signals-fast?action=signal&coinId=bitcoin 200 in 84ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/alerts-fast?action=process-data&coinId=bitcoin 200 in 77ms
🤖 [1754884140358-bz4p2srh0] Starting AI analysis operation: AI_ENHANCED_ANALYSIS for bitcoin
📊 [1754884140358-bz4p2srh0] Request data: {
  "marketData": {
    "price": {
      "usd": 117775,
      "usd_24h_change": 0.8618738474048199,
      "usd_24h_vol": 33776641957.26242,
      "usd_market_cap": 2343795976558.965
    },
    "onChain": {
      "mvrv": 1.8,
      "nupl": 0.65,
      "sopr": 1.02,
      "activeAddresses": 950000,
      "exchangeInflow": 15000,
      "exchangeOutflow": 12000,
      "transactionVolume": 25000000000,
      "supplyDistribution": {
        "whaleHoldings": {
          "percentage": 42.3,
          "addressCount": 850
        },
        "retailHoldings": {
          "percentage": 38.7,
          "addressCount": 42000000
        },
        "exchangeHoldings": {
          "percentage": 12.5,
          "addressCount": 150
        },
        "otherHoldings": {
          "percentage": 6.5,
          "addressCount": 120000
        }
      },
      "whaleHoldingsPercentage": 42.3,
      "retailHoldingsPercentage": 38.7,
      "exchangeHoldingsPercentage": 12.5
    },
    "technical": {
      "rsi": 58.5,
      "ma50": 112000,
      "ma200": 108000,
      "macd": 145.5,
      "macdSignal": null,
      "bollingerUpper": 122000,
      "bollingerLower": 111000,
      "bollingerMiddle": 116627
    },
    "derivatives": {
      "openInterest": 18500000000,
      "fundingRate": 0.0125,
      "liquidationVolume": 45000000,
      "putCallRatio": 0.85
    },
    "sentiment": {
      "fearGreedIndex": 50,
      "fearGreedClassification": "Neutral",
      "social": {
        "twitterSentiment": 0.5,
        "redditSentiment": 0.5,
        "socialVolume": 45000,
        "engagementRate": 0.085,
        "influencerSentiment": 0.75,
        "trendingScore": 75
      },
      "news": {
        "newsSentiment": 0.5,
        "newsVolume": 1250,
        "positiveNewsCount": 780,
        "negativeNewsCount": 320,
        "neutralNewsCount": 150,
        "sentimentScore": 0.5,
        "buzzScore": 75
      },
      "googleTrends": {
        "trendsScore": 75,
        "searchVolume": 850000,
        "trendingKeywords": [
          "bitcoin price",
          "btc news",
          "bitcoin mining"
        ],
        "regionalInterest": {
          "US": 85,
          "CN": 72,
          "EU": 68,
          "JP": 45,
          "KR": 52
        },
        "relatedQueries": [
          {
            "query": "bitcoin price today",
            "score": 95,
            "rising": true
          },
          {
            "query": "bitcoin prediction",
            "score": 78,
            "rising": true
          },
          {
            "query": "bitcoin mining",
            "score": 65,
            "rising": false
          }
        ],
        "trendDirection": "stable"
      }
    },
    "analysis": {
      "signal": "GIỮ",
      "confidence": 60,
      "reasoning": "Z.AI: Phân tích dựa trên dữ liệu thị trường hiện tại.... | ChatGPT: Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên q...",
      "riskLevel": "MEDIUM",
      "aiModel": "Z.AI+ChatGPT"
    },
    "timestamp": "2025-08-11T03:48:58.856Z",
    "dataSource": "database"
  },
  "tradingSignal": {
    "signal": "HOLD",
    "confidence": 50,
    "reasoning": "Tín hiệu trung lập: Không đủ điều kiện để MUA hoặc BÁN. Cần theo dõi thêm.",
    "riskLevel": "MEDIUM",
    "conditions": {
      "mvrv": 1.8,
      "fearGreed": 50,
      "fundingRate": 0.0125,
      "sopr": 1.02,
      "rsi": 58.5,
      "nupl": 0.65,
      "volumeTrend": "increasing",
      "extremeDetected": false
    },
    "triggers": []
  },
  "alerts": [],
  "coinId": "bitcoin"
}
🤖 Starting AI analysis for bitcoin...
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE (`main`.`analysis_history`.`coinId` = ? AND `main`.`analysis_history`.`analysisType` = ?) ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
🤖 Using cached AI analysis for bitcoin
💾 [1754884140358-bz4p2srh0] Using cached analysis for bitcoin (age: 2172089ms)
✅ [1754884140358-bz4p2srh0] Completed AI_ENHANCED_ANALYSIS successfully (6ms)
🎯 [1754884140358-bz4p2srh0] Final result: {
  "recommendation": "GIỮ",
  "timeframe": "Ngắn hạn",
  "riskFactors": [
    "Thị trường biến động thông thường"
  ],
  "entryPoints": "Chờ tín hiệu rõ ràng hơn trước khi vào lệnh",
  "exitPoints": "Chốt lời khi có biến động giá mạnh hoặc đạt mục tiêu lợi nhuận",
  "stopLoss": "Quản lý rủi ro chặt chẽ, stop loss tại mức biến động chấp nhận được",
  "takeProfit": "Take profit khi đạt lợi nhuận mục tiêu hoặc có thay đổi xu hướng",
  "zaiAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn",
    "breakoutPotential": "LOW",
    "reasoning": "Phân tích dựa trên dữ liệu thị trường hiện tại."
  },
  "chatGPTAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn đến trung hạn (1-4 tuần)",
    "breakoutPotential": "LOW",
    "reasoning": "Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên quan sát và chờ đợi tín hiệu tốt hơn."
  }
}
 POST /api/ai-analysis?action=analyze&coinId=bitcoin 200 in 47ms
 GET / 200 in 75ms
 GET /favicon.ico 200 in 72ms
prisma:query SELECT 1
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`isActive` = ? ORDER BY `main`.`cryptocurrencies`.`isDefault` DESC, `main`.`cryptocurrencies`.`rank` ASC, `main`.`cryptocurrencies`.`createdAt` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`coin_data_collection`.`id`, `main`.`coin_data_collection`.`cryptoId`, `main`.`coin_data_collection`.`status`, `main`.`coin_data_collection`.`lastCollected`, `main`.`coin_data_collection`.`nextCollection`, `main`.`coin_data_collection`.`errorCount`, `main`.`coin_data_collection`.`lastError`, `main`.`coin_data_collection`.`metadata` FROM `main`.`coin_data_collection` WHERE `main`.`coin_data_collection`.`cryptoId` IN (?,?,?,?,?) LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/cryptocurrencies?activeOnly=true 200 in 88ms
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE `main`.`analysis_history`.`cryptoId` = ? ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/dashboard?coinId=bitcoin 200 in 120ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/trading-signals-fast?action=signal&coinId=bitcoin 200 in 83ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/alerts-fast?action=process-data&coinId=bitcoin 200 in 71ms
🤖 [1754884146597-8hw9arbuc] Starting AI analysis operation: AI_ENHANCED_ANALYSIS for bitcoin
📊 [1754884146597-8hw9arbuc] Request data: {
  "marketData": {
    "price": {
      "usd": 117775,
      "usd_24h_change": 0.8618738474048199,
      "usd_24h_vol": 33776641957.26242,
      "usd_market_cap": 2343795976558.965
    },
    "onChain": {
      "mvrv": 1.8,
      "nupl": 0.65,
      "sopr": 1.02,
      "activeAddresses": 950000,
      "exchangeInflow": 15000,
      "exchangeOutflow": 12000,
      "transactionVolume": 25000000000,
      "supplyDistribution": {
        "whaleHoldings": {
          "percentage": 42.3,
          "addressCount": 850
        },
        "retailHoldings": {
          "percentage": 38.7,
          "addressCount": 42000000
        },
        "exchangeHoldings": {
          "percentage": 12.5,
          "addressCount": 150
        },
        "otherHoldings": {
          "percentage": 6.5,
          "addressCount": 120000
        }
      },
      "whaleHoldingsPercentage": 42.3,
      "retailHoldingsPercentage": 38.7,
      "exchangeHoldingsPercentage": 12.5
    },
    "technical": {
      "rsi": 58.5,
      "ma50": 112000,
      "ma200": 108000,
      "macd": 145.5,
      "macdSignal": null,
      "bollingerUpper": 122000,
      "bollingerLower": 111000,
      "bollingerMiddle": 116627
    },
    "derivatives": {
      "openInterest": 18500000000,
      "fundingRate": 0.0125,
      "liquidationVolume": 45000000,
      "putCallRatio": 0.85
    },
    "sentiment": {
      "fearGreedIndex": 50,
      "fearGreedClassification": "Neutral",
      "social": {
        "twitterSentiment": 0.5,
        "redditSentiment": 0.5,
        "socialVolume": 45000,
        "engagementRate": 0.085,
        "influencerSentiment": 0.75,
        "trendingScore": 75
      },
      "news": {
        "newsSentiment": 0.5,
        "newsVolume": 1250,
        "positiveNewsCount": 780,
        "negativeNewsCount": 320,
        "neutralNewsCount": 150,
        "sentimentScore": 0.5,
        "buzzScore": 75
      },
      "googleTrends": {
        "trendsScore": 75,
        "searchVolume": 850000,
        "trendingKeywords": [
          "bitcoin price",
          "btc news",
          "bitcoin mining"
        ],
        "regionalInterest": {
          "US": 85,
          "CN": 72,
          "EU": 68,
          "JP": 45,
          "KR": 52
        },
        "relatedQueries": [
          {
            "query": "bitcoin price today",
            "score": 95,
            "rising": true
          },
          {
            "query": "bitcoin prediction",
            "score": 78,
            "rising": true
          },
          {
            "query": "bitcoin mining",
            "score": 65,
            "rising": false
          }
        ],
        "trendDirection": "stable"
      }
    },
    "analysis": {
      "signal": "GIỮ",
      "confidence": 60,
      "reasoning": "Z.AI: Phân tích dựa trên dữ liệu thị trường hiện tại.... | ChatGPT: Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên q...",
      "riskLevel": "MEDIUM",
      "aiModel": "Z.AI+ChatGPT"
    },
    "timestamp": "2025-08-11T03:49:05.109Z",
    "dataSource": "database"
  },
  "tradingSignal": {
    "signal": "HOLD",
    "confidence": 50,
    "reasoning": "Tín hiệu trung lập: Không đủ điều kiện để MUA hoặc BÁN. Cần theo dõi thêm.",
    "riskLevel": "MEDIUM",
    "conditions": {
      "mvrv": 1.8,
      "fearGreed": 50,
      "fundingRate": 0.0125,
      "sopr": 1.02,
      "rsi": 58.5,
      "nupl": 0.65,
      "volumeTrend": "increasing",
      "extremeDetected": false
    },
    "triggers": []
  },
  "alerts": [],
  "coinId": "bitcoin"
}
🤖 Starting AI analysis for bitcoin...
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE (`main`.`analysis_history`.`coinId` = ? AND `main`.`analysis_history`.`analysisType` = ?) ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
🤖 Using cached AI analysis for bitcoin
💾 [1754884146597-8hw9arbuc] Using cached analysis for bitcoin (age: 2178329ms)
✅ [1754884146597-8hw9arbuc] Completed AI_ENHANCED_ANALYSIS successfully (7ms)
🎯 [1754884146597-8hw9arbuc] Final result: {
  "recommendation": "GIỮ",
  "timeframe": "Ngắn hạn",
  "riskFactors": [
    "Thị trường biến động thông thường"
  ],
  "entryPoints": "Chờ tín hiệu rõ ràng hơn trước khi vào lệnh",
  "exitPoints": "Chốt lời khi có biến động giá mạnh hoặc đạt mục tiêu lợi nhuận",
  "stopLoss": "Quản lý rủi ro chặt chẽ, stop loss tại mức biến động chấp nhận được",
  "takeProfit": "Take profit khi đạt lợi nhuận mục tiêu hoặc có thay đổi xu hướng",
  "zaiAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn",
    "breakoutPotential": "LOW",
    "reasoning": "Phân tích dựa trên dữ liệu thị trường hiện tại."
  },
  "chatGPTAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn đến trung hạn (1-4 tuần)",
    "breakoutPotential": "LOW",
    "reasoning": "Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên quan sát và chờ đợi tín hiệu tốt hơn."
  }
}
 POST /api/ai-analysis?action=analyze&coinId=bitcoin 200 in 45ms
 GET / 200 in 66ms
 GET /favicon.ico 200 in 40ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`isActive` = ? ORDER BY `main`.`cryptocurrencies`.`isDefault` DESC, `main`.`cryptocurrencies`.`rank` ASC, `main`.`cryptocurrencies`.`createdAt` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`coin_data_collection`.`id`, `main`.`coin_data_collection`.`cryptoId`, `main`.`coin_data_collection`.`status`, `main`.`coin_data_collection`.`lastCollected`, `main`.`coin_data_collection`.`nextCollection`, `main`.`coin_data_collection`.`errorCount`, `main`.`coin_data_collection`.`lastError`, `main`.`coin_data_collection`.`metadata` FROM `main`.`coin_data_collection` WHERE `main`.`coin_data_collection`.`cryptoId` IN (?,?,?,?,?) LIMIT ? OFFSET ?
 GET /api/cryptocurrencies?activeOnly=true 200 in 71ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE `main`.`analysis_history`.`cryptoId` = ? ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/dashboard?coinId=bitcoin 200 in 124ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/trading-signals-fast?action=signal&coinId=bitcoin 200 in 78ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/alerts-fast?action=process-data&coinId=bitcoin 200 in 67ms
🤖 [1754884148995-mgmoq98ce] Starting AI analysis operation: AI_ENHANCED_ANALYSIS for bitcoin
📊 [1754884148995-mgmoq98ce] Request data: {
  "marketData": {
    "price": {
      "usd": 117775,
      "usd_24h_change": 0.8618738474048199,
      "usd_24h_vol": 33776641957.26242,
      "usd_market_cap": 2343795976558.965
    },
    "onChain": {
      "mvrv": 1.8,
      "nupl": 0.65,
      "sopr": 1.02,
      "activeAddresses": 950000,
      "exchangeInflow": 15000,
      "exchangeOutflow": 12000,
      "transactionVolume": 25000000000,
      "supplyDistribution": {
        "whaleHoldings": {
          "percentage": 42.3,
          "addressCount": 850
        },
        "retailHoldings": {
          "percentage": 38.7,
          "addressCount": 42000000
        },
        "exchangeHoldings": {
          "percentage": 12.5,
          "addressCount": 150
        },
        "otherHoldings": {
          "percentage": 6.5,
          "addressCount": 120000
        }
      },
      "whaleHoldingsPercentage": 42.3,
      "retailHoldingsPercentage": 38.7,
      "exchangeHoldingsPercentage": 12.5
    },
    "technical": {
      "rsi": 58.5,
      "ma50": 112000,
      "ma200": 108000,
      "macd": 145.5,
      "macdSignal": null,
      "bollingerUpper": 122000,
      "bollingerLower": 111000,
      "bollingerMiddle": 116627
    },
    "derivatives": {
      "openInterest": 18500000000,
      "fundingRate": 0.0125,
      "liquidationVolume": 45000000,
      "putCallRatio": 0.85
    },
    "sentiment": {
      "fearGreedIndex": 50,
      "fearGreedClassification": "Neutral",
      "social": {
        "twitterSentiment": 0.5,
        "redditSentiment": 0.5,
        "socialVolume": 45000,
        "engagementRate": 0.085,
        "influencerSentiment": 0.75,
        "trendingScore": 75
      },
      "news": {
        "newsSentiment": 0.5,
        "newsVolume": 1250,
        "positiveNewsCount": 780,
        "negativeNewsCount": 320,
        "neutralNewsCount": 150,
        "sentimentScore": 0.5,
        "buzzScore": 75
      },
      "googleTrends": {
        "trendsScore": 75,
        "searchVolume": 850000,
        "trendingKeywords": [
          "bitcoin price",
          "btc news",
          "bitcoin mining"
        ],
        "regionalInterest": {
          "US": 85,
          "CN": 72,
          "EU": 68,
          "JP": 45,
          "KR": 52
        },
        "relatedQueries": [
          {
            "query": "bitcoin price today",
            "score": 95,
            "rising": true
          },
          {
            "query": "bitcoin prediction",
            "score": 78,
            "rising": true
          },
          {
            "query": "bitcoin mining",
            "score": 65,
            "rising": false
          }
        ],
        "trendDirection": "stable"
      }
    },
    "analysis": {
      "signal": "GIỮ",
      "confidence": 60,
      "reasoning": "Z.AI: Phân tích dựa trên dữ liệu thị trường hiện tại.... | ChatGPT: Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên q...",
      "riskLevel": "MEDIUM",
      "aiModel": "Z.AI+ChatGPT"
    },
    "timestamp": "2025-08-11T03:49:08.587Z",
    "dataSource": "database"
  },
  "tradingSignal": {
    "signal": "HOLD",
    "confidence": 50,
    "reasoning": "Tín hiệu trung lập: Không đủ điều kiện để MUA hoặc BÁN. Cần theo dõi thêm.",
    "riskLevel": "MEDIUM",
    "conditions": {
      "mvrv": 1.8,
      "fearGreed": 50,
      "fundingRate": 0.0125,
      "sopr": 1.02,
      "rsi": 58.5,
      "nupl": 0.65,
      "volumeTrend": "increasing",
      "extremeDetected": false
    },
    "triggers": []
  },
  "alerts": [],
  "coinId": "bitcoin"
}
🤖 Starting AI analysis for bitcoin...
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE (`main`.`analysis_history`.`coinId` = ? AND `main`.`analysis_history`.`analysisType` = ?) ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
🤖 Using cached AI analysis for bitcoin
💾 [1754884148995-mgmoq98ce] Using cached analysis for bitcoin (age: 2180725ms)
✅ [1754884148995-mgmoq98ce] Completed AI_ENHANCED_ANALYSIS successfully (5ms)
🎯 [1754884148995-mgmoq98ce] Final result: {
  "recommendation": "GIỮ",
  "timeframe": "Ngắn hạn",
  "riskFactors": [
    "Thị trường biến động thông thường"
  ],
  "entryPoints": "Chờ tín hiệu rõ ràng hơn trước khi vào lệnh",
  "exitPoints": "Chốt lời khi có biến động giá mạnh hoặc đạt mục tiêu lợi nhuận",
  "stopLoss": "Quản lý rủi ro chặt chẽ, stop loss tại mức biến động chấp nhận được",
  "takeProfit": "Take profit khi đạt lợi nhuận mục tiêu hoặc có thay đổi xu hướng",
  "zaiAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn",
    "breakoutPotential": "LOW",
    "reasoning": "Phân tích dựa trên dữ liệu thị trường hiện tại."
  },
  "chatGPTAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn đến trung hạn (1-4 tuần)",
    "breakoutPotential": "LOW",
    "reasoning": "Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên quan sát và chờ đợi tín hiệu tốt hơn."
  }
}
 POST /api/ai-analysis?action=analyze&coinId=bitcoin 200 in 51ms
 GET / 200 in 66ms
 GET /favicon.ico 200 in 39ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`isActive` = ? ORDER BY `main`.`cryptocurrencies`.`isDefault` DESC, `main`.`cryptocurrencies`.`rank` ASC, `main`.`cryptocurrencies`.`createdAt` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`coin_data_collection`.`id`, `main`.`coin_data_collection`.`cryptoId`, `main`.`coin_data_collection`.`status`, `main`.`coin_data_collection`.`lastCollected`, `main`.`coin_data_collection`.`nextCollection`, `main`.`coin_data_collection`.`errorCount`, `main`.`coin_data_collection`.`lastError`, `main`.`coin_data_collection`.`metadata` FROM `main`.`coin_data_collection` WHERE `main`.`coin_data_collection`.`cryptoId` IN (?,?,?,?,?) LIMIT ? OFFSET ?
 GET /api/cryptocurrencies?activeOnly=true 200 in 94ms
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE `main`.`analysis_history`.`cryptoId` = ? ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/dashboard?coinId=bitcoin 200 in 112ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/trading-signals-fast?action=signal&coinId=bitcoin 200 in 86ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/alerts-fast?action=process-data&coinId=bitcoin 200 in 99ms
🤖 [1754884153593-umdxgr9t2] Starting AI analysis operation: AI_ENHANCED_ANALYSIS for bitcoin
📊 [1754884153593-umdxgr9t2] Request data: {
  "marketData": {
    "price": {
      "usd": 117775,
      "usd_24h_change": 0.8618738474048199,
      "usd_24h_vol": 33776641957.26242,
      "usd_market_cap": 2343795976558.965
    },
    "onChain": {
      "mvrv": 1.8,
      "nupl": 0.65,
      "sopr": 1.02,
      "activeAddresses": 950000,
      "exchangeInflow": 15000,
      "exchangeOutflow": 12000,
      "transactionVolume": 25000000000,
      "supplyDistribution": {
        "whaleHoldings": {
          "percentage": 42.3,
          "addressCount": 850
        },
        "retailHoldings": {
          "percentage": 38.7,
          "addressCount": 42000000
        },
        "exchangeHoldings": {
          "percentage": 12.5,
          "addressCount": 150
        },
        "otherHoldings": {
          "percentage": 6.5,
          "addressCount": 120000
        }
      },
      "whaleHoldingsPercentage": 42.3,
      "retailHoldingsPercentage": 38.7,
      "exchangeHoldingsPercentage": 12.5
    },
    "technical": {
      "rsi": 58.5,
      "ma50": 112000,
      "ma200": 108000,
      "macd": 145.5,
      "macdSignal": null,
      "bollingerUpper": 122000,
      "bollingerLower": 111000,
      "bollingerMiddle": 116627
    },
    "derivatives": {
      "openInterest": 18500000000,
      "fundingRate": 0.0125,
      "liquidationVolume": 45000000,
      "putCallRatio": 0.85
    },
    "sentiment": {
      "fearGreedIndex": 50,
      "fearGreedClassification": "Neutral",
      "social": {
        "twitterSentiment": 0.5,
        "redditSentiment": 0.5,
        "socialVolume": 45000,
        "engagementRate": 0.085,
        "influencerSentiment": 0.75,
        "trendingScore": 75
      },
      "news": {
        "newsSentiment": 0.5,
        "newsVolume": 1250,
        "positiveNewsCount": 780,
        "negativeNewsCount": 320,
        "neutralNewsCount": 150,
        "sentimentScore": 0.5,
        "buzzScore": 75
      },
      "googleTrends": {
        "trendsScore": 75,
        "searchVolume": 850000,
        "trendingKeywords": [
          "bitcoin price",
          "btc news",
          "bitcoin mining"
        ],
        "regionalInterest": {
          "US": 85,
          "CN": 72,
          "EU": 68,
          "JP": 45,
          "KR": 52
        },
        "relatedQueries": [
          {
            "query": "bitcoin price today",
            "score": 95,
            "rising": true
          },
          {
            "query": "bitcoin prediction",
            "score": 78,
            "rising": true
          },
          {
            "query": "bitcoin mining",
            "score": 65,
            "rising": false
          }
        ],
        "trendDirection": "stable"
      }
    },
    "analysis": {
      "signal": "GIỮ",
      "confidence": 60,
      "reasoning": "Z.AI: Phân tích dựa trên dữ liệu thị trường hiện tại.... | ChatGPT: Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên q...",
      "riskLevel": "MEDIUM",
      "aiModel": "Z.AI+ChatGPT"
    },
    "timestamp": "2025-08-11T03:49:13.164Z",
    "dataSource": "database"
  },
  "tradingSignal": {
    "signal": "HOLD",
    "confidence": 50,
    "reasoning": "Tín hiệu trung lập: Không đủ điều kiện để MUA hoặc BÁN. Cần theo dõi thêm.",
    "riskLevel": "MEDIUM",
    "conditions": {
      "mvrv": 1.8,
      "fearGreed": 50,
      "fundingRate": 0.0125,
      "sopr": 1.02,
      "rsi": 58.5,
      "nupl": 0.65,
      "volumeTrend": "increasing",
      "extremeDetected": false
    },
    "triggers": []
  },
  "alerts": [],
  "coinId": "bitcoin"
}
🤖 Starting AI analysis for bitcoin...
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE (`main`.`analysis_history`.`coinId` = ? AND `main`.`analysis_history`.`analysisType` = ?) ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
🤖 Using cached AI analysis for bitcoin
💾 [1754884153593-umdxgr9t2] Using cached analysis for bitcoin (age: 2185324ms)
✅ [1754884153593-umdxgr9t2] Completed AI_ENHANCED_ANALYSIS successfully (6ms)
🎯 [1754884153593-umdxgr9t2] Final result: {
  "recommendation": "GIỮ",
  "timeframe": "Ngắn hạn",
  "riskFactors": [
    "Thị trường biến động thông thường"
  ],
  "entryPoints": "Chờ tín hiệu rõ ràng hơn trước khi vào lệnh",
  "exitPoints": "Chốt lời khi có biến động giá mạnh hoặc đạt mục tiêu lợi nhuận",
  "stopLoss": "Quản lý rủi ro chặt chẽ, stop loss tại mức biến động chấp nhận được",
  "takeProfit": "Take profit khi đạt lợi nhuận mục tiêu hoặc có thay đổi xu hướng",
  "zaiAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn",
    "breakoutPotential": "LOW",
    "reasoning": "Phân tích dựa trên dữ liệu thị trường hiện tại."
  },
  "chatGPTAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn đến trung hạn (1-4 tuần)",
    "breakoutPotential": "LOW",
    "reasoning": "Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên quan sát và chờ đợi tín hiệu tốt hơn."
  }
}
 POST /api/ai-analysis?action=analyze&coinId=bitcoin 200 in 47ms
 GET / 200 in 90ms
 GET /favicon.ico 200 in 48ms
prisma:query SELECT 1
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT 1
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`isActive` = ? ORDER BY `main`.`cryptocurrencies`.`isDefault` DESC, `main`.`cryptocurrencies`.`rank` ASC, `main`.`cryptocurrencies`.`createdAt` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`coin_data_collection`.`id`, `main`.`coin_data_collection`.`cryptoId`, `main`.`coin_data_collection`.`status`, `main`.`coin_data_collection`.`lastCollected`, `main`.`coin_data_collection`.`nextCollection`, `main`.`coin_data_collection`.`errorCount`, `main`.`coin_data_collection`.`lastError`, `main`.`coin_data_collection`.`metadata` FROM `main`.`coin_data_collection` WHERE `main`.`coin_data_collection`.`cryptoId` IN (?,?,?,?,?) LIMIT ? OFFSET ?
 GET /api/cryptocurrencies?activeOnly=true 200 in 178ms
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE `main`.`analysis_history`.`cryptoId` = ? ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/dashboard?coinId=bitcoin 200 in 189ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/trading-signals-fast?action=signal&coinId=bitcoin 200 in 102ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/alerts-fast?action=process-data&coinId=bitcoin 200 in 95ms
🤖 [1754884183368-koj4p0inl] Starting AI analysis operation: AI_ENHANCED_ANALYSIS for bitcoin
📊 [1754884183368-koj4p0inl] Request data: {
  "marketData": {
    "price": {
      "usd": 117775,
      "usd_24h_change": 0.8618738474048199,
      "usd_24h_vol": 33776641957.26242,
      "usd_market_cap": 2343795976558.965
    },
    "onChain": {
      "mvrv": 1.8,
      "nupl": 0.65,
      "sopr": 1.02,
      "activeAddresses": 950000,
      "exchangeInflow": 15000,
      "exchangeOutflow": 12000,
      "transactionVolume": 25000000000,
      "supplyDistribution": {
        "whaleHoldings": {
          "percentage": 42.3,
          "addressCount": 850
        },
        "retailHoldings": {
          "percentage": 38.7,
          "addressCount": 42000000
        },
        "exchangeHoldings": {
          "percentage": 12.5,
          "addressCount": 150
        },
        "otherHoldings": {
          "percentage": 6.5,
          "addressCount": 120000
        }
      },
      "whaleHoldingsPercentage": 42.3,
      "retailHoldingsPercentage": 38.7,
      "exchangeHoldingsPercentage": 12.5
    },
    "technical": {
      "rsi": 58.5,
      "ma50": 112000,
      "ma200": 108000,
      "macd": 145.5,
      "macdSignal": null,
      "bollingerUpper": 122000,
      "bollingerLower": 111000,
      "bollingerMiddle": 116627
    },
    "derivatives": {
      "openInterest": 18500000000,
      "fundingRate": 0.0125,
      "liquidationVolume": 45000000,
      "putCallRatio": 0.85
    },
    "sentiment": {
      "fearGreedIndex": 50,
      "fearGreedClassification": "Neutral",
      "social": {
        "twitterSentiment": 0.5,
        "redditSentiment": 0.5,
        "socialVolume": 45000,
        "engagementRate": 0.085,
        "influencerSentiment": 0.75,
        "trendingScore": 75
      },
      "news": {
        "newsSentiment": 0.5,
        "newsVolume": 1250,
        "positiveNewsCount": 780,
        "negativeNewsCount": 320,
        "neutralNewsCount": 150,
        "sentimentScore": 0.5,
        "buzzScore": 75
      },
      "googleTrends": {
        "trendsScore": 75,
        "searchVolume": 850000,
        "trendingKeywords": [
          "bitcoin price",
          "btc news",
          "bitcoin mining"
        ],
        "regionalInterest": {
          "US": 85,
          "CN": 72,
          "EU": 68,
          "JP": 45,
          "KR": 52
        },
        "relatedQueries": [
          {
            "query": "bitcoin price today",
            "score": 95,
            "rising": true
          },
          {
            "query": "bitcoin prediction",
            "score": 78,
            "rising": true
          },
          {
            "query": "bitcoin mining",
            "score": 65,
            "rising": false
          }
        ],
        "trendDirection": "stable"
      }
    },
    "analysis": {
      "signal": "GIỮ",
      "confidence": 60,
      "reasoning": "Z.AI: Phân tích dựa trên dữ liệu thị trường hiện tại.... | ChatGPT: Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên q...",
      "riskLevel": "MEDIUM",
      "aiModel": "Z.AI+ChatGPT"
    },
    "timestamp": "2025-08-11T03:49:42.871Z",
    "dataSource": "database"
  },
  "tradingSignal": {
    "signal": "HOLD",
    "confidence": 50,
    "reasoning": "Tín hiệu trung lập: Không đủ điều kiện để MUA hoặc BÁN. Cần theo dõi thêm.",
    "riskLevel": "MEDIUM",
    "conditions": {
      "mvrv": 1.8,
      "fearGreed": 50,
      "fundingRate": 0.0125,
      "sopr": 1.02,
      "rsi": 58.5,
      "nupl": 0.65,
      "volumeTrend": "increasing",
      "extremeDetected": false
    },
    "triggers": []
  },
  "alerts": [],
  "coinId": "bitcoin"
}
🤖 Starting AI analysis for bitcoin...
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE (`main`.`analysis_history`.`coinId` = ? AND `main`.`analysis_history`.`analysisType` = ?) ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
🤖 Using cached AI analysis for bitcoin
💾 [1754884183368-koj4p0inl] Using cached analysis for bitcoin (age: 2215098ms)
✅ [1754884183368-koj4p0inl] Completed AI_ENHANCED_ANALYSIS successfully (5ms)
🎯 [1754884183368-koj4p0inl] Final result: {
  "recommendation": "GIỮ",
  "timeframe": "Ngắn hạn",
  "riskFactors": [
    "Thị trường biến động thông thường"
  ],
  "entryPoints": "Chờ tín hiệu rõ ràng hơn trước khi vào lệnh",
  "exitPoints": "Chốt lời khi có biến động giá mạnh hoặc đạt mục tiêu lợi nhuận",
  "stopLoss": "Quản lý rủi ro chặt chẽ, stop loss tại mức biến động chấp nhận được",
  "takeProfit": "Take profit khi đạt lợi nhuận mục tiêu hoặc có thay đổi xu hướng",
  "zaiAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn",
    "breakoutPotential": "LOW",
    "reasoning": "Phân tích dựa trên dữ liệu thị trường hiện tại."
  },
  "chatGPTAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn đến trung hạn (1-4 tuần)",
    "breakoutPotential": "LOW",
    "reasoning": "Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên quan sát và chờ đợi tín hiệu tốt hơn."
  }
}
 POST /api/ai-analysis?action=analyze&coinId=bitcoin 200 in 44ms
 GET / 200 in 65ms
 GET /favicon.ico 200 in 42ms
prisma:query SELECT 1
prisma:query SELECT 1
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`isActive` = ? ORDER BY `main`.`cryptocurrencies`.`isDefault` DESC, `main`.`cryptocurrencies`.`rank` ASC, `main`.`cryptocurrencies`.`createdAt` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`coin_data_collection`.`id`, `main`.`coin_data_collection`.`cryptoId`, `main`.`coin_data_collection`.`status`, `main`.`coin_data_collection`.`lastCollected`, `main`.`coin_data_collection`.`nextCollection`, `main`.`coin_data_collection`.`errorCount`, `main`.`coin_data_collection`.`lastError`, `main`.`coin_data_collection`.`metadata` FROM `main`.`coin_data_collection` WHERE `main`.`coin_data_collection`.`cryptoId` IN (?,?,?,?,?) LIMIT ? OFFSET ?
 GET /api/cryptocurrencies?activeOnly=true 200 in 100ms
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE `main`.`analysis_history`.`cryptoId` = ? ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/dashboard?coinId=bitcoin 200 in 127ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/trading-signals-fast?action=signal&coinId=bitcoin 200 in 68ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/alerts-fast?action=process-data&coinId=bitcoin 200 in 63ms
🤖 [1754884202073-k1167suz1] Starting AI analysis operation: AI_ENHANCED_ANALYSIS for bitcoin
📊 [1754884202073-k1167suz1] Request data: {
  "marketData": {
    "price": {
      "usd": 117775,
      "usd_24h_change": 0.8618738474048199,
      "usd_24h_vol": 33776641957.26242,
      "usd_market_cap": 2343795976558.965
    },
    "onChain": {
      "mvrv": 1.8,
      "nupl": 0.65,
      "sopr": 1.02,
      "activeAddresses": 950000,
      "exchangeInflow": 15000,
      "exchangeOutflow": 12000,
      "transactionVolume": 25000000000,
      "supplyDistribution": {
        "whaleHoldings": {
          "percentage": 42.3,
          "addressCount": 850
        },
        "retailHoldings": {
          "percentage": 38.7,
          "addressCount": 42000000
        },
        "exchangeHoldings": {
          "percentage": 12.5,
          "addressCount": 150
        },
        "otherHoldings": {
          "percentage": 6.5,
          "addressCount": 120000
        }
      },
      "whaleHoldingsPercentage": 42.3,
      "retailHoldingsPercentage": 38.7,
      "exchangeHoldingsPercentage": 12.5
    },
    "technical": {
      "rsi": 58.5,
      "ma50": 112000,
      "ma200": 108000,
      "macd": 145.5,
      "macdSignal": null,
      "bollingerUpper": 122000,
      "bollingerLower": 111000,
      "bollingerMiddle": 116627
    },
    "derivatives": {
      "openInterest": 18500000000,
      "fundingRate": 0.0125,
      "liquidationVolume": 45000000,
      "putCallRatio": 0.85
    },
    "sentiment": {
      "fearGreedIndex": 50,
      "fearGreedClassification": "Neutral",
      "social": {
        "twitterSentiment": 0.5,
        "redditSentiment": 0.5,
        "socialVolume": 45000,
        "engagementRate": 0.085,
        "influencerSentiment": 0.75,
        "trendingScore": 75
      },
      "news": {
        "newsSentiment": 0.5,
        "newsVolume": 1250,
        "positiveNewsCount": 780,
        "negativeNewsCount": 320,
        "neutralNewsCount": 150,
        "sentimentScore": 0.5,
        "buzzScore": 75
      },
      "googleTrends": {
        "trendsScore": 75,
        "searchVolume": 850000,
        "trendingKeywords": [
          "bitcoin price",
          "btc news",
          "bitcoin mining"
        ],
        "regionalInterest": {
          "US": 85,
          "CN": 72,
          "EU": 68,
          "JP": 45,
          "KR": 52
        },
        "relatedQueries": [
          {
            "query": "bitcoin price today",
            "score": 95,
            "rising": true
          },
          {
            "query": "bitcoin prediction",
            "score": 78,
            "rising": true
          },
          {
            "query": "bitcoin mining",
            "score": 65,
            "rising": false
          }
        ],
        "trendDirection": "stable"
      }
    },
    "analysis": {
      "signal": "GIỮ",
      "confidence": 60,
      "reasoning": "Z.AI: Phân tích dựa trên dữ liệu thị trường hiện tại.... | ChatGPT: Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên q...",
      "riskLevel": "MEDIUM",
      "aiModel": "Z.AI+ChatGPT"
    },
    "timestamp": "2025-08-11T03:50:01.688Z",
    "dataSource": "database"
  },
  "tradingSignal": {
    "signal": "HOLD",
    "confidence": 50,
    "reasoning": "Tín hiệu trung lập: Không đủ điều kiện để MUA hoặc BÁN. Cần theo dõi thêm.",
    "riskLevel": "MEDIUM",
    "conditions": {
      "mvrv": 1.8,
      "fearGreed": 50,
      "fundingRate": 0.0125,
      "sopr": 1.02,
      "rsi": 58.5,
      "nupl": 0.65,
      "volumeTrend": "increasing",
      "extremeDetected": false
    },
    "triggers": []
  },
  "alerts": [],
  "coinId": "bitcoin"
}
🤖 Starting AI analysis for bitcoin...
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE (`main`.`analysis_history`.`coinId` = ? AND `main`.`analysis_history`.`analysisType` = ?) ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
🤖 Using cached AI analysis for bitcoin
💾 [1754884202073-k1167suz1] Using cached analysis for bitcoin (age: 2233803ms)
✅ [1754884202073-k1167suz1] Completed AI_ENHANCED_ANALYSIS successfully (5ms)
🎯 [1754884202073-k1167suz1] Final result: {
  "recommendation": "GIỮ",
  "timeframe": "Ngắn hạn",
  "riskFactors": [
    "Thị trường biến động thông thường"
  ],
  "entryPoints": "Chờ tín hiệu rõ ràng hơn trước khi vào lệnh",
  "exitPoints": "Chốt lời khi có biến động giá mạnh hoặc đạt mục tiêu lợi nhuận",
  "stopLoss": "Quản lý rủi ro chặt chẽ, stop loss tại mức biến động chấp nhận được",
  "takeProfit": "Take profit khi đạt lợi nhuận mục tiêu hoặc có thay đổi xu hướng",
  "zaiAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn",
    "breakoutPotential": "LOW",
    "reasoning": "Phân tích dựa trên dữ liệu thị trường hiện tại."
  },
  "chatGPTAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn đến trung hạn (1-4 tuần)",
    "breakoutPotential": "LOW",
    "reasoning": "Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên quan sát và chờ đợi tín hiệu tốt hơn."
  }
}
 POST /api/ai-analysis?action=analyze&coinId=bitcoin 200 in 46ms
 GET / 200 in 154ms
 GET /favicon.ico 200 in 47ms
prisma:query SELECT 1
prisma:query SELECT 1
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`isActive` = ? ORDER BY `main`.`cryptocurrencies`.`isDefault` DESC, `main`.`cryptocurrencies`.`rank` ASC, `main`.`cryptocurrencies`.`createdAt` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`coin_data_collection`.`id`, `main`.`coin_data_collection`.`cryptoId`, `main`.`coin_data_collection`.`status`, `main`.`coin_data_collection`.`lastCollected`, `main`.`coin_data_collection`.`nextCollection`, `main`.`coin_data_collection`.`errorCount`, `main`.`coin_data_collection`.`lastError`, `main`.`coin_data_collection`.`metadata` FROM `main`.`coin_data_collection` WHERE `main`.`coin_data_collection`.`cryptoId` IN (?,?,?,?,?) LIMIT ? OFFSET ?
 GET /api/cryptocurrencies?activeOnly=true 200 in 77ms
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE `main`.`analysis_history`.`cryptoId` = ? ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/dashboard?coinId=bitcoin 200 in 100ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/trading-signals-fast?action=signal&coinId=bitcoin 200 in 70ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/alerts-fast?action=process-data&coinId=bitcoin 200 in 72ms
🤖 [1754884336143-d9bn55cue] Starting AI analysis operation: AI_ENHANCED_ANALYSIS for bitcoin
📊 [1754884336143-d9bn55cue] Request data: {
  "marketData": {
    "price": {
      "usd": 117775,
      "usd_24h_change": 0.8618738474048199,
      "usd_24h_vol": 33776641957.26242,
      "usd_market_cap": 2343795976558.965
    },
    "onChain": {
      "mvrv": 1.8,
      "nupl": 0.65,
      "sopr": 1.02,
      "activeAddresses": 950000,
      "exchangeInflow": 15000,
      "exchangeOutflow": 12000,
      "transactionVolume": 25000000000,
      "supplyDistribution": {
        "whaleHoldings": {
          "percentage": 42.3,
          "addressCount": 850
        },
        "retailHoldings": {
          "percentage": 38.7,
          "addressCount": 42000000
        },
        "exchangeHoldings": {
          "percentage": 12.5,
          "addressCount": 150
        },
        "otherHoldings": {
          "percentage": 6.5,
          "addressCount": 120000
        }
      },
      "whaleHoldingsPercentage": 42.3,
      "retailHoldingsPercentage": 38.7,
      "exchangeHoldingsPercentage": 12.5
    },
    "technical": {
      "rsi": 58.5,
      "ma50": 112000,
      "ma200": 108000,
      "macd": 145.5,
      "macdSignal": null,
      "bollingerUpper": 122000,
      "bollingerLower": 111000,
      "bollingerMiddle": 116627
    },
    "derivatives": {
      "openInterest": 18500000000,
      "fundingRate": 0.0125,
      "liquidationVolume": 45000000,
      "putCallRatio": 0.85
    },
    "sentiment": {
      "fearGreedIndex": 50,
      "fearGreedClassification": "Neutral",
      "social": {
        "twitterSentiment": 0.5,
        "redditSentiment": 0.5,
        "socialVolume": 45000,
        "engagementRate": 0.085,
        "influencerSentiment": 0.75,
        "trendingScore": 75
      },
      "news": {
        "newsSentiment": 0.5,
        "newsVolume": 1250,
        "positiveNewsCount": 780,
        "negativeNewsCount": 320,
        "neutralNewsCount": 150,
        "sentimentScore": 0.5,
        "buzzScore": 75
      },
      "googleTrends": {
        "trendsScore": 75,
        "searchVolume": 850000,
        "trendingKeywords": [
          "bitcoin price",
          "btc news",
          "bitcoin mining"
        ],
        "regionalInterest": {
          "US": 85,
          "CN": 72,
          "EU": 68,
          "JP": 45,
          "KR": 52
        },
        "relatedQueries": [
          {
            "query": "bitcoin price today",
            "score": 95,
            "rising": true
          },
          {
            "query": "bitcoin prediction",
            "score": 78,
            "rising": true
          },
          {
            "query": "bitcoin mining",
            "score": 65,
            "rising": false
          }
        ],
        "trendDirection": "stable"
      }
    },
    "analysis": {
      "signal": "GIỮ",
      "confidence": 60,
      "reasoning": "Z.AI: Phân tích dựa trên dữ liệu thị trường hiện tại.... | ChatGPT: Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên q...",
      "riskLevel": "MEDIUM",
      "aiModel": "Z.AI+ChatGPT"
    },
    "timestamp": "2025-08-11T03:52:15.739Z",
    "dataSource": "database"
  },
  "tradingSignal": {
    "signal": "HOLD",
    "confidence": 50,
    "reasoning": "Tín hiệu trung lập: Không đủ điều kiện để MUA hoặc BÁN. Cần theo dõi thêm.",
    "riskLevel": "MEDIUM",
    "conditions": {
      "mvrv": 1.8,
      "fearGreed": 50,
      "fundingRate": 0.0125,
      "sopr": 1.02,
      "rsi": 58.5,
      "nupl": 0.65,
      "volumeTrend": "increasing",
      "extremeDetected": false
    },
    "triggers": []
  },
  "alerts": [],
  "coinId": "bitcoin"
}
🤖 Starting AI analysis for bitcoin...
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE (`main`.`analysis_history`.`coinId` = ? AND `main`.`analysis_history`.`analysisType` = ?) ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
🤖 Using cached AI analysis for bitcoin
💾 [1754884336143-d9bn55cue] Using cached analysis for bitcoin (age: 2367874ms)
✅ [1754884336143-d9bn55cue] Completed AI_ENHANCED_ANALYSIS successfully (6ms)
🎯 [1754884336143-d9bn55cue] Final result: {
  "recommendation": "GIỮ",
  "timeframe": "Ngắn hạn",
  "riskFactors": [
    "Thị trường biến động thông thường"
  ],
  "entryPoints": "Chờ tín hiệu rõ ràng hơn trước khi vào lệnh",
  "exitPoints": "Chốt lời khi có biến động giá mạnh hoặc đạt mục tiêu lợi nhuận",
  "stopLoss": "Quản lý rủi ro chặt chẽ, stop loss tại mức biến động chấp nhận được",
  "takeProfit": "Take profit khi đạt lợi nhuận mục tiêu hoặc có thay đổi xu hướng",
  "zaiAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn",
    "breakoutPotential": "LOW",
    "reasoning": "Phân tích dựa trên dữ liệu thị trường hiện tại."
  },
  "chatGPTAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn đến trung hạn (1-4 tuần)",
    "breakoutPotential": "LOW",
    "reasoning": "Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên quan sát và chờ đợi tín hiệu tốt hơn."
  }
}
 POST /api/ai-analysis?action=analyze&coinId=bitcoin 200 in 56ms
 GET / 200 in 74ms
 GET /favicon.ico 200 in 44ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`isActive` = ? ORDER BY `main`.`cryptocurrencies`.`isDefault` DESC, `main`.`cryptocurrencies`.`rank` ASC, `main`.`cryptocurrencies`.`createdAt` DESC LIMIT ? OFFSET ?
 GET /api/cryptocurrencies?activeOnly=true 200 in 66ms
prisma:query SELECT `main`.`coin_data_collection`.`id`, `main`.`coin_data_collection`.`cryptoId`, `main`.`coin_data_collection`.`status`, `main`.`coin_data_collection`.`lastCollected`, `main`.`coin_data_collection`.`nextCollection`, `main`.`coin_data_collection`.`errorCount`, `main`.`coin_data_collection`.`lastError`, `main`.`coin_data_collection`.`metadata` FROM `main`.`coin_data_collection` WHERE `main`.`coin_data_collection`.`cryptoId` IN (?,?,?,?,?) LIMIT ? OFFSET ?
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE `main`.`analysis_history`.`cryptoId` = ? ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/dashboard?coinId=bitcoin 200 in 102ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/trading-signals-fast?action=signal&coinId=bitcoin 200 in 80ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/alerts-fast?action=process-data&coinId=bitcoin 200 in 71ms
🤖 [1754884339958-e6rbov70q] Starting AI analysis operation: AI_ENHANCED_ANALYSIS for bitcoin
📊 [1754884339958-e6rbov70q] Request data: {
  "marketData": {
    "price": {
      "usd": 117775,
      "usd_24h_change": 0.8618738474048199,
      "usd_24h_vol": 33776641957.26242,
      "usd_market_cap": 2343795976558.965
    },
    "onChain": {
      "mvrv": 1.8,
      "nupl": 0.65,
      "sopr": 1.02,
      "activeAddresses": 950000,
      "exchangeInflow": 15000,
      "exchangeOutflow": 12000,
      "transactionVolume": 25000000000,
      "supplyDistribution": {
        "whaleHoldings": {
          "percentage": 42.3,
          "addressCount": 850
        },
        "retailHoldings": {
          "percentage": 38.7,
          "addressCount": 42000000
        },
        "exchangeHoldings": {
          "percentage": 12.5,
          "addressCount": 150
        },
        "otherHoldings": {
          "percentage": 6.5,
          "addressCount": 120000
        }
      },
      "whaleHoldingsPercentage": 42.3,
      "retailHoldingsPercentage": 38.7,
      "exchangeHoldingsPercentage": 12.5
    },
    "technical": {
      "rsi": 58.5,
      "ma50": 112000,
      "ma200": 108000,
      "macd": 145.5,
      "macdSignal": null,
      "bollingerUpper": 122000,
      "bollingerLower": 111000,
      "bollingerMiddle": 116627
    },
    "derivatives": {
      "openInterest": 18500000000,
      "fundingRate": 0.0125,
      "liquidationVolume": 45000000,
      "putCallRatio": 0.85
    },
    "sentiment": {
      "fearGreedIndex": 50,
      "fearGreedClassification": "Neutral",
      "social": {
        "twitterSentiment": 0.5,
        "redditSentiment": 0.5,
        "socialVolume": 45000,
        "engagementRate": 0.085,
        "influencerSentiment": 0.75,
        "trendingScore": 75
      },
      "news": {
        "newsSentiment": 0.5,
        "newsVolume": 1250,
        "positiveNewsCount": 780,
        "negativeNewsCount": 320,
        "neutralNewsCount": 150,
        "sentimentScore": 0.5,
        "buzzScore": 75
      },
      "googleTrends": {
        "trendsScore": 75,
        "searchVolume": 850000,
        "trendingKeywords": [
          "bitcoin price",
          "btc news",
          "bitcoin mining"
        ],
        "regionalInterest": {
          "US": 85,
          "CN": 72,
          "EU": 68,
          "JP": 45,
          "KR": 52
        },
        "relatedQueries": [
          {
            "query": "bitcoin price today",
            "score": 95,
            "rising": true
          },
          {
            "query": "bitcoin prediction",
            "score": 78,
            "rising": true
          },
          {
            "query": "bitcoin mining",
            "score": 65,
            "rising": false
          }
        ],
        "trendDirection": "stable"
      }
    },
    "analysis": {
      "signal": "GIỮ",
      "confidence": 60,
      "reasoning": "Z.AI: Phân tích dựa trên dữ liệu thị trường hiện tại.... | ChatGPT: Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên q...",
      "riskLevel": "MEDIUM",
      "aiModel": "Z.AI+ChatGPT"
    },
    "timestamp": "2025-08-11T03:52:19.503Z",
    "dataSource": "database"
  },
  "tradingSignal": {
    "signal": "HOLD",
    "confidence": 50,
    "reasoning": "Tín hiệu trung lập: Không đủ điều kiện để MUA hoặc BÁN. Cần theo dõi thêm.",
    "riskLevel": "MEDIUM",
    "conditions": {
      "mvrv": 1.8,
      "fearGreed": 50,
      "fundingRate": 0.0125,
      "sopr": 1.02,
      "rsi": 58.5,
      "nupl": 0.65,
      "volumeTrend": "increasing",
      "extremeDetected": false
    },
    "triggers": []
  },
  "alerts": [],
  "coinId": "bitcoin"
}
🤖 Starting AI analysis for bitcoin...
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE (`main`.`analysis_history`.`coinId` = ? AND `main`.`analysis_history`.`analysisType` = ?) ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
🤖 Using cached AI analysis for bitcoin
💾 [1754884339958-e6rbov70q] Using cached analysis for bitcoin (age: 2371688ms)
✅ [1754884339958-e6rbov70q] Completed AI_ENHANCED_ANALYSIS successfully (5ms)
🎯 [1754884339958-e6rbov70q] Final result: {
  "recommendation": "GIỮ",
  "timeframe": "Ngắn hạn",
  "riskFactors": [
    "Thị trường biến động thông thường"
  ],
  "entryPoints": "Chờ tín hiệu rõ ràng hơn trước khi vào lệnh",
  "exitPoints": "Chốt lời khi có biến động giá mạnh hoặc đạt mục tiêu lợi nhuận",
  "stopLoss": "Quản lý rủi ro chặt chẽ, stop loss tại mức biến động chấp nhận được",
  "takeProfit": "Take profit khi đạt lợi nhuận mục tiêu hoặc có thay đổi xu hướng",
  "zaiAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn",
    "breakoutPotential": "LOW",
    "reasoning": "Phân tích dựa trên dữ liệu thị trường hiện tại."
  },
  "chatGPTAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn đến trung hạn (1-4 tuần)",
    "breakoutPotential": "LOW",
    "reasoning": "Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên quan sát và chờ đợi tín hiệu tốt hơn."
  }
}
 POST /api/ai-analysis?action=analyze&coinId=bitcoin 200 in 49ms
 GET / 200 in 66ms
 GET /favicon.ico 200 in 73ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`isActive` = ? ORDER BY `main`.`cryptocurrencies`.`isDefault` DESC, `main`.`cryptocurrencies`.`rank` ASC, `main`.`cryptocurrencies`.`createdAt` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`coin_data_collection`.`id`, `main`.`coin_data_collection`.`cryptoId`, `main`.`coin_data_collection`.`status`, `main`.`coin_data_collection`.`lastCollected`, `main`.`coin_data_collection`.`nextCollection`, `main`.`coin_data_collection`.`errorCount`, `main`.`coin_data_collection`.`lastError`, `main`.`coin_data_collection`.`metadata` FROM `main`.`coin_data_collection` WHERE `main`.`coin_data_collection`.`cryptoId` IN (?,?,?,?,?) LIMIT ? OFFSET ?
 GET /api/cryptocurrencies?activeOnly=true 200 in 112ms
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE `main`.`analysis_history`.`cryptoId` = ? ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/dashboard?coinId=bitcoin 200 in 157ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/trading-signals-fast?action=signal&coinId=bitcoin 200 in 122ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/alerts-fast?action=process-data&coinId=bitcoin 200 in 73ms
🤖 [1754884350808-rkaarelzp] Starting AI analysis operation: AI_ENHANCED_ANALYSIS for bitcoin
📊 [1754884350808-rkaarelzp] Request data: {
  "marketData": {
    "price": {
      "usd": 117775,
      "usd_24h_change": 0.8618738474048199,
      "usd_24h_vol": 33776641957.26242,
      "usd_market_cap": 2343795976558.965
    },
    "onChain": {
      "mvrv": 1.8,
      "nupl": 0.65,
      "sopr": 1.02,
      "activeAddresses": 950000,
      "exchangeInflow": 15000,
      "exchangeOutflow": 12000,
      "transactionVolume": 25000000000,
      "supplyDistribution": {
        "whaleHoldings": {
          "percentage": 42.3,
          "addressCount": 850
        },
        "retailHoldings": {
          "percentage": 38.7,
          "addressCount": 42000000
        },
        "exchangeHoldings": {
          "percentage": 12.5,
          "addressCount": 150
        },
        "otherHoldings": {
          "percentage": 6.5,
          "addressCount": 120000
        }
      },
      "whaleHoldingsPercentage": 42.3,
      "retailHoldingsPercentage": 38.7,
      "exchangeHoldingsPercentage": 12.5
    },
    "technical": {
      "rsi": 58.5,
      "ma50": 112000,
      "ma200": 108000,
      "macd": 145.5,
      "macdSignal": null,
      "bollingerUpper": 122000,
      "bollingerLower": 111000,
      "bollingerMiddle": 116627
    },
    "derivatives": {
      "openInterest": 18500000000,
      "fundingRate": 0.0125,
      "liquidationVolume": 45000000,
      "putCallRatio": 0.85
    },
    "sentiment": {
      "fearGreedIndex": 50,
      "fearGreedClassification": "Neutral",
      "social": {
        "twitterSentiment": 0.5,
        "redditSentiment": 0.5,
        "socialVolume": 45000,
        "engagementRate": 0.085,
        "influencerSentiment": 0.75,
        "trendingScore": 75
      },
      "news": {
        "newsSentiment": 0.5,
        "newsVolume": 1250,
        "positiveNewsCount": 780,
        "negativeNewsCount": 320,
        "neutralNewsCount": 150,
        "sentimentScore": 0.5,
        "buzzScore": 75
      },
      "googleTrends": {
        "trendsScore": 75,
        "searchVolume": 850000,
        "trendingKeywords": [
          "bitcoin price",
          "btc news",
          "bitcoin mining"
        ],
        "regionalInterest": {
          "US": 85,
          "CN": 72,
          "EU": 68,
          "JP": 45,
          "KR": 52
        },
        "relatedQueries": [
          {
            "query": "bitcoin price today",
            "score": 95,
            "rising": true
          },
          {
            "query": "bitcoin prediction",
            "score": 78,
            "rising": true
          },
          {
            "query": "bitcoin mining",
            "score": 65,
            "rising": false
          }
        ],
        "trendDirection": "stable"
      }
    },
    "analysis": {
      "signal": "GIỮ",
      "confidence": 60,
      "reasoning": "Z.AI: Phân tích dựa trên dữ liệu thị trường hiện tại.... | ChatGPT: Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên q...",
      "riskLevel": "MEDIUM",
      "aiModel": "Z.AI+ChatGPT"
    },
    "timestamp": "2025-08-11T03:52:30.308Z",
    "dataSource": "database"
  },
  "tradingSignal": {
    "signal": "HOLD",
    "confidence": 50,
    "reasoning": "Tín hiệu trung lập: Không đủ điều kiện để MUA hoặc BÁN. Cần theo dõi thêm.",
    "riskLevel": "MEDIUM",
    "conditions": {
      "mvrv": 1.8,
      "fearGreed": 50,
      "fundingRate": 0.0125,
      "sopr": 1.02,
      "rsi": 58.5,
      "nupl": 0.65,
      "volumeTrend": "increasing",
      "extremeDetected": false
    },
    "triggers": []
  },
  "alerts": [],
  "coinId": "bitcoin"
}
🤖 Starting AI analysis for bitcoin...
prisma:query SELECT 1
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE (`main`.`analysis_history`.`coinId` = ? AND `main`.`analysis_history`.`analysisType` = ?) ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
🤖 Using cached AI analysis for bitcoin
💾 [1754884350808-rkaarelzp] Using cached analysis for bitcoin (age: 2382539ms)
✅ [1754884350808-rkaarelzp] Completed AI_ENHANCED_ANALYSIS successfully (6ms)
🎯 [1754884350808-rkaarelzp] Final result: {
  "recommendation": "GIỮ",
  "timeframe": "Ngắn hạn",
  "riskFactors": [
    "Thị trường biến động thông thường"
  ],
  "entryPoints": "Chờ tín hiệu rõ ràng hơn trước khi vào lệnh",
  "exitPoints": "Chốt lời khi có biến động giá mạnh hoặc đạt mục tiêu lợi nhuận",
  "stopLoss": "Quản lý rủi ro chặt chẽ, stop loss tại mức biến động chấp nhận được",
  "takeProfit": "Take profit khi đạt lợi nhuận mục tiêu hoặc có thay đổi xu hướng",
  "zaiAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn",
    "breakoutPotential": "LOW",
    "reasoning": "Phân tích dựa trên dữ liệu thị trường hiện tại."
  },
  "chatGPTAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn đến trung hạn (1-4 tuần)",
    "breakoutPotential": "LOW",
    "reasoning": "Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên quan sát và chờ đợi tín hiệu tốt hơn."
  }
}
 POST /api/ai-analysis?action=analyze&coinId=bitcoin 200 in 67ms
 GET / 200 in 85ms
 GET /favicon.ico 200 in 54ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT 1
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`isActive` = ? ORDER BY `main`.`cryptocurrencies`.`isDefault` DESC, `main`.`cryptocurrencies`.`rank` ASC, `main`.`cryptocurrencies`.`createdAt` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`coin_data_collection`.`id`, `main`.`coin_data_collection`.`cryptoId`, `main`.`coin_data_collection`.`status`, `main`.`coin_data_collection`.`lastCollected`, `main`.`coin_data_collection`.`nextCollection`, `main`.`coin_data_collection`.`errorCount`, `main`.`coin_data_collection`.`lastError`, `main`.`coin_data_collection`.`metadata` FROM `main`.`coin_data_collection` WHERE `main`.`coin_data_collection`.`cryptoId` IN (?,?,?,?,?) LIMIT ? OFFSET ?
 GET /api/cryptocurrencies?activeOnly=true 200 in 70ms
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE `main`.`analysis_history`.`cryptoId` = ? ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/dashboard?coinId=bitcoin 200 in 89ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/trading-signals-fast?action=signal&coinId=bitcoin 200 in 72ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/alerts-fast?action=process-data&coinId=bitcoin 200 in 78ms
🤖 [1754884359391-1kgo45ar1] Starting AI analysis operation: AI_ENHANCED_ANALYSIS for bitcoin
📊 [1754884359391-1kgo45ar1] Request data: {
  "marketData": {
    "price": {
      "usd": 117775,
      "usd_24h_change": 0.8618738474048199,
      "usd_24h_vol": 33776641957.26242,
      "usd_market_cap": 2343795976558.965
    },
    "onChain": {
      "mvrv": 1.8,
      "nupl": 0.65,
      "sopr": 1.02,
      "activeAddresses": 950000,
      "exchangeInflow": 15000,
      "exchangeOutflow": 12000,
      "transactionVolume": 25000000000,
      "supplyDistribution": {
        "whaleHoldings": {
          "percentage": 42.3,
          "addressCount": 850
        },
        "retailHoldings": {
          "percentage": 38.7,
          "addressCount": 42000000
        },
        "exchangeHoldings": {
          "percentage": 12.5,
          "addressCount": 150
        },
        "otherHoldings": {
          "percentage": 6.5,
          "addressCount": 120000
        }
      },
      "whaleHoldingsPercentage": 42.3,
      "retailHoldingsPercentage": 38.7,
      "exchangeHoldingsPercentage": 12.5
    },
    "technical": {
      "rsi": 58.5,
      "ma50": 112000,
      "ma200": 108000,
      "macd": 145.5,
      "macdSignal": null,
      "bollingerUpper": 122000,
      "bollingerLower": 111000,
      "bollingerMiddle": 116627
    },
    "derivatives": {
      "openInterest": 18500000000,
      "fundingRate": 0.0125,
      "liquidationVolume": 45000000,
      "putCallRatio": 0.85
    },
    "sentiment": {
      "fearGreedIndex": 50,
      "fearGreedClassification": "Neutral",
      "social": {
        "twitterSentiment": 0.5,
        "redditSentiment": 0.5,
        "socialVolume": 45000,
        "engagementRate": 0.085,
        "influencerSentiment": 0.75,
        "trendingScore": 75
      },
      "news": {
        "newsSentiment": 0.5,
        "newsVolume": 1250,
        "positiveNewsCount": 780,
        "negativeNewsCount": 320,
        "neutralNewsCount": 150,
        "sentimentScore": 0.5,
        "buzzScore": 75
      },
      "googleTrends": {
        "trendsScore": 75,
        "searchVolume": 850000,
        "trendingKeywords": [
          "bitcoin price",
          "btc news",
          "bitcoin mining"
        ],
        "regionalInterest": {
          "US": 85,
          "CN": 72,
          "EU": 68,
          "JP": 45,
          "KR": 52
        },
        "relatedQueries": [
          {
            "query": "bitcoin price today",
            "score": 95,
            "rising": true
          },
          {
            "query": "bitcoin prediction",
            "score": 78,
            "rising": true
          },
          {
            "query": "bitcoin mining",
            "score": 65,
            "rising": false
          }
        ],
        "trendDirection": "stable"
      }
    },
    "analysis": {
      "signal": "GIỮ",
      "confidence": 60,
      "reasoning": "Z.AI: Phân tích dựa trên dữ liệu thị trường hiện tại.... | ChatGPT: Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên q...",
      "riskLevel": "MEDIUM",
      "aiModel": "Z.AI+ChatGPT"
    },
    "timestamp": "2025-08-11T03:52:37.891Z",
    "dataSource": "database"
  },
  "tradingSignal": {
    "signal": "HOLD",
    "confidence": 50,
    "reasoning": "Tín hiệu trung lập: Không đủ điều kiện để MUA hoặc BÁN. Cần theo dõi thêm.",
    "riskLevel": "MEDIUM",
    "conditions": {
      "mvrv": 1.8,
      "fearGreed": 50,
      "fundingRate": 0.0125,
      "sopr": 1.02,
      "rsi": 58.5,
      "nupl": 0.65,
      "volumeTrend": "increasing",
      "extremeDetected": false
    },
    "triggers": []
  },
  "alerts": [],
  "coinId": "bitcoin"
}
🤖 Starting AI analysis for bitcoin...
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE (`main`.`analysis_history`.`coinId` = ? AND `main`.`analysis_history`.`analysisType` = ?) ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
🤖 Using cached AI analysis for bitcoin
💾 [1754884359391-1kgo45ar1] Using cached analysis for bitcoin (age: 2391122ms)
✅ [1754884359391-1kgo45ar1] Completed AI_ENHANCED_ANALYSIS successfully (6ms)
🎯 [1754884359391-1kgo45ar1] Final result: {
  "recommendation": "GIỮ",
  "timeframe": "Ngắn hạn",
  "riskFactors": [
    "Thị trường biến động thông thường"
  ],
  "entryPoints": "Chờ tín hiệu rõ ràng hơn trước khi vào lệnh",
  "exitPoints": "Chốt lời khi có biến động giá mạnh hoặc đạt mục tiêu lợi nhuận",
  "stopLoss": "Quản lý rủi ro chặt chẽ, stop loss tại mức biến động chấp nhận được",
  "takeProfit": "Take profit khi đạt lợi nhuận mục tiêu hoặc có thay đổi xu hướng",
  "zaiAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn",
    "breakoutPotential": "LOW",
    "reasoning": "Phân tích dựa trên dữ liệu thị trường hiện tại."
  },
  "chatGPTAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn đến trung hạn (1-4 tuần)",
    "breakoutPotential": "LOW",
    "reasoning": "Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên quan sát và chờ đợi tín hiệu tốt hơn."
  }
}
 POST /api/ai-analysis?action=analyze&coinId=bitcoin 200 in 50ms
 GET / 200 in 67ms
 GET /favicon.ico 200 in 45ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE `main`.`analysis_history`.`cryptoId` = ? ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/dashboard?coinId=bitcoin 200 in 81ms
prisma:query SELECT 1
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/trading-signals-fast?action=signal&coinId=bitcoin 200 in 83ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/alerts-fast?action=process-data&coinId=bitcoin 200 in 64ms
🤖 [1754884373183-abii4bkon] Starting AI analysis operation: AI_ENHANCED_ANALYSIS for bitcoin
📊 [1754884373183-abii4bkon] Request data: {
  "marketData": {
    "price": {
      "usd": 117775,
      "usd_24h_change": 0.8618738474048199,
      "usd_24h_vol": 33776641957.26242,
      "usd_market_cap": 2343795976558.965
    },
    "onChain": {
      "mvrv": 1.8,
      "nupl": 0.65,
      "sopr": 1.02,
      "activeAddresses": 950000,
      "exchangeInflow": 15000,
      "exchangeOutflow": 12000,
      "transactionVolume": 25000000000,
      "supplyDistribution": {
        "whaleHoldings": {
          "percentage": 42.3,
          "addressCount": 850
        },
        "retailHoldings": {
          "percentage": 38.7,
          "addressCount": 42000000
        },
        "exchangeHoldings": {
          "percentage": 12.5,
          "addressCount": 150
        },
        "otherHoldings": {
          "percentage": 6.5,
          "addressCount": 120000
        }
      },
      "whaleHoldingsPercentage": 42.3,
      "retailHoldingsPercentage": 38.7,
      "exchangeHoldingsPercentage": 12.5
    },
    "technical": {
      "rsi": 58.5,
      "ma50": 112000,
      "ma200": 108000,
      "macd": 145.5,
      "macdSignal": null,
      "bollingerUpper": 122000,
      "bollingerLower": 111000,
      "bollingerMiddle": 116627
    },
    "derivatives": {
      "openInterest": 18500000000,
      "fundingRate": 0.0125,
      "liquidationVolume": 45000000,
      "putCallRatio": 0.85
    },
    "sentiment": {
      "fearGreedIndex": 50,
      "fearGreedClassification": "Neutral",
      "social": {
        "twitterSentiment": 0.5,
        "redditSentiment": 0.5,
        "socialVolume": 45000,
        "engagementRate": 0.085,
        "influencerSentiment": 0.75,
        "trendingScore": 75
      },
      "news": {
        "newsSentiment": 0.5,
        "newsVolume": 1250,
        "positiveNewsCount": 780,
        "negativeNewsCount": 320,
        "neutralNewsCount": 150,
        "sentimentScore": 0.5,
        "buzzScore": 75
      },
      "googleTrends": {
        "trendsScore": 75,
        "searchVolume": 850000,
        "trendingKeywords": [
          "bitcoin price",
          "btc news",
          "bitcoin mining"
        ],
        "regionalInterest": {
          "US": 85,
          "CN": 72,
          "EU": 68,
          "JP": 45,
          "KR": 52
        },
        "relatedQueries": [
          {
            "query": "bitcoin price today",
            "score": 95,
            "rising": true
          },
          {
            "query": "bitcoin prediction",
            "score": 78,
            "rising": true
          },
          {
            "query": "bitcoin mining",
            "score": 65,
            "rising": false
          }
        ],
        "trendDirection": "stable"
      }
    },
    "analysis": {
      "signal": "GIỮ",
      "confidence": 60,
      "reasoning": "Z.AI: Phân tích dựa trên dữ liệu thị trường hiện tại.... | ChatGPT: Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên q...",
      "riskLevel": "MEDIUM",
      "aiModel": "Z.AI+ChatGPT"
    },
    "timestamp": "2025-08-11T03:52:52.790Z",
    "dataSource": "database"
  },
  "tradingSignal": {
    "signal": "HOLD",
    "confidence": 50,
    "reasoning": "Tín hiệu trung lập: Không đủ điều kiện để MUA hoặc BÁN. Cần theo dõi thêm.",
    "riskLevel": "MEDIUM",
    "conditions": {
      "mvrv": 1.8,
      "fearGreed": 50,
      "fundingRate": 0.0125,
      "sopr": 1.02,
      "rsi": 58.5,
      "nupl": 0.65,
      "volumeTrend": "increasing",
      "extremeDetected": false
    },
    "triggers": []
  },
  "alerts": [],
  "coinId": "bitcoin"
}
🤖 Starting AI analysis for bitcoin...
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE (`main`.`analysis_history`.`coinId` = ? AND `main`.`analysis_history`.`analysisType` = ?) ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
🤖 Using cached AI analysis for bitcoin
💾 [1754884373183-abii4bkon] Using cached analysis for bitcoin (age: 2404913ms)
✅ [1754884373183-abii4bkon] Completed AI_ENHANCED_ANALYSIS successfully (5ms)
🎯 [1754884373183-abii4bkon] Final result: {
  "recommendation": "GIỮ",
  "timeframe": "Ngắn hạn",
  "riskFactors": [
    "Thị trường biến động thông thường"
  ],
  "entryPoints": "Chờ tín hiệu rõ ràng hơn trước khi vào lệnh",
  "exitPoints": "Chốt lời khi có biến động giá mạnh hoặc đạt mục tiêu lợi nhuận",
  "stopLoss": "Quản lý rủi ro chặt chẽ, stop loss tại mức biến động chấp nhận được",
  "takeProfit": "Take profit khi đạt lợi nhuận mục tiêu hoặc có thay đổi xu hướng",
  "zaiAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn",
    "breakoutPotential": "LOW",
    "reasoning": "Phân tích dựa trên dữ liệu thị trường hiện tại."
  },
  "chatGPTAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn đến trung hạn (1-4 tuần)",
    "breakoutPotential": "LOW",
    "reasoning": "Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên quan sát và chờ đợi tín hiệu tốt hơn."
  }
}
 POST /api/ai-analysis?action=analyze&coinId=bitcoin 200 in 44ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`isActive` = ? ORDER BY `main`.`cryptocurrencies`.`isDefault` DESC, `main`.`cryptocurrencies`.`rank` ASC, `main`.`cryptocurrencies`.`createdAt` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`coin_data_collection`.`id`, `main`.`coin_data_collection`.`cryptoId`, `main`.`coin_data_collection`.`status`, `main`.`coin_data_collection`.`lastCollected`, `main`.`coin_data_collection`.`nextCollection`, `main`.`coin_data_collection`.`errorCount`, `main`.`coin_data_collection`.`lastError`, `main`.`coin_data_collection`.`metadata` FROM `main`.`coin_data_collection` WHERE `main`.`coin_data_collection`.`cryptoId` IN (?,?,?,?,?) LIMIT ? OFFSET ?
 GET /api/cryptocurrencies?activeOnly=true 200 in 58ms
 GET / 200 in 95ms
 GET /favicon.ico 200 in 44ms
prisma:query SELECT 1
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE `main`.`analysis_history`.`cryptoId` = ? ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/dashboard?coinId=bitcoin 200 in 99ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/trading-signals-fast?action=signal&coinId=bitcoin 200 in 78ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/alerts-fast?action=process-data&coinId=bitcoin 200 in 75ms
🤖 [1754884392493-gayu0mxbb] Starting AI analysis operation: AI_ENHANCED_ANALYSIS for bitcoin
📊 [1754884392493-gayu0mxbb] Request data: {
  "marketData": {
    "price": {
      "usd": 117775,
      "usd_24h_change": 0.8618738474048199,
      "usd_24h_vol": 33776641957.26242,
      "usd_market_cap": 2343795976558.965
    },
    "onChain": {
      "mvrv": 1.8,
      "nupl": 0.65,
      "sopr": 1.02,
      "activeAddresses": 950000,
      "exchangeInflow": 15000,
      "exchangeOutflow": 12000,
      "transactionVolume": 25000000000,
      "supplyDistribution": {
        "whaleHoldings": {
          "percentage": 42.3,
          "addressCount": 850
        },
        "retailHoldings": {
          "percentage": 38.7,
          "addressCount": 42000000
        },
        "exchangeHoldings": {
          "percentage": 12.5,
          "addressCount": 150
        },
        "otherHoldings": {
          "percentage": 6.5,
          "addressCount": 120000
        }
      },
      "whaleHoldingsPercentage": 42.3,
      "retailHoldingsPercentage": 38.7,
      "exchangeHoldingsPercentage": 12.5
    },
    "technical": {
      "rsi": 58.5,
      "ma50": 112000,
      "ma200": 108000,
      "macd": 145.5,
      "macdSignal": null,
      "bollingerUpper": 122000,
      "bollingerLower": 111000,
      "bollingerMiddle": 116627
    },
    "derivatives": {
      "openInterest": 18500000000,
      "fundingRate": 0.0125,
      "liquidationVolume": 45000000,
      "putCallRatio": 0.85
    },
    "sentiment": {
      "fearGreedIndex": 50,
      "fearGreedClassification": "Neutral",
      "social": {
        "twitterSentiment": 0.5,
        "redditSentiment": 0.5,
        "socialVolume": 45000,
        "engagementRate": 0.085,
        "influencerSentiment": 0.75,
        "trendingScore": 75
      },
      "news": {
        "newsSentiment": 0.5,
        "newsVolume": 1250,
        "positiveNewsCount": 780,
        "negativeNewsCount": 320,
        "neutralNewsCount": 150,
        "sentimentScore": 0.5,
        "buzzScore": 75
      },
      "googleTrends": {
        "trendsScore": 75,
        "searchVolume": 850000,
        "trendingKeywords": [
          "bitcoin price",
          "btc news",
          "bitcoin mining"
        ],
        "regionalInterest": {
          "US": 85,
          "CN": 72,
          "EU": 68,
          "JP": 45,
          "KR": 52
        },
        "relatedQueries": [
          {
            "query": "bitcoin price today",
            "score": 95,
            "rising": true
          },
          {
            "query": "bitcoin prediction",
            "score": 78,
            "rising": true
          },
          {
            "query": "bitcoin mining",
            "score": 65,
            "rising": false
          }
        ],
        "trendDirection": "stable"
      }
    },
    "analysis": {
      "signal": "GIỮ",
      "confidence": 60,
      "reasoning": "Z.AI: Phân tích dựa trên dữ liệu thị trường hiện tại.... | ChatGPT: Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên q...",
      "riskLevel": "MEDIUM",
      "aiModel": "Z.AI+ChatGPT"
    },
    "timestamp": "2025-08-11T03:53:12.086Z",
    "dataSource": "database"
  },
  "tradingSignal": {
    "signal": "HOLD",
    "confidence": 50,
    "reasoning": "Tín hiệu trung lập: Không đủ điều kiện để MUA hoặc BÁN. Cần theo dõi thêm.",
    "riskLevel": "MEDIUM",
    "conditions": {
      "mvrv": 1.8,
      "fearGreed": 50,
      "fundingRate": 0.0125,
      "sopr": 1.02,
      "rsi": 58.5,
      "nupl": 0.65,
      "volumeTrend": "increasing",
      "extremeDetected": false
    },
    "triggers": []
  },
  "alerts": [],
  "coinId": "bitcoin"
}
🤖 Starting AI analysis for bitcoin...
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE (`main`.`analysis_history`.`coinId` = ? AND `main`.`analysis_history`.`analysisType` = ?) ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
🤖 Using cached AI analysis for bitcoin
💾 [1754884392493-gayu0mxbb] Using cached analysis for bitcoin (age: 2424223ms)
✅ [1754884392493-gayu0mxbb] Completed AI_ENHANCED_ANALYSIS successfully (5ms)
🎯 [1754884392493-gayu0mxbb] Final result: {
  "recommendation": "GIỮ",
  "timeframe": "Ngắn hạn",
  "riskFactors": [
    "Thị trường biến động thông thường"
  ],
  "entryPoints": "Chờ tín hiệu rõ ràng hơn trước khi vào lệnh",
  "exitPoints": "Chốt lời khi có biến động giá mạnh hoặc đạt mục tiêu lợi nhuận",
  "stopLoss": "Quản lý rủi ro chặt chẽ, stop loss tại mức biến động chấp nhận được",
  "takeProfit": "Take profit khi đạt lợi nhuận mục tiêu hoặc có thay đổi xu hướng",
  "zaiAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn",
    "breakoutPotential": "LOW",
    "reasoning": "Phân tích dựa trên dữ liệu thị trường hiện tại."
  },
  "chatGPTAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn đến trung hạn (1-4 tuần)",
    "breakoutPotential": "LOW",
    "reasoning": "Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên quan sát và chờ đợi tín hiệu tốt hơn."
  }
}
 POST /api/ai-analysis?action=analyze&coinId=bitcoin 200 in 49ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`isActive` = ? ORDER BY `main`.`cryptocurrencies`.`isDefault` DESC, `main`.`cryptocurrencies`.`rank` ASC, `main`.`cryptocurrencies`.`createdAt` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`coin_data_collection`.`id`, `main`.`coin_data_collection`.`cryptoId`, `main`.`coin_data_collection`.`status`, `main`.`coin_data_collection`.`lastCollected`, `main`.`coin_data_collection`.`nextCollection`, `main`.`coin_data_collection`.`errorCount`, `main`.`coin_data_collection`.`lastError`, `main`.`coin_data_collection`.`metadata` FROM `main`.`coin_data_collection` WHERE `main`.`coin_data_collection`.`cryptoId` IN (?,?,?,?,?) LIMIT ? OFFSET ?
 GET /api/cryptocurrencies?activeOnly=true 200 in 48ms
 GET / 200 in 170ms
 GET / 200 in 63ms
 GET /favicon.ico 200 in 72ms
 GET /api/cryptocurrencies?activeOnly=true 200 in 41ms
prisma:query SELECT 1
prisma:query SELECT 1
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`isActive` = ? ORDER BY `main`.`cryptocurrencies`.`isDefault` DESC, `main`.`cryptocurrencies`.`rank` ASC, `main`.`cryptocurrencies`.`createdAt` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`coin_data_collection`.`id`, `main`.`coin_data_collection`.`cryptoId`, `main`.`coin_data_collection`.`status`, `main`.`coin_data_collection`.`lastCollected`, `main`.`coin_data_collection`.`nextCollection`, `main`.`coin_data_collection`.`errorCount`, `main`.`coin_data_collection`.`lastError`, `main`.`coin_data_collection`.`metadata` FROM `main`.`coin_data_collection` WHERE `main`.`coin_data_collection`.`cryptoId` IN (?,?,?,?,?) LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE `main`.`analysis_history`.`cryptoId` = ? ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
 GET / 200 in 66ms
 GET /favicon.ico 200 in 39ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`isActive` = ? ORDER BY `main`.`cryptocurrencies`.`isDefault` DESC, `main`.`cryptocurrencies`.`rank` ASC, `main`.`cryptocurrencies`.`createdAt` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`coin_data_collection`.`id`, `main`.`coin_data_collection`.`cryptoId`, `main`.`coin_data_collection`.`status`, `main`.`coin_data_collection`.`lastCollected`, `main`.`coin_data_collection`.`nextCollection`, `main`.`coin_data_collection`.`errorCount`, `main`.`coin_data_collection`.`lastError`, `main`.`coin_data_collection`.`metadata` FROM `main`.`coin_data_collection` WHERE `main`.`coin_data_collection`.`cryptoId` IN (?,?,?,?,?) LIMIT ? OFFSET ?
 GET /api/cryptocurrencies?activeOnly=true 200 in 74ms
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE `main`.`analysis_history`.`cryptoId` = ? ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/dashboard?coinId=bitcoin 200 in 101ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/trading-signals-fast?action=signal&coinId=bitcoin 200 in 141ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/alerts-fast?action=process-data&coinId=bitcoin 200 in 61ms
🤖 [1754885465908-wbqvtzwyq] Starting AI analysis operation: AI_ENHANCED_ANALYSIS for bitcoin
📊 [1754885465908-wbqvtzwyq] Request data: {
  "marketData": {
    "price": {
      "usd": 117775,
      "usd_24h_change": 0.8618738474048199,
      "usd_24h_vol": 33776641957.26242,
      "usd_market_cap": 2343795976558.965
    },
    "onChain": {
      "mvrv": 1.8,
      "nupl": 0.65,
      "sopr": 1.02,
      "activeAddresses": 950000,
      "exchangeInflow": 15000,
      "exchangeOutflow": 12000,
      "transactionVolume": 25000000000,
      "supplyDistribution": {
        "whaleHoldings": {
          "percentage": 42.3,
          "addressCount": 850
        },
        "retailHoldings": {
          "percentage": 38.7,
          "addressCount": 42000000
        },
        "exchangeHoldings": {
          "percentage": 12.5,
          "addressCount": 150
        },
        "otherHoldings": {
          "percentage": 6.5,
          "addressCount": 120000
        }
      },
      "whaleHoldingsPercentage": 42.3,
      "retailHoldingsPercentage": 38.7,
      "exchangeHoldingsPercentage": 12.5
    },
    "technical": {
      "rsi": 58.5,
      "ma50": 112000,
      "ma200": 108000,
      "macd": 145.5,
      "macdSignal": null,
      "bollingerUpper": 122000,
      "bollingerLower": 111000,
      "bollingerMiddle": 116627
    },
    "derivatives": {
      "openInterest": 18500000000,
      "fundingRate": 0.0125,
      "liquidationVolume": 45000000,
      "putCallRatio": 0.85
    },
    "sentiment": {
      "fearGreedIndex": 50,
      "fearGreedClassification": "Neutral",
      "social": {
        "twitterSentiment": 0.5,
        "redditSentiment": 0.5,
        "socialVolume": 45000,
        "engagementRate": 0.085,
        "influencerSentiment": 0.75,
        "trendingScore": 75
      },
      "news": {
        "newsSentiment": 0.5,
        "newsVolume": 1250,
        "positiveNewsCount": 780,
        "negativeNewsCount": 320,
        "neutralNewsCount": 150,
        "sentimentScore": 0.5,
        "buzzScore": 75
      },
      "googleTrends": {
        "trendsScore": 75,
        "searchVolume": 850000,
        "trendingKeywords": [
          "bitcoin price",
          "btc news",
          "bitcoin mining"
        ],
        "regionalInterest": {
          "US": 85,
          "CN": 72,
          "EU": 68,
          "JP": 45,
          "KR": 52
        },
        "relatedQueries": [
          {
            "query": "bitcoin price today",
            "score": 95,
            "rising": true
          },
          {
            "query": "bitcoin prediction",
            "score": 78,
            "rising": true
          },
          {
            "query": "bitcoin mining",
            "score": 65,
            "rising": false
          }
        ],
        "trendDirection": "stable"
      }
    },
    "analysis": {
      "signal": "GIỮ",
      "confidence": 60,
      "reasoning": "Z.AI: Phân tích dựa trên dữ liệu thị trường hiện tại.... | ChatGPT: Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên q...",
      "riskLevel": "MEDIUM",
      "aiModel": "Z.AI+ChatGPT"
    },
    "timestamp": "2025-08-11T04:11:04.344Z",
    "dataSource": "database"
  },
  "tradingSignal": {
    "signal": "HOLD",
    "confidence": 50,
    "reasoning": "Tín hiệu trung lập: Không đủ điều kiện để MUA hoặc BÁN. Cần theo dõi thêm.",
    "riskLevel": "MEDIUM",
    "conditions": {
      "mvrv": 1.8,
      "fearGreed": 50,
      "fundingRate": 0.0125,
      "sopr": 1.02,
      "rsi": 58.5,
      "nupl": 0.65,
      "volumeTrend": "increasing",
      "extremeDetected": false
    },
    "triggers": []
  },
  "alerts": [
    {
      "id": "alert_1754885465806_h5w123b8p",
      "type": "WARNING",
      "category": "FUNDING_RATE",
      "title": "High Funding Rate Detected",
      "message": "Funding rate at 1.250% indicates strong long pressure and potential squeeze risk.",
      "severity": "MEDIUM",
      "timestamp": "2025-08-11T04:11:05.806Z",
      "coinId": "bitcoin",
      "data": {
        "fundingRate": 0.0125,
        "threshold": 0.001
      },
      "triggeredBy": [
        "High funding rate"
      ],
      "actionRequired": true,
      "recommendedAction": "Monitor for potential long squeeze or price correction"
    },
    {
      "id": "alert_1754885465806_d8b73tg4d",
      "type": "WARNING",
      "category": "DERIVATIVES",
      "title": "High Open Interest Detected",
      "message": "Open interest at $18.5B is near historical highs - increased volatility risk.",
      "severity": "MEDIUM",
      "timestamp": "2025-08-11T04:11:05.806Z",
      "coinId": "bitcoin",
      "data": {
        "openInterest": 18500000000,
        "historicalHigh": 18500000000,
        "percentage": "100.0"
      },
      "triggeredBy": [
        "High open interest"
      ],
      "actionRequired": true,
      "recommendedAction": "Prepare for increased volatility and potential liquidations"
    }
  ],
  "coinId": "bitcoin"
}
🤖 Starting AI analysis for bitcoin...
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE (`main`.`analysis_history`.`coinId` = ? AND `main`.`analysis_history`.`analysisType` = ?) ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
🤖 Using cached AI analysis for bitcoin
💾 [1754885465908-wbqvtzwyq] Using cached analysis for bitcoin (age: 3497643ms)
✅ [1754885465908-wbqvtzwyq] Completed AI_ENHANCED_ANALYSIS successfully (10ms)
🎯 [1754885465908-wbqvtzwyq] Final result: {
  "recommendation": "GIỮ",
  "timeframe": "Ngắn hạn",
  "riskFactors": [
    "Thị trường biến động thông thường"
  ],
  "entryPoints": "Chờ tín hiệu rõ ràng hơn trước khi vào lệnh",
  "exitPoints": "Chốt lời khi có biến động giá mạnh hoặc đạt mục tiêu lợi nhuận",
  "stopLoss": "Quản lý rủi ro chặt chẽ, stop loss tại mức biến động chấp nhận được",
  "takeProfit": "Take profit khi đạt lợi nhuận mục tiêu hoặc có thay đổi xu hướng",
  "zaiAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn",
    "breakoutPotential": "LOW",
    "reasoning": "Phân tích dựa trên dữ liệu thị trường hiện tại."
  },
  "chatGPTAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn đến trung hạn (1-4 tuần)",
    "breakoutPotential": "LOW",
    "reasoning": "Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên quan sát và chờ đợi tín hiệu tốt hơn."
  }
}
 POST /api/ai-analysis?action=analyze&coinId=bitcoin 200 in 45ms
 GET / 200 in 67ms
 GET /favicon.ico 200 in 49ms
 GET / 200 in 63ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`isActive` = ? ORDER BY `main`.`cryptocurrencies`.`isDefault` DESC, `main`.`cryptocurrencies`.`rank` ASC, `main`.`cryptocurrencies`.`createdAt` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`coin_data_collection`.`id`, `main`.`coin_data_collection`.`cryptoId`, `main`.`coin_data_collection`.`status`, `main`.`coin_data_collection`.`lastCollected`, `main`.`coin_data_collection`.`nextCollection`, `main`.`coin_data_collection`.`errorCount`, `main`.`coin_data_collection`.`lastError`, `main`.`coin_data_collection`.`metadata` FROM `main`.`coin_data_collection` WHERE `main`.`coin_data_collection`.`cryptoId` IN (?,?,?,?,?) LIMIT ? OFFSET ?
 GET /api/cryptocurrencies?activeOnly=true 200 in 85ms
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE `main`.`analysis_history`.`cryptoId` = ? ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/dashboard?coinId=bitcoin 200 in 111ms
 GET /favicon.ico 200 in 92ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/trading-signals-fast?action=signal&coinId=bitcoin 200 in 90ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/alerts-fast?action=process-data&coinId=bitcoin 200 in 90ms
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`isActive` = ? ORDER BY `main`.`cryptocurrencies`.`isDefault` DESC, `main`.`cryptocurrencies`.`rank` ASC, `main`.`cryptocurrencies`.`createdAt` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`coin_data_collection`.`id`, `main`.`coin_data_collection`.`cryptoId`, `main`.`coin_data_collection`.`status`, `main`.`coin_data_collection`.`lastCollected`, `main`.`coin_data_collection`.`nextCollection`, `main`.`coin_data_collection`.`errorCount`, `main`.`coin_data_collection`.`lastError`, `main`.`coin_data_collection`.`metadata` FROM `main`.`coin_data_collection` WHERE `main`.`coin_data_collection`.`cryptoId` IN (?,?,?,?,?) LIMIT ? OFFSET ?
 GET /api/cryptocurrencies?activeOnly=true 200 in 89ms
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE `main`.`analysis_history`.`cryptoId` = ? ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/dashboard?coinId=bitcoin 200 in 98ms
🤖 [1754885475354-wmqcxoyzh] Starting AI analysis operation: AI_ENHANCED_ANALYSIS for bitcoin
📊 [1754885475354-wmqcxoyzh] Request data: {
  "marketData": {
    "price": {
      "usd": 117775,
      "usd_24h_change": 0.8618738474048199,
      "usd_24h_vol": 33776641957.26242,
      "usd_market_cap": 2343795976558.965
    },
    "onChain": {
      "mvrv": 1.8,
      "nupl": 0.65,
      "sopr": 1.02,
      "activeAddresses": 950000,
      "exchangeInflow": 15000,
      "exchangeOutflow": 12000,
      "transactionVolume": 25000000000,
      "supplyDistribution": {
        "whaleHoldings": {
          "percentage": 42.3,
          "addressCount": 850
        },
        "retailHoldings": {
          "percentage": 38.7,
          "addressCount": 42000000
        },
        "exchangeHoldings": {
          "percentage": 12.5,
          "addressCount": 150
        },
        "otherHoldings": {
          "percentage": 6.5,
          "addressCount": 120000
        }
      },
      "whaleHoldingsPercentage": 42.3,
      "retailHoldingsPercentage": 38.7,
      "exchangeHoldingsPercentage": 12.5
    },
    "technical": {
      "rsi": 58.5,
      "ma50": 112000,
      "ma200": 108000,
      "macd": 145.5,
      "macdSignal": null,
      "bollingerUpper": 122000,
      "bollingerLower": 111000,
      "bollingerMiddle": 116627
    },
    "derivatives": {
      "openInterest": 18500000000,
      "fundingRate": 0.0125,
      "liquidationVolume": 45000000,
      "putCallRatio": 0.85
    },
    "sentiment": {
      "fearGreedIndex": 50,
      "fearGreedClassification": "Neutral",
      "social": {
        "twitterSentiment": 0.5,
        "redditSentiment": 0.5,
        "socialVolume": 45000,
        "engagementRate": 0.085,
        "influencerSentiment": 0.75,
        "trendingScore": 75
      },
      "news": {
        "newsSentiment": 0.5,
        "newsVolume": 1250,
        "positiveNewsCount": 780,
        "negativeNewsCount": 320,
        "neutralNewsCount": 150,
        "sentimentScore": 0.5,
        "buzzScore": 75
      },
      "googleTrends": {
        "trendsScore": 75,
        "searchVolume": 850000,
        "trendingKeywords": [
          "bitcoin price",
          "btc news",
          "bitcoin mining"
        ],
        "regionalInterest": {
          "US": 85,
          "CN": 72,
          "EU": 68,
          "JP": 45,
          "KR": 52
        },
        "relatedQueries": [
          {
            "query": "bitcoin price today",
            "score": 95,
            "rising": true
          },
          {
            "query": "bitcoin prediction",
            "score": 78,
            "rising": true
          },
          {
            "query": "bitcoin mining",
            "score": 65,
            "rising": false
          }
        ],
        "trendDirection": "stable"
      }
    },
    "analysis": {
      "signal": "GIỮ",
      "confidence": 60,
      "reasoning": "Z.AI: Phân tích dựa trên dữ liệu thị trường hiện tại.... | ChatGPT: Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên q...",
      "riskLevel": "MEDIUM",
      "aiModel": "Z.AI+ChatGPT"
    },
    "timestamp": "2025-08-11T04:11:14.877Z",
    "dataSource": "database"
  },
  "tradingSignal": {
    "signal": "HOLD",
    "confidence": 50,
    "reasoning": "Tín hiệu trung lập: Không đủ điều kiện để MUA hoặc BÁN. Cần theo dõi thêm.",
    "riskLevel": "MEDIUM",
    "conditions": {
      "mvrv": 1.8,
      "fearGreed": 50,
      "fundingRate": 0.0125,
      "sopr": 1.02,
      "rsi": 58.5,
      "nupl": 0.65,
      "volumeTrend": "increasing",
      "extremeDetected": false
    },
    "triggers": []
  },
  "alerts": [],
  "coinId": "bitcoin"
}
🤖 Starting AI analysis for bitcoin...
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE (`main`.`analysis_history`.`coinId` = ? AND `main`.`analysis_history`.`analysisType` = ?) ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
🤖 Using cached AI analysis for bitcoin
💾 [1754885475354-wmqcxoyzh] Using cached analysis for bitcoin (age: 3507085ms)
✅ [1754885475354-wmqcxoyzh] Completed AI_ENHANCED_ANALYSIS successfully (6ms)
🎯 [1754885475354-wmqcxoyzh] Final result: {
  "recommendation": "GIỮ",
  "timeframe": "Ngắn hạn",
  "riskFactors": [
    "Thị trường biến động thông thường"
  ],
  "entryPoints": "Chờ tín hiệu rõ ràng hơn trước khi vào lệnh",
  "exitPoints": "Chốt lời khi có biến động giá mạnh hoặc đạt mục tiêu lợi nhuận",
  "stopLoss": "Quản lý rủi ro chặt chẽ, stop loss tại mức biến động chấp nhận được",
  "takeProfit": "Take profit khi đạt lợi nhuận mục tiêu hoặc có thay đổi xu hướng",
  "zaiAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn",
    "breakoutPotential": "LOW",
    "reasoning": "Phân tích dựa trên dữ liệu thị trường hiện tại."
  },
  "chatGPTAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn đến trung hạn (1-4 tuần)",
    "breakoutPotential": "LOW",
    "reasoning": "Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên quan sát và chờ đợi tín hiệu tốt hơn."
  }
}
 POST /api/ai-analysis?action=analyze&coinId=bitcoin 200 in 62ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/trading-signals-fast?action=signal&coinId=bitcoin 200 in 90ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/alerts-fast?action=process-data&coinId=bitcoin 200 in 64ms
🤖 [1754885477283-8zr37lekz] Starting AI analysis operation: AI_ENHANCED_ANALYSIS for bitcoin
📊 [1754885477283-8zr37lekz] Request data: {
  "marketData": {
    "price": {
      "usd": 117775,
      "usd_24h_change": 0.8618738474048199,
      "usd_24h_vol": 33776641957.26242,
      "usd_market_cap": 2343795976558.965
    },
    "onChain": {
      "mvrv": 1.8,
      "nupl": 0.65,
      "sopr": 1.02,
      "activeAddresses": 950000,
      "exchangeInflow": 15000,
      "exchangeOutflow": 12000,
      "transactionVolume": 25000000000,
      "supplyDistribution": {
        "whaleHoldings": {
          "percentage": 42.3,
          "addressCount": 850
        },
        "retailHoldings": {
          "percentage": 38.7,
          "addressCount": 42000000
        },
        "exchangeHoldings": {
          "percentage": 12.5,
          "addressCount": 150
        },
        "otherHoldings": {
          "percentage": 6.5,
          "addressCount": 120000
        }
      },
      "whaleHoldingsPercentage": 42.3,
      "retailHoldingsPercentage": 38.7,
      "exchangeHoldingsPercentage": 12.5
    },
    "technical": {
      "rsi": 58.5,
      "ma50": 112000,
      "ma200": 108000,
      "macd": 145.5,
      "macdSignal": null,
      "bollingerUpper": 122000,
      "bollingerLower": 111000,
      "bollingerMiddle": 116627
    },
    "derivatives": {
      "openInterest": 18500000000,
      "fundingRate": 0.0125,
      "liquidationVolume": 45000000,
      "putCallRatio": 0.85
    },
    "sentiment": {
      "fearGreedIndex": 50,
      "fearGreedClassification": "Neutral",
      "social": {
        "twitterSentiment": 0.5,
        "redditSentiment": 0.5,
        "socialVolume": 45000,
        "engagementRate": 0.085,
        "influencerSentiment": 0.75,
        "trendingScore": 75
      },
      "news": {
        "newsSentiment": 0.5,
        "newsVolume": 1250,
        "positiveNewsCount": 780,
        "negativeNewsCount": 320,
        "neutralNewsCount": 150,
        "sentimentScore": 0.5,
        "buzzScore": 75
      },
      "googleTrends": {
        "trendsScore": 75,
        "searchVolume": 850000,
        "trendingKeywords": [
          "bitcoin price",
          "btc news",
          "bitcoin mining"
        ],
        "regionalInterest": {
          "US": 85,
          "CN": 72,
          "EU": 68,
          "JP": 45,
          "KR": 52
        },
        "relatedQueries": [
          {
            "query": "bitcoin price today",
            "score": 95,
            "rising": true
          },
          {
            "query": "bitcoin prediction",
            "score": 78,
            "rising": true
          },
          {
            "query": "bitcoin mining",
            "score": 65,
            "rising": false
          }
        ],
        "trendDirection": "stable"
      }
    },
    "analysis": {
      "signal": "GIỮ",
      "confidence": 60,
      "reasoning": "Z.AI: Phân tích dựa trên dữ liệu thị trường hiện tại.... | ChatGPT: Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên q...",
      "riskLevel": "MEDIUM",
      "aiModel": "Z.AI+ChatGPT"
    },
    "timestamp": "2025-08-11T04:11:15.247Z",
    "dataSource": "database"
  },
  "tradingSignal": {
    "signal": "HOLD",
    "confidence": 50,
    "reasoning": "Tín hiệu trung lập: Không đủ điều kiện để MUA hoặc BÁN. Cần theo dõi thêm.",
    "riskLevel": "MEDIUM",
    "conditions": {
      "mvrv": 1.8,
      "fearGreed": 50,
      "fundingRate": 0.0125,
      "sopr": 1.02,
      "rsi": 58.5,
      "nupl": 0.65,
      "volumeTrend": "increasing",
      "extremeDetected": false
    },
    "triggers": []
  },
  "alerts": [],
  "coinId": "bitcoin"
}
🤖 Starting AI analysis for bitcoin...
prisma:query SELECT 1
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE (`main`.`analysis_history`.`coinId` = ? AND `main`.`analysis_history`.`analysisType` = ?) ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
🤖 Using cached AI analysis for bitcoin
💾 [1754885477283-8zr37lekz] Using cached analysis for bitcoin (age: 3509092ms)
✅ [1754885477283-8zr37lekz] Completed AI_ENHANCED_ANALYSIS successfully (85ms)
🎯 [1754885477283-8zr37lekz] Final result: {
  "recommendation": "GIỮ",
  "timeframe": "Ngắn hạn",
  "riskFactors": [
    "Thị trường biến động thông thường"
  ],
  "entryPoints": "Chờ tín hiệu rõ ràng hơn trước khi vào lệnh",
  "exitPoints": "Chốt lời khi có biến động giá mạnh hoặc đạt mục tiêu lợi nhuận",
  "stopLoss": "Quản lý rủi ro chặt chẽ, stop loss tại mức biến động chấp nhận được",
  "takeProfit": "Take profit khi đạt lợi nhuận mục tiêu hoặc có thay đổi xu hướng",
  "zaiAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn",
    "breakoutPotential": "LOW",
    "reasoning": "Phân tích dựa trên dữ liệu thị trường hiện tại."
  },
  "chatGPTAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn đến trung hạn (1-4 tuần)",
    "breakoutPotential": "LOW",
    "reasoning": "Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên quan sát và chờ đợi tín hiệu tốt hơn."
  }
}
 POST /api/ai-analysis?action=analyze&coinId=bitcoin 200 in 370ms
 GET / 200 in 65ms
 GET /favicon.ico 200 in 49ms
 GET / 200 in 60ms
 GET /favicon.ico 200 in 47ms
prisma:query SELECT 1
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`isActive` = ? ORDER BY `main`.`cryptocurrencies`.`isDefault` DESC, `main`.`cryptocurrencies`.`rank` ASC, `main`.`cryptocurrencies`.`createdAt` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`coin_data_collection`.`id`, `main`.`coin_data_collection`.`cryptoId`, `main`.`coin_data_collection`.`status`, `main`.`coin_data_collection`.`lastCollected`, `main`.`coin_data_collection`.`nextCollection`, `main`.`coin_data_collection`.`errorCount`, `main`.`coin_data_collection`.`lastError`, `main`.`coin_data_collection`.`metadata` FROM `main`.`coin_data_collection` WHERE `main`.`coin_data_collection`.`cryptoId` IN (?,?,?,?,?) LIMIT ? OFFSET ?
 GET /api/cryptocurrencies?activeOnly=true 200 in 92ms
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE `main`.`analysis_history`.`cryptoId` = ? ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/dashboard?coinId=bitcoin 200 in 119ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/trading-signals-fast?action=signal&coinId=bitcoin 200 in 74ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/alerts-fast?action=process-data&coinId=bitcoin 200 in 64ms
🤖 [1754885489213-qejaf1c7y] Starting AI analysis operation: AI_ENHANCED_ANALYSIS for bitcoin
📊 [1754885489213-qejaf1c7y] Request data: {
  "marketData": {
    "price": {
      "usd": 117775,
      "usd_24h_change": 0.8618738474048199,
      "usd_24h_vol": 33776641957.26242,
      "usd_market_cap": 2343795976558.965
    },
    "onChain": {
      "mvrv": 1.8,
      "nupl": 0.65,
      "sopr": 1.02,
      "activeAddresses": 950000,
      "exchangeInflow": 15000,
      "exchangeOutflow": 12000,
      "transactionVolume": 25000000000,
      "supplyDistribution": {
        "whaleHoldings": {
          "percentage": 42.3,
          "addressCount": 850
        },
        "retailHoldings": {
          "percentage": 38.7,
          "addressCount": 42000000
        },
        "exchangeHoldings": {
          "percentage": 12.5,
          "addressCount": 150
        },
        "otherHoldings": {
          "percentage": 6.5,
          "addressCount": 120000
        }
      },
      "whaleHoldingsPercentage": 42.3,
      "retailHoldingsPercentage": 38.7,
      "exchangeHoldingsPercentage": 12.5
    },
    "technical": {
      "rsi": 58.5,
      "ma50": 112000,
      "ma200": 108000,
      "macd": 145.5,
      "macdSignal": null,
      "bollingerUpper": 122000,
      "bollingerLower": 111000,
      "bollingerMiddle": 116627
    },
    "derivatives": {
      "openInterest": 18500000000,
      "fundingRate": 0.0125,
      "liquidationVolume": 45000000,
      "putCallRatio": 0.85
    },
    "sentiment": {
      "fearGreedIndex": 50,
      "fearGreedClassification": "Neutral",
      "social": {
        "twitterSentiment": 0.5,
        "redditSentiment": 0.5,
        "socialVolume": 45000,
        "engagementRate": 0.085,
        "influencerSentiment": 0.75,
        "trendingScore": 75
      },
      "news": {
        "newsSentiment": 0.5,
        "newsVolume": 1250,
        "positiveNewsCount": 780,
        "negativeNewsCount": 320,
        "neutralNewsCount": 150,
        "sentimentScore": 0.5,
        "buzzScore": 75
      },
      "googleTrends": {
        "trendsScore": 75,
        "searchVolume": 850000,
        "trendingKeywords": [
          "bitcoin price",
          "btc news",
          "bitcoin mining"
        ],
        "regionalInterest": {
          "US": 85,
          "CN": 72,
          "EU": 68,
          "JP": 45,
          "KR": 52
        },
        "relatedQueries": [
          {
            "query": "bitcoin price today",
            "score": 95,
            "rising": true
          },
          {
            "query": "bitcoin prediction",
            "score": 78,
            "rising": true
          },
          {
            "query": "bitcoin mining",
            "score": 65,
            "rising": false
          }
        ],
        "trendDirection": "stable"
      }
    },
    "analysis": {
      "signal": "GIỮ",
      "confidence": 60,
      "reasoning": "Z.AI: Phân tích dựa trên dữ liệu thị trường hiện tại.... | ChatGPT: Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên q...",
      "riskLevel": "MEDIUM",
      "aiModel": "Z.AI+ChatGPT"
    },
    "timestamp": "2025-08-11T04:11:28.821Z",
    "dataSource": "database"
  },
  "tradingSignal": {
    "signal": "HOLD",
    "confidence": 50,
    "reasoning": "Tín hiệu trung lập: Không đủ điều kiện để MUA hoặc BÁN. Cần theo dõi thêm.",
    "riskLevel": "MEDIUM",
    "conditions": {
      "mvrv": 1.8,
      "fearGreed": 50,
      "fundingRate": 0.0125,
      "sopr": 1.02,
      "rsi": 58.5,
      "nupl": 0.65,
      "volumeTrend": "increasing",
      "extremeDetected": false
    },
    "triggers": []
  },
  "alerts": [],
  "coinId": "bitcoin"
}
🤖 Starting AI analysis for bitcoin...
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE (`main`.`analysis_history`.`coinId` = ? AND `main`.`analysis_history`.`analysisType` = ?) ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
🤖 Using cached AI analysis for bitcoin
💾 [1754885489213-qejaf1c7y] Using cached analysis for bitcoin (age: 3520946ms)
✅ [1754885489213-qejaf1c7y] Completed AI_ENHANCED_ANALYSIS successfully (9ms)
🎯 [1754885489213-qejaf1c7y] Final result: {
  "recommendation": "GIỮ",
  "timeframe": "Ngắn hạn",
  "riskFactors": [
    "Thị trường biến động thông thường"
  ],
  "entryPoints": "Chờ tín hiệu rõ ràng hơn trước khi vào lệnh",
  "exitPoints": "Chốt lời khi có biến động giá mạnh hoặc đạt mục tiêu lợi nhuận",
  "stopLoss": "Quản lý rủi ro chặt chẽ, stop loss tại mức biến động chấp nhận được",
  "takeProfit": "Take profit khi đạt lợi nhuận mục tiêu hoặc có thay đổi xu hướng",
  "zaiAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn",
    "breakoutPotential": "LOW",
    "reasoning": "Phân tích dựa trên dữ liệu thị trường hiện tại."
  },
  "chatGPTAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn đến trung hạn (1-4 tuần)",
    "breakoutPotential": "LOW",
    "reasoning": "Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên quan sát và chờ đợi tín hiệu tốt hơn."
  }
}
 POST /api/ai-analysis?action=analyze&coinId=bitcoin 200 in 53ms
 GET / 200 in 67ms
 GET /favicon.ico 200 in 510ms
prisma:query SELECT 1
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`isActive` = ? ORDER BY `main`.`cryptocurrencies`.`isDefault` DESC, `main`.`cryptocurrencies`.`rank` ASC, `main`.`cryptocurrencies`.`createdAt` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`coin_data_collection`.`id`, `main`.`coin_data_collection`.`cryptoId`, `main`.`coin_data_collection`.`status`, `main`.`coin_data_collection`.`lastCollected`, `main`.`coin_data_collection`.`nextCollection`, `main`.`coin_data_collection`.`errorCount`, `main`.`coin_data_collection`.`lastError`, `main`.`coin_data_collection`.`metadata` FROM `main`.`coin_data_collection` WHERE `main`.`coin_data_collection`.`cryptoId` IN (?,?,?,?,?) LIMIT ? OFFSET ?
 GET /api/cryptocurrencies?activeOnly=true 200 in 67ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE `main`.`analysis_history`.`cryptoId` = ? ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/dashboard?coinId=bitcoin 200 in 88ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/trading-signals-fast?action=signal&coinId=bitcoin 200 in 98ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/alerts-fast?action=process-data&coinId=bitcoin 200 in 162ms
🤖 [1754885536912-tqzte1y6d] Starting AI analysis operation: AI_ENHANCED_ANALYSIS for bitcoin
📊 [1754885536912-tqzte1y6d] Request data: {
  "marketData": {
    "price": {
      "usd": 117775,
      "usd_24h_change": 0.8618738474048199,
      "usd_24h_vol": 33776641957.26242,
      "usd_market_cap": 2343795976558.965
    },
    "onChain": {
      "mvrv": 1.8,
      "nupl": 0.65,
      "sopr": 1.02,
      "activeAddresses": 950000,
      "exchangeInflow": 15000,
      "exchangeOutflow": 12000,
      "transactionVolume": 25000000000,
      "supplyDistribution": {
        "whaleHoldings": {
          "percentage": 42.3,
          "addressCount": 850
        },
        "retailHoldings": {
          "percentage": 38.7,
          "addressCount": 42000000
        },
        "exchangeHoldings": {
          "percentage": 12.5,
          "addressCount": 150
        },
        "otherHoldings": {
          "percentage": 6.5,
          "addressCount": 120000
        }
      },
      "whaleHoldingsPercentage": 42.3,
      "retailHoldingsPercentage": 38.7,
      "exchangeHoldingsPercentage": 12.5
    },
    "technical": {
      "rsi": 58.5,
      "ma50": 112000,
      "ma200": 108000,
      "macd": 145.5,
      "macdSignal": null,
      "bollingerUpper": 122000,
      "bollingerLower": 111000,
      "bollingerMiddle": 116627
    },
    "derivatives": {
      "openInterest": 18500000000,
      "fundingRate": 0.0125,
      "liquidationVolume": 45000000,
      "putCallRatio": 0.85
    },
    "sentiment": {
      "fearGreedIndex": 50,
      "fearGreedClassification": "Neutral",
      "social": {
        "twitterSentiment": 0.5,
        "redditSentiment": 0.5,
        "socialVolume": 45000,
        "engagementRate": 0.085,
        "influencerSentiment": 0.75,
        "trendingScore": 75
      },
      "news": {
        "newsSentiment": 0.5,
        "newsVolume": 1250,
        "positiveNewsCount": 780,
        "negativeNewsCount": 320,
        "neutralNewsCount": 150,
        "sentimentScore": 0.5,
        "buzzScore": 75
      },
      "googleTrends": {
        "trendsScore": 75,
        "searchVolume": 850000,
        "trendingKeywords": [
          "bitcoin price",
          "btc news",
          "bitcoin mining"
        ],
        "regionalInterest": {
          "US": 85,
          "CN": 72,
          "EU": 68,
          "JP": 45,
          "KR": 52
        },
        "relatedQueries": [
          {
            "query": "bitcoin price today",
            "score": 95,
            "rising": true
          },
          {
            "query": "bitcoin prediction",
            "score": 78,
            "rising": true
          },
          {
            "query": "bitcoin mining",
            "score": 65,
            "rising": false
          }
        ],
        "trendDirection": "stable"
      }
    },
    "analysis": {
      "signal": "GIỮ",
      "confidence": 60,
      "reasoning": "Z.AI: Phân tích dựa trên dữ liệu thị trường hiện tại.... | ChatGPT: Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên q...",
      "riskLevel": "MEDIUM",
      "aiModel": "Z.AI+ChatGPT"
    },
    "timestamp": "2025-08-11T04:12:16.397Z",
    "dataSource": "database"
  },
  "tradingSignal": {
    "signal": "HOLD",
    "confidence": 50,
    "reasoning": "Tín hiệu trung lập: Không đủ điều kiện để MUA hoặc BÁN. Cần theo dõi thêm.",
    "riskLevel": "MEDIUM",
    "conditions": {
      "mvrv": 1.8,
      "fearGreed": 50,
      "fundingRate": 0.0125,
      "sopr": 1.02,
      "rsi": 58.5,
      "nupl": 0.65,
      "volumeTrend": "increasing",
      "extremeDetected": false
    },
    "triggers": []
  },
  "alerts": [],
  "coinId": "bitcoin"
}
🤖 Starting AI analysis for bitcoin...
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE (`main`.`analysis_history`.`coinId` = ? AND `main`.`analysis_history`.`analysisType` = ?) ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
🤖 Using cached AI analysis for bitcoin
💾 [1754885536912-tqzte1y6d] Using cached analysis for bitcoin (age: 3568642ms)
✅ [1754885536912-tqzte1y6d] Completed AI_ENHANCED_ANALYSIS successfully (5ms)
🎯 [1754885536912-tqzte1y6d] Final result: {
  "recommendation": "GIỮ",
  "timeframe": "Ngắn hạn",
  "riskFactors": [
    "Thị trường biến động thông thường"
  ],
  "entryPoints": "Chờ tín hiệu rõ ràng hơn trước khi vào lệnh",
  "exitPoints": "Chốt lời khi có biến động giá mạnh hoặc đạt mục tiêu lợi nhuận",
  "stopLoss": "Quản lý rủi ro chặt chẽ, stop loss tại mức biến động chấp nhận được",
  "takeProfit": "Take profit khi đạt lợi nhuận mục tiêu hoặc có thay đổi xu hướng",
  "zaiAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn",
    "breakoutPotential": "LOW",
    "reasoning": "Phân tích dựa trên dữ liệu thị trường hiện tại."
  },
  "chatGPTAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn đến trung hạn (1-4 tuần)",
    "breakoutPotential": "LOW",
    "reasoning": "Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên quan sát và chờ đợi tín hiệu tốt hơn."
  }
}
 POST /api/ai-analysis?action=analyze&coinId=bitcoin 200 in 52ms
 GET / 200 in 66ms
 GET /favicon.ico 200 in 50ms
prisma:query SELECT 1
prisma:query SELECT 1
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`isActive` = ? ORDER BY `main`.`cryptocurrencies`.`isDefault` DESC, `main`.`cryptocurrencies`.`rank` ASC, `main`.`cryptocurrencies`.`createdAt` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`coin_data_collection`.`id`, `main`.`coin_data_collection`.`cryptoId`, `main`.`coin_data_collection`.`status`, `main`.`coin_data_collection`.`lastCollected`, `main`.`coin_data_collection`.`nextCollection`, `main`.`coin_data_collection`.`errorCount`, `main`.`coin_data_collection`.`lastError`, `main`.`coin_data_collection`.`metadata` FROM `main`.`coin_data_collection` WHERE `main`.`coin_data_collection`.`cryptoId` IN (?,?,?,?,?) LIMIT ? OFFSET ?
 GET /api/cryptocurrencies?activeOnly=true 200 in 75ms
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE `main`.`analysis_history`.`cryptoId` = ? ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/dashboard?coinId=bitcoin 200 in 104ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/trading-signals-fast?action=signal&coinId=bitcoin 200 in 74ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/alerts-fast?action=process-data&coinId=bitcoin 200 in 89ms
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
🤖 [1754886309899-h8f90vzfv] Starting AI analysis operation: AI_ENHANCED_ANALYSIS for bitcoin
📊 [1754886309899-h8f90vzfv] Request data: {
  "marketData": {
    "price": {
      "usd": 117775,
      "usd_24h_change": 0.8618738474048199,
      "usd_24h_vol": 33776641957.26242,
      "usd_market_cap": 2343795976558.965
    },
    "onChain": {
      "mvrv": 1.8,
      "nupl": 0.65,
      "sopr": 1.02,
      "activeAddresses": 950000,
      "exchangeInflow": 15000,
      "exchangeOutflow": 12000,
      "transactionVolume": 25000000000,
      "supplyDistribution": {
        "whaleHoldings": {
          "percentage": 42.3,
          "addressCount": 850
        },
        "retailHoldings": {
          "percentage": 38.7,
          "addressCount": 42000000
        },
        "exchangeHoldings": {
          "percentage": 12.5,
          "addressCount": 150
        },
        "otherHoldings": {
          "percentage": 6.5,
          "addressCount": 120000
        }
      },
      "whaleHoldingsPercentage": 42.3,
      "retailHoldingsPercentage": 38.7,
      "exchangeHoldingsPercentage": 12.5
    },
    "technical": {
      "rsi": 58.5,
      "ma50": 112000,
      "ma200": 108000,
      "macd": 145.5,
      "macdSignal": null,
      "bollingerUpper": 122000,
      "bollingerLower": 111000,
      "bollingerMiddle": 116627
    },
    "derivatives": {
      "openInterest": 18500000000,
      "fundingRate": 0.0125,
      "liquidationVolume": 45000000,
      "putCallRatio": 0.85
    },
    "sentiment": {
      "fearGreedIndex": 50,
      "fearGreedClassification": "Neutral",
      "social": {
        "twitterSentiment": 0.5,
        "redditSentiment": 0.5,
        "socialVolume": 45000,
        "engagementRate": 0.085,
        "influencerSentiment": 0.75,
        "trendingScore": 75
      },
      "news": {
        "newsSentiment": 0.5,
        "newsVolume": 1250,
        "positiveNewsCount": 780,
        "negativeNewsCount": 320,
        "neutralNewsCount": 150,
        "sentimentScore": 0.5,
        "buzzScore": 75
      },
      "googleTrends": {
        "trendsScore": 75,
        "searchVolume": 850000,
        "trendingKeywords": [
          "bitcoin price",
          "btc news",
          "bitcoin mining"
        ],
        "regionalInterest": {
          "US": 85,
          "CN": 72,
          "EU": 68,
          "JP": 45,
          "KR": 52
        },
        "relatedQueries": [
          {
            "query": "bitcoin price today",
            "score": 95,
            "rising": true
          },
          {
            "query": "bitcoin prediction",
            "score": 78,
            "rising": true
          },
          {
            "query": "bitcoin mining",
            "score": 65,
            "rising": false
          }
        ],
        "trendDirection": "stable"
      }
    },
    "analysis": {
      "signal": "GIỮ",
      "confidence": 60,
      "reasoning": "Z.AI: Phân tích dựa trên dữ liệu thị trường hiện tại.... | ChatGPT: Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên q...",
      "riskLevel": "MEDIUM",
      "aiModel": "Z.AI+ChatGPT"
    },
    "timestamp": "2025-08-11T04:25:08.900Z",
    "dataSource": "database"
  },
  "tradingSignal": {
    "signal": "HOLD",
    "confidence": 50,
    "reasoning": "Tín hiệu trung lập: Không đủ điều kiện để MUA hoặc BÁN. Cần theo dõi thêm.",
    "riskLevel": "MEDIUM",
    "conditions": {
      "mvrv": 1.8,
      "fearGreed": 50,
      "fundingRate": 0.0125,
      "sopr": 1.02,
      "rsi": 58.5,
      "nupl": 0.65,
      "volumeTrend": "increasing",
      "extremeDetected": false
    },
    "triggers": []
  },
  "alerts": [],
  "coinId": "bitcoin"
}
🤖 Starting AI analysis for bitcoin...
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE (`main`.`analysis_history`.`coinId` = ? AND `main`.`analysis_history`.`analysisType` = ?) ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
💬 [Z.AI] Sending prompt to Z.AI:
📝 [Z.AI] Prompt content: PHÂN TÍCH THỊ TRƯỜNG BITCOIN
========================================

DỮ LIỆU GIÁ:
- Giá hiện tại: $117,775
- Thay đổi 24h: 0.86%
- Khối lượng 24h: $33.8B
- Vốn hóa thị trường: $2.3T

CHỈ BÁO ON-CHAIN:
- MVRV Ratio: 1.80
- NUPL: 0.65
- SOPR: 1.02
- Địa chỉ hoạt động: 950,000

CHỈ BÁO KỸ THUẬT:
- RSI: 58.50 (Trung lập)
- MA50: $112,000
- MA200: $108,000
- MACD: 145.50

TÂM LÝ THỊ TRƯỜNG:
- Fear & Greed Index: 50 (Neutral)

THỊ TRƯỜNG PHÁI SINH:
- Lãi suất Funding: 1.250%
- Open Interest: $18.5B

TÍN HIỆU GIAO DỊCH:
- Tín hiệu: HOLD
- Độ tin cậy: 50%
- Mức độ rủi ro: MEDIUM

YÊU CẦU PHÂN TÍCH:
==================
Hãy cung cấp phân tích chi tiết và khuyến nghị đầu tư cho Bitcoin dựa trên tất cả dữ liệu trên. Cân nhắc:

1. PHÂN TÍCH KỸ THUẬT:
   - Đánh giá động lượng và xu hướng dựa trên RSI, MACD
   - Phân tích vị trí giá so với đường trung bình động
   - Xem xét biến động và dải Bollinger

2. PHÂN TÍCH ON-CHAIN:
   - Đánh giá định giá dựa trên MVRV và NUPL
   - Phân tích hành vi của holder và mức lợi nhuận/thua lỗ

3. TÂM LÝ THỊ TRƯỜNG:
   - Diễn giải Fear & Greed Index trong bối cảnh giá hiện tại
   - Đánh giá tâm lý thị trường và các điểm cực đoan

4. QUẢN LÝ RỦI RO:
   - Xác định các yếu tố rủi ro chính
   - Đề xuất mức stop-loss và take-profit phù hợp

5. KHUYẾN NGHỊ ĐẦU TƯ:
   - Tín hiệu rõ ràng: MUA MẠNH, MUA, GIỮ, BÁN, BÁN MẠNH
   - Mức độ tin cậy (0-100)
   - Khung thời gian phân tích
   - Tiềm năng breakout (LOW/MEDIUM/HIGH)
   - Lý do chi tiết

Định dạng trả lời JSON:
{
  "recommendation": "MUA|BÁN|GIỮ|MUA MẠNH|BÁN MẠNH",
  "confidence": 0-100,
  "timeframe": "ví dụ: Ngắn hạn (1-2 tuần)",
  "breakoutPotential": "LOW|MEDIUM|HIGH",
  "reasoning": "lý do chi tiết bằng tiếng Việt"
}

Failed to make API request: TypeError: fetch failed
    at async generateEnhancedAIAnalysis (src/app/api/ai-analysis/route.ts:332:27)
    at async performAIAnalysis (src/app/api/ai-analysis/route.ts:176:29)
    at async POST (src/app/api/ai-analysis/route.ts:55:13)
  330 |       
  331 |       try {
> 332 |         const completion = await zai.chat.completions.create({
      |                           ^
  333 |           messages: [
  334 |             {
  335 |               role: 'system', {
  [cause]: [Error: getaddrinfo ENOTFOUND api.z-ai.dev] {
    errno: -3008,
    code: 'ENOTFOUND',
    syscall: 'getaddrinfo',
    hostname: 'api.z-ai.dev'
  }
}
Z.AI analysis failed, using fallback: fetch failed
🤖 [Z.AI] Received response from Z.AI (233ms):
📋 [Z.AI] Response: {
  "error": "fetch failed"
}
🤖 [ChatGPT] Received response from ChatGPT (0ms):
📋 [ChatGPT] Response: {
  "recommendation": "GIỮ",
  "confidence": 60,
  "timeframe": "Ngắn hạn đến trung hạn (1-4 tuần)",
  "breakoutPotential": "LOW",
  "reasoning": "Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên quan sát và chờ đợi tín hiệu tốt hơn."
}
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query INSERT INTO `main`.`analysis_history` (`id`, `cryptoId`, `coinId`, `signal`, `confidence`, `reasoning`, `riskLevel`, `aiModel`, `analysisType`, `analysisData`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `cryptoId` AS `cryptoId`, `coinId` AS `coinId`, `signal` AS `signal`, `confidence` AS `confidence`, `reasoning` AS `reasoning`, `riskLevel` AS `riskLevel`, `aiModel` AS `aiModel`, `analysisType` AS `analysisType`, `analysisData` AS `analysisData`, `metricsData` AS `metricsData`, `timestamp` AS `timestamp`
✅ AI analysis saved to database for bitcoin
💿 [1754886309899-h8f90vzfv] Database save_analysis successful: {
  "cryptoId": "cme59qgll0000pe49v3wnhyfe",
  "coinId": "bitcoin",
  "analysisType": "AI_ENHANCED",
  "analysisData": "{\"recommendation\":\"GIỮ\",\"timeframe\":\"Ngắn hạn\",\"riskFactors\":[\"Thị trường biến động thông thường\"],\"entryPoints\":\"Chờ tín hiệu rõ ràng hơn trước khi vào lệnh\",\"exitPoints\":\"Chốt lời khi có biến động giá mạnh hoặc đạt mục tiêu lợi nhuận\",\"stopLoss\":\"Quản lý rủi ro chặt chẽ, stop loss tại mức biến động chấp nhận được\",\"takeProfit\":\"Take profit khi đạt lợi nhuận mục tiêu hoặc có thay đổi xu hướng\",\"zaiAnalysis\":{\"recommendation\":\"GIỮ\",\"confidence\":60,\"timeframe\":\"Ngắn hạn\",\"breakoutPotential\":\"LOW\",\"reasoning\":\"Phân tích dựa trên dữ liệu thị trường hiện tại.\"},\"chatGPTAnalysis\":{\"recommendation\":\"GIỮ\",\"confidence\":60,\"timeframe\":\"Ngắn hạn đến trung hạn (1-4 tuần)\",\"breakoutPotential\":\"LOW\",\"reasoning\":\"Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên quan sát và chờ đợi tín hiệu tốt hơn.\"}}",
  "signal": "GIỮ",
  "confidence": 60,
  "reasoning": "Z.AI: Phân tích dựa trên dữ liệu thị trường hiện tại.... | ChatGPT: Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên q...",
  "riskLevel": "MEDIUM",
  "aiModel": "Z.AI+ChatGPT"
}
✅ [4:25:10 AM] AI_ENHANCED_ANALYSIS - bitcoin (332ms)
   Metadata: {
  analysisType: 'AI_ENHANCED',
  marketDataPoints: 8,
  alertsCount: 0,
  cacheUsed: false,
  aiModelsUsed: [ 'Z.AI', 'ChatGPT' ]
}
✅ [1754886309899-h8f90vzfv] Completed AI_ENHANCED_ANALYSIS successfully (332ms)
🎯 [1754886309899-h8f90vzfv] Final result: {
  "recommendation": "GIỮ",
  "timeframe": "Ngắn hạn",
  "riskFactors": [
    "Thị trường biến động thông thường"
  ],
  "entryPoints": "Chờ tín hiệu rõ ràng hơn trước khi vào lệnh",
  "exitPoints": "Chốt lời khi có biến động giá mạnh hoặc đạt mục tiêu lợi nhuận",
  "stopLoss": "Quản lý rủi ro chặt chẽ, stop loss tại mức biến động chấp nhận được",
  "takeProfit": "Take profit khi đạt lợi nhuận mục tiêu hoặc có thay đổi xu hướng",
  "zaiAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn",
    "breakoutPotential": "LOW",
    "reasoning": "Phân tích dựa trên dữ liệu thị trường hiện tại."
  },
  "chatGPTAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn đến trung hạn (1-4 tuần)",
    "breakoutPotential": "LOW",
    "reasoning": "Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên quan sát và chờ đợi tín hiệu tốt hơn."
  }
}
 POST /api/ai-analysis?action=analyze&coinId=bitcoin 200 in 373ms
 GET / 200 in 142ms
 GET /favicon.ico 200 in 51ms
prisma:query SELECT 1
prisma:query SELECT 1
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`isActive` = ? ORDER BY `main`.`cryptocurrencies`.`isDefault` DESC, `main`.`cryptocurrencies`.`rank` ASC, `main`.`cryptocurrencies`.`createdAt` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE `main`.`analysis_history`.`cryptoId` = ? ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/dashboard?coinId=bitcoin 200 in 127ms
prisma:query SELECT `main`.`coin_data_collection`.`id`, `main`.`coin_data_collection`.`cryptoId`, `main`.`coin_data_collection`.`status`, `main`.`coin_data_collection`.`lastCollected`, `main`.`coin_data_collection`.`nextCollection`, `main`.`coin_data_collection`.`errorCount`, `main`.`coin_data_collection`.`lastError`, `main`.`coin_data_collection`.`metadata` FROM `main`.`coin_data_collection` WHERE `main`.`coin_data_collection`.`cryptoId` IN (?,?,?,?,?) LIMIT ? OFFSET ?
 GET /api/cryptocurrencies?activeOnly=true 200 in 153ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET / 200 in 63ms
 GET /favicon.ico 200 in 46ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`isActive` = ? ORDER BY `main`.`cryptocurrencies`.`isDefault` DESC, `main`.`cryptocurrencies`.`rank` ASC, `main`.`cryptocurrencies`.`createdAt` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`coin_data_collection`.`id`, `main`.`coin_data_collection`.`cryptoId`, `main`.`coin_data_collection`.`status`, `main`.`coin_data_collection`.`lastCollected`, `main`.`coin_data_collection`.`nextCollection`, `main`.`coin_data_collection`.`errorCount`, `main`.`coin_data_collection`.`lastError`, `main`.`coin_data_collection`.`metadata` FROM `main`.`coin_data_collection` WHERE `main`.`coin_data_collection`.`cryptoId` IN (?,?,?,?,?) LIMIT ? OFFSET ?
 GET /api/cryptocurrencies?activeOnly=true 200 in 865ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE `main`.`analysis_history`.`cryptoId` = ? ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/dashboard?coinId=bitcoin 200 in 901ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/trading-signals-fast?action=signal&coinId=bitcoin 200 in 77ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/alerts-fast?action=process-data&coinId=bitcoin 200 in 61ms
🤖 [1754889403391-qjwd05kw3] Starting AI analysis operation: AI_ENHANCED_ANALYSIS for bitcoin
📊 [1754889403391-qjwd05kw3] Request data: {
  "marketData": {
    "price": {
      "usd": 117775,
      "usd_24h_change": 0.8618738474048199,
      "usd_24h_vol": 33776641957.26242,
      "usd_market_cap": 2343795976558.965
    },
    "onChain": {
      "mvrv": 1.8,
      "nupl": 0.65,
      "sopr": 1.02,
      "activeAddresses": 950000,
      "exchangeInflow": 15000,
      "exchangeOutflow": 12000,
      "transactionVolume": 25000000000,
      "supplyDistribution": {
        "whaleHoldings": {
          "percentage": 42.3,
          "addressCount": 850
        },
        "retailHoldings": {
          "percentage": 38.7,
          "addressCount": 42000000
        },
        "exchangeHoldings": {
          "percentage": 12.5,
          "addressCount": 150
        },
        "otherHoldings": {
          "percentage": 6.5,
          "addressCount": 120000
        }
      },
      "whaleHoldingsPercentage": 42.3,
      "retailHoldingsPercentage": 38.7,
      "exchangeHoldingsPercentage": 12.5
    },
    "technical": {
      "rsi": 58.5,
      "ma50": 112000,
      "ma200": 108000,
      "macd": 145.5,
      "macdSignal": null,
      "bollingerUpper": 122000,
      "bollingerLower": 111000,
      "bollingerMiddle": 116627
    },
    "derivatives": {
      "openInterest": 18500000000,
      "fundingRate": 0.0125,
      "liquidationVolume": 45000000,
      "putCallRatio": 0.85
    },
    "sentiment": {
      "fearGreedIndex": 50,
      "fearGreedClassification": "Neutral",
      "social": {
        "twitterSentiment": 0.5,
        "redditSentiment": 0.5,
        "socialVolume": 45000,
        "engagementRate": 0.085,
        "influencerSentiment": 0.75,
        "trendingScore": 75
      },
      "news": {
        "newsSentiment": 0.5,
        "newsVolume": 1250,
        "positiveNewsCount": 780,
        "negativeNewsCount": 320,
        "neutralNewsCount": 150,
        "sentimentScore": 0.5,
        "buzzScore": 75
      },
      "googleTrends": {
        "trendsScore": 75,
        "searchVolume": 850000,
        "trendingKeywords": [
          "bitcoin price",
          "btc news",
          "bitcoin mining"
        ],
        "regionalInterest": {
          "US": 85,
          "CN": 72,
          "EU": 68,
          "JP": 45,
          "KR": 52
        },
        "relatedQueries": [
          {
            "query": "bitcoin price today",
            "score": 95,
            "rising": true
          },
          {
            "query": "bitcoin prediction",
            "score": 78,
            "rising": true
          },
          {
            "query": "bitcoin mining",
            "score": 65,
            "rising": false
          }
        ],
        "trendDirection": "stable"
      }
    },
    "analysis": {
      "signal": "GIỮ",
      "confidence": 60,
      "reasoning": "Z.AI: Phân tích dựa trên dữ liệu thị trường hiện tại.... | ChatGPT: Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên q...",
      "riskLevel": "MEDIUM",
      "aiModel": "Z.AI+ChatGPT"
    },
    "timestamp": "2025-08-11T05:16:41.895Z",
    "dataSource": "database"
  },
  "tradingSignal": {
    "signal": "HOLD",
    "confidence": 50,
    "reasoning": "Tín hiệu trung lập: Không đủ điều kiện để MUA hoặc BÁN. Cần theo dõi thêm.",
    "riskLevel": "MEDIUM",
    "conditions": {
      "mvrv": 1.8,
      "fearGreed": 50,
      "fundingRate": 0.0125,
      "sopr": 1.02,
      "rsi": 58.5,
      "nupl": 0.65,
      "volumeTrend": "increasing",
      "extremeDetected": false
    },
    "triggers": []
  },
  "alerts": [
    {
      "id": "alert_1754889403277_clj7w5zgs",
      "type": "WARNING",
      "category": "FUNDING_RATE",
      "title": "High Funding Rate Detected",
      "message": "Funding rate at 1.250% indicates strong long pressure and potential squeeze risk.",
      "severity": "MEDIUM",
      "timestamp": "2025-08-11T05:16:43.277Z",
      "coinId": "bitcoin",
      "data": {
        "fundingRate": 0.0125,
        "threshold": 0.001
      },
      "triggeredBy": [
        "High funding rate"
      ],
      "actionRequired": true,
      "recommendedAction": "Monitor for potential long squeeze or price correction"
    },
    {
      "id": "alert_1754889403277_cbdlqehds",
      "type": "WARNING",
      "category": "DERIVATIVES",
      "title": "High Open Interest Detected",
      "message": "Open interest at $18.5B is near historical highs - increased volatility risk.",
      "severity": "MEDIUM",
      "timestamp": "2025-08-11T05:16:43.277Z",
      "coinId": "bitcoin",
      "data": {
        "openInterest": 18500000000,
        "historicalHigh": 18500000000,
        "percentage": "100.0"
      },
      "triggeredBy": [
        "High open interest"
      ],
      "actionRequired": true,
      "recommendedAction": "Prepare for increased volatility and potential liquidations"
    }
  ],
  "coinId": "bitcoin"
}
🤖 Starting AI analysis for bitcoin...
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE (`main`.`analysis_history`.`coinId` = ? AND `main`.`analysis_history`.`analysisType` = ?) ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
🤖 Using cached AI analysis for bitcoin
💾 [1754889403391-qjwd05kw3] Using cached analysis for bitcoin (age: 3093249ms)
✅ [1754889403391-qjwd05kw3] Completed AI_ENHANCED_ANALYSIS successfully (5ms)
🎯 [1754889403391-qjwd05kw3] Final result: {
  "recommendation": "GIỮ",
  "timeframe": "Ngắn hạn",
  "riskFactors": [
    "Thị trường biến động thông thường"
  ],
  "entryPoints": "Chờ tín hiệu rõ ràng hơn trước khi vào lệnh",
  "exitPoints": "Chốt lời khi có biến động giá mạnh hoặc đạt mục tiêu lợi nhuận",
  "stopLoss": "Quản lý rủi ro chặt chẽ, stop loss tại mức biến động chấp nhận được",
  "takeProfit": "Take profit khi đạt lợi nhuận mục tiêu hoặc có thay đổi xu hướng",
  "zaiAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn",
    "breakoutPotential": "LOW",
    "reasoning": "Phân tích dựa trên dữ liệu thị trường hiện tại."
  },
  "chatGPTAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn đến trung hạn (1-4 tuần)",
    "breakoutPotential": "LOW",
    "reasoning": "Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên quan sát và chờ đợi tín hiệu tốt hơn."
  }
}
 POST /api/ai-analysis?action=analyze&coinId=bitcoin 200 in 51ms
prisma:query SELECT 1
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT 1
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`isActive` = ? ORDER BY `main`.`cryptocurrencies`.`isDefault` DESC, `main`.`cryptocurrencies`.`rank` ASC, `main`.`cryptocurrencies`.`createdAt` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`coin_data_collection`.`id`, `main`.`coin_data_collection`.`cryptoId`, `main`.`coin_data_collection`.`status`, `main`.`coin_data_collection`.`lastCollected`, `main`.`coin_data_collection`.`nextCollection`, `main`.`coin_data_collection`.`errorCount`, `main`.`coin_data_collection`.`lastError`, `main`.`coin_data_collection`.`metadata` FROM `main`.`coin_data_collection` WHERE `main`.`coin_data_collection`.`cryptoId` IN (?,?,?,?,?) LIMIT ? OFFSET ?
 GET /api/cryptocurrencies?activeOnly=true 200 in 67ms
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE `main`.`analysis_history`.`cryptoId` = ? ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/dashboard?coinId=ethereum 200 in 122ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/trading-signals-fast?action=signal&coinId=ethereum 200 in 147ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/alerts-fast?action=process-data&coinId=ethereum 200 in 67ms
🤖 [1754890101212-mvorcvuc6] Starting AI analysis operation: AI_ENHANCED_ANALYSIS for ethereum
📊 [1754890101212-mvorcvuc6] Request data: {
  "marketData": {
    "price": {
      "usd": 4185.69,
      "usd_24h_change": 0.4174281873475184,
      "usd_24h_vol": 34135241610.59757,
      "usd_market_cap": 505342204905.5195
    },
    "onChain": {
      "mvrv": 1.2,
      "nupl": 0.45,
      "sopr": 0.98,
      "activeAddresses": 450000,
      "exchangeInflow": 8500,
      "exchangeOutflow": 9200,
      "transactionVolume": 15000000000,
      "supplyDistribution": {
        "whaleHoldings": {
          "percentage": 38.5,
          "addressCount": 1200
        },
        "retailHoldings": {
          "percentage": 45.2,
          "addressCount": 85000000
        },
        "exchangeHoldings": {
          "percentage": 11.8,
          "addressCount": 200
        },
        "otherHoldings": {
          "percentage": 4.5,
          "addressCount": 350000
        }
      },
      "whaleHoldingsPercentage": 38.5,
      "retailHoldingsPercentage": 45.2,
      "exchangeHoldingsPercentage": 11.8
    },
    "technical": {
      "rsi": 62.3,
      "ma50": 3750,
      "ma200": 3550,
      "macd": 85.2,
      "macdSignal": null,
      "bollingerUpper": 4150,
      "bollingerLower": 3640,
      "bollingerMiddle": 3895.84
    },
    "derivatives": {
      "openInterest": 8500000000,
      "fundingRate": 0.0085,
      "liquidationVolume": 28000000,
      "putCallRatio": 0.92
    },
    "sentiment": {
      "fearGreedIndex": 50,
      "fearGreedClassification": "Neutral",
      "social": {
        "twitterSentiment": 0.5,
        "redditSentiment": 0.5,
        "socialVolume": 45000,
        "engagementRate": 0.085,
        "influencerSentiment": 0.75,
        "trendingScore": 75
      },
      "news": {
        "newsSentiment": 0.5,
        "newsVolume": 1250,
        "positiveNewsCount": 780,
        "negativeNewsCount": 320,
        "neutralNewsCount": 150,
        "sentimentScore": 0.5,
        "buzzScore": 75
      },
      "googleTrends": {
        "trendsScore": 75,
        "searchVolume": 850000,
        "trendingKeywords": [
          "bitcoin price",
          "btc news",
          "bitcoin mining"
        ],
        "regionalInterest": {
          "US": 85,
          "CN": 72,
          "EU": 68,
          "JP": 45,
          "KR": 52
        },
        "relatedQueries": [
          {
            "query": "bitcoin price today",
            "score": 95,
            "rising": true
          },
          {
            "query": "bitcoin prediction",
            "score": 78,
            "rising": true
          },
          {
            "query": "bitcoin mining",
            "score": 65,
            "rising": false
          }
        ],
        "trendDirection": "stable"
      }
    },
    "analysis": {
      "signal": "GIỮ",
      "confidence": 60,
      "reasoning": "Z.AI: Phân tích dựa trên dữ liệu thị trường hiện tại.... | ChatGPT: Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên q...",
      "riskLevel": "MEDIUM",
      "aiModel": "Z.AI+ChatGPT"
    },
    "timestamp": "2025-08-11T05:28:20.192Z",
    "dataSource": "database"
  },
  "tradingSignal": {
    "signal": "HOLD",
    "confidence": 100,
    "reasoning": "Tín hiệu GIỮ: MVRV/NUPL ổn định, khối lượng on-chain tăng, không có dấu hiệu cực đoan.",
    "riskLevel": "LOW",
    "conditions": {
      "mvrv": 1.2,
      "fearGreed": 50,
      "fundingRate": 0.0085,
      "sopr": 0.98,
      "rsi": 62.3,
      "nupl": 0.45,
      "volumeTrend": "increasing",
      "extremeDetected": false
    },
    "triggers": [
      "Thị trường ổn định"
    ]
  },
  "alerts": [
    {
      "id": "alert_1754890100556_vabq82adc",
      "type": "WARNING",
      "category": "FUNDING_RATE",
      "title": "High Funding Rate Detected",
      "message": "Funding rate at 0.850% indicates strong long pressure and potential squeeze risk.",
      "severity": "MEDIUM",
      "timestamp": "2025-08-11T05:28:20.556Z",
      "coinId": "ethereum",
      "data": {
        "fundingRate": 0.0085,
        "threshold": 0.001
      },
      "triggeredBy": [
        "High funding rate"
      ],
      "actionRequired": true,
      "recommendedAction": "Monitor for potential long squeeze or price correction"
    }
  ],
  "coinId": "ethereum"
}
🤖 Starting AI analysis for ethereum...
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE (`main`.`analysis_history`.`coinId` = ? AND `main`.`analysis_history`.`analysisType` = ?) ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
💬 [Z.AI] Sending prompt to Z.AI:
📝 [Z.AI] Prompt content: PHÂN TÍCH THỊ TRƯỜNG ETHEREUM
========================================

DỮ LIỆU GIÁ:
- Giá hiện tại: $4,185.69
- Thay đổi 24h: 0.42%
- Khối lượng 24h: $34.1B
- Vốn hóa thị trường: $0.5T

CHỈ BÁO ON-CHAIN:
- MVRV Ratio: 1.20
- NUPL: 0.45
- SOPR: 0.98
- Địa chỉ hoạt động: 450,000

CHỈ BÁO KỸ THUẬT:
- RSI: 62.30 (Trung lập)
- MA50: $3,750
- MA200: $3,550
- MACD: 85.20

TÂM LÝ THỊ TRƯỜNG:
- Fear & Greed Index: 50 (Neutral)

THỊ TRƯỜNG PHÁI SINH:
- Lãi suất Funding: 0.850%
- Open Interest: $8.5B

TÍN HIỆU GIAO DỊCH:
- Tín hiệu: HOLD
- Độ tin cậy: 100%
- Mức độ rủi ro: LOW

CẢNH BÁO GẦN ĐÂY:
1. High Funding Rate Detected: Funding rate at 0.850% indicates strong long pressure and potential squeeze risk.

YÊU CẦU PHÂN TÍCH:
==================
Hãy cung cấp phân tích chi tiết và khuyến nghị đầu tư cho Ethereum dựa trên tất cả dữ liệu trên. Cân nhắc:

1. PHÂN TÍCH KỸ THUẬT:
   - Đánh giá động lượng và xu hướng dựa trên RSI, MACD
   - Phân tích vị trí giá so với đường trung bình động
   - Xem xét biến động và dải Bollinger

2. PHÂN TÍCH ON-CHAIN:
   - Đánh giá định giá dựa trên MVRV và NUPL
   - Phân tích hành vi của holder và mức lợi nhuận/thua lỗ

3. TÂM LÝ THỊ TRƯỜNG:
   - Diễn giải Fear & Greed Index trong bối cảnh giá hiện tại
   - Đánh giá tâm lý thị trường và các điểm cực đoan

4. QUẢN LÝ RỦI RO:
   - Xác định các yếu tố rủi ro chính
   - Đề xuất mức stop-loss và take-profit phù hợp

5. KHUYẾN NGHỊ ĐẦU TƯ:
   - Tín hiệu rõ ràng: MUA MẠNH, MUA, GIỮ, BÁN, BÁN MẠNH
   - Mức độ tin cậy (0-100)
   - Khung thời gian phân tích
   - Tiềm năng breakout (LOW/MEDIUM/HIGH)
   - Lý do chi tiết

Định dạng trả lời JSON:
{
  "recommendation": "MUA|BÁN|GIỮ|MUA MẠNH|BÁN MẠNH",
  "confidence": 0-100,
  "timeframe": "ví dụ: Ngắn hạn (1-2 tuần)",
  "breakoutPotential": "LOW|MEDIUM|HIGH",
  "reasoning": "lý do chi tiết bằng tiếng Việt"
}

Failed to make API request: TypeError: fetch failed
    at async generateEnhancedAIAnalysis (src/app/api/ai-analysis/route.ts:332:27)
    at async performAIAnalysis (src/app/api/ai-analysis/route.ts:176:29)
    at async POST (src/app/api/ai-analysis/route.ts:55:13)
  330 |       
  331 |       try {
> 332 |         const completion = await zai.chat.completions.create({
      |                           ^
  333 |           messages: [
  334 |             {
  335 |               role: 'system', {
  [cause]: [Error: getaddrinfo ENOTFOUND api.z-ai.dev] {
    errno: -3008,
    code: 'ENOTFOUND',
    syscall: 'getaddrinfo',
    hostname: 'api.z-ai.dev'
  }
}
Z.AI analysis failed, using fallback: fetch failed
🤖 [Z.AI] Received response from Z.AI (189ms):
📋 [Z.AI] Response: {
  "error": "fetch failed"
}
🤖 [ChatGPT] Received response from ChatGPT (0ms):
📋 [ChatGPT] Response: {
  "recommendation": "GIỮ",
  "confidence": 60,
  "timeframe": "Ngắn hạn đến trung hạn (1-4 tuần)",
  "breakoutPotential": "LOW",
  "reasoning": "Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên quan sát và chờ đợi tín hiệu tốt hơn."
}
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query INSERT INTO `main`.`analysis_history` (`id`, `cryptoId`, `coinId`, `signal`, `confidence`, `reasoning`, `riskLevel`, `aiModel`, `analysisType`, `analysisData`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `cryptoId` AS `cryptoId`, `coinId` AS `coinId`, `signal` AS `signal`, `confidence` AS `confidence`, `reasoning` AS `reasoning`, `riskLevel` AS `riskLevel`, `aiModel` AS `aiModel`, `analysisType` AS `analysisType`, `analysisData` AS `analysisData`, `metricsData` AS `metricsData`, `timestamp` AS `timestamp`
✅ AI analysis saved to database for ethereum
💿 [1754890101212-mvorcvuc6] Database save_analysis successful: {
  "cryptoId": "cme59qgpp0003pe499bz0lev5",
  "coinId": "ethereum",
  "analysisType": "AI_ENHANCED",
  "analysisData": "{\"recommendation\":\"GIỮ\",\"timeframe\":\"Ngắn hạn\",\"riskFactors\":[\"Thị trường biến động thông thường\"],\"entryPoints\":\"Chờ tín hiệu rõ ràng hơn trước khi vào lệnh\",\"exitPoints\":\"Chốt lời khi có biến động giá mạnh hoặc đạt mục tiêu lợi nhuận\",\"stopLoss\":\"Quản lý rủi ro chặt chẽ, stop loss tại mức biến động chấp nhận được\",\"takeProfit\":\"Take profit khi đạt lợi nhuận mục tiêu hoặc có thay đổi xu hướng\",\"zaiAnalysis\":{\"recommendation\":\"GIỮ\",\"confidence\":60,\"timeframe\":\"Ngắn hạn\",\"breakoutPotential\":\"LOW\",\"reasoning\":\"Phân tích dựa trên dữ liệu thị trường hiện tại.\"},\"chatGPTAnalysis\":{\"recommendation\":\"GIỮ\",\"confidence\":60,\"timeframe\":\"Ngắn hạn đến trung hạn (1-4 tuần)\",\"breakoutPotential\":\"LOW\",\"reasoning\":\"Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên quan sát và chờ đợi tín hiệu tốt hơn.\"}}",
  "signal": "GIỮ",
  "confidence": 60,
  "reasoning": "Z.AI: Phân tích dựa trên dữ liệu thị trường hiện tại.... | ChatGPT: Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên q...",
  "riskLevel": "MEDIUM",
  "aiModel": "Z.AI+ChatGPT"
}
✅ [5:28:21 AM] AI_ENHANCED_ANALYSIS - ethereum (279ms)
   Metadata: {
  analysisType: 'AI_ENHANCED',
  marketDataPoints: 8,
  alertsCount: 1,
  cacheUsed: false,
  aiModelsUsed: [ 'Z.AI', 'ChatGPT' ]
}
✅ [1754890101212-mvorcvuc6] Completed AI_ENHANCED_ANALYSIS successfully (279ms)
🎯 [1754890101212-mvorcvuc6] Final result: {
  "recommendation": "GIỮ",
  "timeframe": "Ngắn hạn",
  "riskFactors": [
    "Thị trường biến động thông thường"
  ],
  "entryPoints": "Chờ tín hiệu rõ ràng hơn trước khi vào lệnh",
  "exitPoints": "Chốt lời khi có biến động giá mạnh hoặc đạt mục tiêu lợi nhuận",
  "stopLoss": "Quản lý rủi ro chặt chẽ, stop loss tại mức biến động chấp nhận được",
  "takeProfit": "Take profit khi đạt lợi nhuận mục tiêu hoặc có thay đổi xu hướng",
  "zaiAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn",
    "breakoutPotential": "LOW",
    "reasoning": "Phân tích dựa trên dữ liệu thị trường hiện tại."
  },
  "chatGPTAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn đến trung hạn (1-4 tuần)",
    "breakoutPotential": "LOW",
    "reasoning": "Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên quan sát và chờ đợi tín hiệu tốt hơn."
  }
}
 POST /api/ai-analysis?action=analyze&coinId=ethereum 200 in 339ms
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `npx tsx server.ts`[39m
> Ready on http://0.0.0.0:3000
> Socket.IO server running at ws://0.0.0.0:3000/api/socketio
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `npx tsx server.ts`[39m
> Ready on http://0.0.0.0:3000
> Socket.IO server running at ws://0.0.0.0:3000/api/socketio
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `npx tsx server.ts`[39m
> Ready on http://0.0.0.0:3000
> Socket.IO server running at ws://0.0.0.0:3000/api/socketio
 ○ Compiling /api/ai-analysis ...
 ✓ Compiled /api/ai-analysis in 1571ms (501 modules)
🤖 [1754890398778-mhtqtgyei] Starting AI analysis operation: AI_ENHANCED_ANALYSIS for bitcoin
📊 [1754890398778-mhtqtgyei] Request data: {}
🤖 Starting AI analysis for bitcoin...
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE (`main`.`analysis_history`.`coinId` = ? AND `main`.`analysis_history`.`analysisType` = ?) ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
🤖 [AI Analysis] Generated prompt for bitcoin:
📄 [Prompt Length]: 1634 characters
📝 [Prompt Preview]: PHÂN TÍCH THỊ TRƯỜNG BITCOIN
========================================

DỮ LIỆU GIÁ:
- Giá hiện tại: $121,932
- Thay đổi 24h: 3.31%
- Khối lượng 24h: $45.7B
- Vốn hóa thị trường: $2.4T

CHỈ BÁO ON-CHAI...
🤖 [Z.AI] Sending prompt for bitcoin:
📝 [Z.AI] Prompt content:
PHÂN TÍCH THỊ TRƯỜNG BITCOIN
========================================

DỮ LIỆU GIÁ:
- Giá hiện tại: $121,932
- Thay đổi 24h: 3.31%
- Khối lượng 24h: $45.7B
- Vốn hóa thị trường: $2.4T

CHỈ BÁO ON-CHAIN:
- MVRV Ratio: 1.80
- NUPL: 0.65
- SOPR: 1.02
- Địa chỉ hoạt động: 950,000

CHỈ BÁO KỸ THUẬT:
- RSI: 58.50 (Trung lập)
- MA50: $112,000
- MA200: $108,000
- MACD: 145.50

TÂM LÝ THỊ TRƯỜNG:
- Fear & Greed Index: 70 (Greed)

THỊ TRƯỜNG PHÁI SINH:
- Lãi suất Funding: 1.250%
- Open Interest: $18.5B

YÊU CẦU PHÂN TÍCH:
==================
Hãy cung cấp phân tích chi tiết và khuyến nghị đầu tư cho Bitcoin dựa trên tất cả dữ liệu trên. Cân nhắc:

1. PHÂN TÍCH KỸ THUẬT:
   - Đánh giá động lượng và xu hướng dựa trên RSI, MACD
   - Phân tích vị trí giá so với đường trung bình động
   - Xem xét biến động và dải Bollinger

2. PHÂN TÍCH ON-CHAIN:
   - Đánh giá định giá dựa trên MVRV và NUPL
   - Phân tích hành vi của holder và mức lợi nhuận/thua lỗ

3. TÂM LÝ THỊ TRƯỜNG:
   - Diễn giải Fear & Greed Index trong bối cảnh giá hiện tại
   - Đánh giá tâm lý thị trường và các điểm cực đoan

4. QUẢN LÝ RỦI RO:
   - Xác định các yếu tố rủi ro chính
   - Đề xuất mức stop-loss và take-profit phù hợp

5. KHUYẾN NGHỊ ĐẦU TƯ:
   - Tín hiệu rõ ràng: MUA MẠNH, MUA, GIỮ, BÁN, BÁN MẠNH
   - Mức độ tin cậy (0-100)
   - Khung thời gian phân tích
   - Tiềm năng breakout (LOW/MEDIUM/HIGH)
   - Lý do chi tiết

Định dạng trả lời JSON:
{
  "recommendation": "MUA|BÁN|GIỮ|MUA MẠNH|BÁN MẠNH",
  "confidence": 0-100,
  "timeframe": "ví dụ: Ngắn hạn (1-2 tuần)",
  "breakoutPotential": "LOW|MEDIUM|HIGH",
  "reasoning": "lý do chi tiết bằng tiếng Việt"
}

💬 [Z.AI] Sending prompt to Z.AI:
📝 [Z.AI] Prompt content: PHÂN TÍCH THỊ TRƯỜNG BITCOIN
========================================

DỮ LIỆU GIÁ:
- Giá hiện tại: $121,932
- Thay đổi 24h: 3.31%
- Khối lượng 24h: $45.7B
- Vốn hóa thị trường: $2.4T

CHỈ BÁO ON-CHAIN:
- MVRV Ratio: 1.80
- NUPL: 0.65
- SOPR: 1.02
- Địa chỉ hoạt động: 950,000

CHỈ BÁO KỸ THUẬT:
- RSI: 58.50 (Trung lập)
- MA50: $112,000
- MA200: $108,000
- MACD: 145.50

TÂM LÝ THỊ TRƯỜNG:
- Fear & Greed Index: 70 (Greed)

THỊ TRƯỜNG PHÁI SINH:
- Lãi suất Funding: 1.250%
- Open Interest: $18.5B

YÊU CẦU PHÂN TÍCH:
==================
Hãy cung cấp phân tích chi tiết và khuyến nghị đầu tư cho Bitcoin dựa trên tất cả dữ liệu trên. Cân nhắc:

1. PHÂN TÍCH KỸ THUẬT:
   - Đánh giá động lượng và xu hướng dựa trên RSI, MACD
   - Phân tích vị trí giá so với đường trung bình động
   - Xem xét biến động và dải Bollinger

2. PHÂN TÍCH ON-CHAIN:
   - Đánh giá định giá dựa trên MVRV và NUPL
   - Phân tích hành vi của holder và mức lợi nhuận/thua lỗ

3. TÂM LÝ THỊ TRƯỜNG:
   - Diễn giải Fear & Greed Index trong bối cảnh giá hiện tại
   - Đánh giá tâm lý thị trường và các điểm cực đoan

4. QUẢN LÝ RỦI RO:
   - Xác định các yếu tố rủi ro chính
   - Đề xuất mức stop-loss và take-profit phù hợp

5. KHUYẾN NGHỊ ĐẦU TƯ:
   - Tín hiệu rõ ràng: MUA MẠNH, MUA, GIỮ, BÁN, BÁN MẠNH
   - Mức độ tin cậy (0-100)
   - Khung thời gian phân tích
   - Tiềm năng breakout (LOW/MEDIUM/HIGH)
   - Lý do chi tiết

Định dạng trả lời JSON:
{
  "recommendation": "MUA|BÁN|GIỮ|MUA MẠNH|BÁN MẠNH",
  "confidence": 0-100,
  "timeframe": "ví dụ: Ngắn hạn (1-2 tuần)",
  "breakoutPotential": "LOW|MEDIUM|HIGH",
  "reasoning": "lý do chi tiết bằng tiếng Việt"
}

Failed to make API request: TypeError: fetch failed
    at async generateEnhancedAIAnalysis (src/app/api/ai-analysis/route.ts:340:27)
    at async performAIAnalysis (src/app/api/ai-analysis/route.ts:176:29)
    at async POST (src/app/api/ai-analysis/route.ts:55:13)
  338 |       
  339 |       try {
> 340 |         const completion = await zai.chat.completions.create({
      |                           ^
  341 |           messages: [
  342 |             {
  343 |               role: 'system', {
  [cause]: [Error: getaddrinfo ENOTFOUND api.z-ai.dev] {
    errno: -3008,
    code: 'ENOTFOUND',
    syscall: 'getaddrinfo',
    hostname: 'api.z-ai.dev'
  }
}
Z.AI analysis failed, using fallback: fetch failed
🤖 [Z.AI] Received response from Z.AI (239ms):
📋 [Z.AI] Response: {
  "error": "fetch failed"
}
🤖 [ChatGPT] Using rule-based analysis for bitcoin (ChatGPT API not configured)
📋 [ChatGPT] Rule-based result: GIỮ (60% confidence)
🤖 [ChatGPT] Received response from ChatGPT (0ms):
📋 [ChatGPT] Response: {
  "recommendation": "GIỮ",
  "confidence": 60,
  "timeframe": "Ngắn hạn đến trung hạn (1-4 tuần)",
  "breakoutPotential": "LOW",
  "reasoning": "Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên quan sát và chờ đợi tín hiệu tốt hơn."
}
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query INSERT INTO `main`.`analysis_history` (`id`, `cryptoId`, `coinId`, `signal`, `confidence`, `reasoning`, `riskLevel`, `aiModel`, `analysisType`, `analysisData`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `cryptoId` AS `cryptoId`, `coinId` AS `coinId`, `signal` AS `signal`, `confidence` AS `confidence`, `reasoning` AS `reasoning`, `riskLevel` AS `riskLevel`, `aiModel` AS `aiModel`, `analysisType` AS `analysisType`, `analysisData` AS `analysisData`, `metricsData` AS `metricsData`, `timestamp` AS `timestamp`
✅ AI analysis saved to database for bitcoin
💿 [1754890398778-mhtqtgyei] Database save_analysis successful: {
  "cryptoId": "cme59qgll0000pe49v3wnhyfe",
  "coinId": "bitcoin",
  "analysisType": "AI_ENHANCED",
  "analysisData": "{\"recommendation\":\"GIỮ\",\"timeframe\":\"Ngắn hạn\",\"riskFactors\":[\"Thị trường biến động thông thường\"],\"entryPoints\":\"Chờ tín hiệu rõ ràng hơn trước khi vào lệnh\",\"exitPoints\":\"Chốt lời khi có biến động giá mạnh hoặc đạt mục tiêu lợi nhuận\",\"stopLoss\":\"Quản lý rủi ro chặt chẽ, stop loss tại mức biến động chấp nhận được\",\"takeProfit\":\"Take profit khi đạt lợi nhuận mục tiêu hoặc có thay đổi xu hướng\",\"zaiAnalysis\":{\"recommendation\":\"GIỮ\",\"confidence\":60,\"timeframe\":\"Ngắn hạn\",\"breakoutPotential\":\"LOW\",\"reasoning\":\"Phân tích dựa trên dữ liệu thị trường hiện tại.\"},\"chatGPTAnalysis\":{\"recommendation\":\"GIỮ\",\"confidence\":60,\"timeframe\":\"Ngắn hạn đến trung hạn (1-4 tuần)\",\"breakoutPotential\":\"LOW\",\"reasoning\":\"Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên quan sát và chờ đợi tín hiệu tốt hơn.\"}}",
  "signal": "GIỮ",
  "confidence": 60,
  "reasoning": "Z.AI: Phân tích dựa trên dữ liệu thị trường hiện tại.... | ChatGPT: Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên q...",
  "riskLevel": "MEDIUM",
  "aiModel": "Z.AI+ChatGPT"
}
✅ [5:33:22 AM] AI_ENHANCED_ANALYSIS - bitcoin (3445ms)
   Metadata: {
  analysisType: 'AI_ENHANCED',
  marketDataPoints: 6,
  alertsCount: 0,
  cacheUsed: false,
  aiModelsUsed: [ 'Z.AI', 'ChatGPT' ]
}
✅ [1754890398778-mhtqtgyei] Completed AI_ENHANCED_ANALYSIS successfully (3445ms)
🎯 [1754890398778-mhtqtgyei] Final result: {
  "recommendation": "GIỮ",
  "timeframe": "Ngắn hạn",
  "riskFactors": [
    "Thị trường biến động thông thường"
  ],
  "entryPoints": "Chờ tín hiệu rõ ràng hơn trước khi vào lệnh",
  "exitPoints": "Chốt lời khi có biến động giá mạnh hoặc đạt mục tiêu lợi nhuận",
  "stopLoss": "Quản lý rủi ro chặt chẽ, stop loss tại mức biến động chấp nhận được",
  "takeProfit": "Take profit khi đạt lợi nhuận mục tiêu hoặc có thay đổi xu hướng",
  "zaiAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn",
    "breakoutPotential": "LOW",
    "reasoning": "Phân tích dựa trên dữ liệu thị trường hiện tại."
  },
  "chatGPTAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn đến trung hạn (1-4 tuần)",
    "breakoutPotential": "LOW",
    "reasoning": "Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên quan sát và chờ đợi tín hiệu tốt hơn."
  }
}
 POST /api/ai-analysis?action=analyze&coinId=bitcoin 200 in 6360ms
 ○ Compiling / ...
 ✓ Compiled / in 3.6s (1012 modules)
 GET / 200 in 215ms
 ○ Compiling /favicon.ico ...
 ✓ Compiled /favicon.ico in 634ms (633 modules)
 GET /favicon.ico 200 in 822ms
 ○ Compiling /api/dashboard ...
 ✓ Compiled /api/dashboard in 1071ms (1004 modules)
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`isActive` = ? ORDER BY `main`.`cryptocurrencies`.`isDefault` DESC, `main`.`cryptocurrencies`.`rank` ASC, `main`.`cryptocurrencies`.`createdAt` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`coin_data_collection`.`id`, `main`.`coin_data_collection`.`cryptoId`, `main`.`coin_data_collection`.`status`, `main`.`coin_data_collection`.`lastCollected`, `main`.`coin_data_collection`.`nextCollection`, `main`.`coin_data_collection`.`errorCount`, `main`.`coin_data_collection`.`lastError`, `main`.`coin_data_collection`.`metadata` FROM `main`.`coin_data_collection` WHERE `main`.`coin_data_collection`.`cryptoId` IN (?,?,?,?,?) LIMIT ? OFFSET ?
 GET /api/cryptocurrencies?activeOnly=true 200 in 1311ms
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE `main`.`analysis_history`.`cryptoId` = ? ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/dashboard?coinId=bitcoin 200 in 1347ms
 ✓ Compiled /api/trading-signals-fast in 367ms (1007 modules)
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/trading-signals-fast?action=signal&coinId=bitcoin 200 in 566ms
 ✓ Compiled /api/alerts-fast in 355ms (1010 modules)
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/alerts-fast?action=process-data&coinId=bitcoin 200 in 495ms
 GET / 200 in 225ms
 GET /favicon.ico 200 in 55ms
prisma:query SELECT 1
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`isActive` = ? ORDER BY `main`.`cryptocurrencies`.`isDefault` DESC, `main`.`cryptocurrencies`.`rank` ASC, `main`.`cryptocurrencies`.`createdAt` DESC LIMIT ? OFFSET ?
prisma:query SELECT 1
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`coin_data_collection`.`id`, `main`.`coin_data_collection`.`cryptoId`, `main`.`coin_data_collection`.`status`, `main`.`coin_data_collection`.`lastCollected`, `main`.`coin_data_collection`.`nextCollection`, `main`.`coin_data_collection`.`errorCount`, `main`.`coin_data_collection`.`lastError`, `main`.`coin_data_collection`.`metadata` FROM `main`.`coin_data_collection` WHERE `main`.`coin_data_collection`.`cryptoId` IN (?,?,?,?,?) LIMIT ? OFFSET ?
 GET /api/cryptocurrencies?activeOnly=true 200 in 105ms
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE `main`.`analysis_history`.`cryptoId` = ? ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/dashboard?coinId=bitcoin 200 in 162ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/trading-signals-fast?action=signal&coinId=bitcoin 200 in 108ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/alerts-fast?action=process-data&coinId=bitcoin 200 in 69ms
🤖 [1754890417787-cy1hr4thq] Starting AI analysis operation: AI_ENHANCED_ANALYSIS for bitcoin
📊 [1754890417787-cy1hr4thq] Request data: {
  "marketData": {
    "price": {
      "usd": 117775,
      "usd_24h_change": 0.8618738474048199,
      "usd_24h_vol": 33776641957.26242,
      "usd_market_cap": 2343795976558.965
    },
    "onChain": {
      "mvrv": 1.8,
      "nupl": 0.65,
      "sopr": 1.02,
      "activeAddresses": 950000,
      "exchangeInflow": 15000,
      "exchangeOutflow": 12000,
      "transactionVolume": 25000000000,
      "supplyDistribution": {
        "whaleHoldings": {
          "percentage": 42.3,
          "addressCount": 850
        },
        "retailHoldings": {
          "percentage": 38.7,
          "addressCount": 42000000
        },
        "exchangeHoldings": {
          "percentage": 12.5,
          "addressCount": 150
        },
        "otherHoldings": {
          "percentage": 6.5,
          "addressCount": 120000
        }
      },
      "whaleHoldingsPercentage": 42.3,
      "retailHoldingsPercentage": 38.7,
      "exchangeHoldingsPercentage": 12.5
    },
    "technical": {
      "rsi": 58.5,
      "ma50": 112000,
      "ma200": 108000,
      "macd": 145.5,
      "macdSignal": null,
      "bollingerUpper": 122000,
      "bollingerLower": 111000,
      "bollingerMiddle": 116627
    },
    "derivatives": {
      "openInterest": 18500000000,
      "fundingRate": 0.0125,
      "liquidationVolume": 45000000,
      "putCallRatio": 0.85
    },
    "sentiment": {
      "fearGreedIndex": 50,
      "fearGreedClassification": "Neutral",
      "social": {
        "twitterSentiment": 0.5,
        "redditSentiment": 0.5,
        "socialVolume": 45000,
        "engagementRate": 0.085,
        "influencerSentiment": 0.75,
        "trendingScore": 75
      },
      "news": {
        "newsSentiment": 0.5,
        "newsVolume": 1250,
        "positiveNewsCount": 780,
        "negativeNewsCount": 320,
        "neutralNewsCount": 150,
        "sentimentScore": 0.5,
        "buzzScore": 75
      },
      "googleTrends": {
        "trendsScore": 75,
        "searchVolume": 850000,
        "trendingKeywords": [
          "bitcoin price",
          "btc news",
          "bitcoin mining"
        ],
        "regionalInterest": {
          "US": 85,
          "CN": 72,
          "EU": 68,
          "JP": 45,
          "KR": 52
        },
        "relatedQueries": [
          {
            "query": "bitcoin price today",
            "score": 95,
            "rising": true
          },
          {
            "query": "bitcoin prediction",
            "score": 78,
            "rising": true
          },
          {
            "query": "bitcoin mining",
            "score": 65,
            "rising": false
          }
        ],
        "trendDirection": "stable"
      }
    },
    "analysis": {
      "signal": "GIỮ",
      "confidence": 60,
      "reasoning": "Z.AI: Phân tích dựa trên dữ liệu thị trường hiện tại.... | ChatGPT: Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên q...",
      "riskLevel": "MEDIUM",
      "aiModel": "Z.AI+ChatGPT"
    },
    "timestamp": "2025-08-11T05:33:35.884Z",
    "dataSource": "database"
  },
  "tradingSignal": {
    "signal": "HOLD",
    "confidence": 50,
    "reasoning": "Tín hiệu trung lập: Không đủ điều kiện để MUA hoặc BÁN. Cần theo dõi thêm.",
    "riskLevel": "MEDIUM",
    "conditions": {
      "mvrv": 1.8,
      "fearGreed": 50,
      "fundingRate": 0.0125,
      "sopr": 1.02,
      "rsi": 58.5,
      "nupl": 0.65,
      "volumeTrend": "increasing",
      "extremeDetected": false
    },
    "triggers": []
  },
  "alerts": [
    {
      "id": "alert_1754890417043_kfic39cpt",
      "type": "WARNING",
      "category": "DERIVATIVES",
      "title": "High Open Interest Detected",
      "message": "Open interest at $18.5B is near historical highs - increased volatility risk.",
      "severity": "MEDIUM",
      "timestamp": "2025-08-11T05:33:37.043Z",
      "coinId": "bitcoin",
      "data": {
        "openInterest": 18500000000,
        "historicalHigh": 18500000000,
        "percentage": "100.0"
      },
      "triggeredBy": [
        "High open interest"
      ],
      "actionRequired": true,
      "recommendedAction": "Prepare for increased volatility and potential liquidations"
    }
  ],
  "coinId": "bitcoin"
}
🤖 Starting AI analysis for bitcoin...
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE (`main`.`analysis_history`.`coinId` = ? AND `main`.`analysis_history`.`analysisType` = ?) ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
🤖 Using cached AI analysis for bitcoin
💾 [1754890417787-cy1hr4thq] Using cached analysis for bitcoin (age: 15644ms)
✅ [1754890417787-cy1hr4thq] Completed AI_ENHANCED_ANALYSIS successfully (6ms)
🎯 [1754890417787-cy1hr4thq] Final result: {
  "recommendation": "GIỮ",
  "timeframe": "Ngắn hạn",
  "riskFactors": [
    "Thị trường biến động thông thường"
  ],
  "entryPoints": "Chờ tín hiệu rõ ràng hơn trước khi vào lệnh",
  "exitPoints": "Chốt lời khi có biến động giá mạnh hoặc đạt mục tiêu lợi nhuận",
  "stopLoss": "Quản lý rủi ro chặt chẽ, stop loss tại mức biến động chấp nhận được",
  "takeProfit": "Take profit khi đạt lợi nhuận mục tiêu hoặc có thay đổi xu hướng",
  "zaiAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn",
    "breakoutPotential": "LOW",
    "reasoning": "Phân tích dựa trên dữ liệu thị trường hiện tại."
  },
  "chatGPTAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn đến trung hạn (1-4 tuần)",
    "breakoutPotential": "LOW",
    "reasoning": "Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên quan sát và chờ đợi tín hiệu tốt hơn."
  }
}
 POST /api/ai-analysis?action=analyze&coinId=bitcoin 200 in 75ms
 GET / 200 in 73ms
 GET /favicon.ico 200 in 42ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`isActive` = ? ORDER BY `main`.`cryptocurrencies`.`isDefault` DESC, `main`.`cryptocurrencies`.`rank` ASC, `main`.`cryptocurrencies`.`createdAt` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`coin_data_collection`.`id`, `main`.`coin_data_collection`.`cryptoId`, `main`.`coin_data_collection`.`status`, `main`.`coin_data_collection`.`lastCollected`, `main`.`coin_data_collection`.`nextCollection`, `main`.`coin_data_collection`.`errorCount`, `main`.`coin_data_collection`.`lastError`, `main`.`coin_data_collection`.`metadata` FROM `main`.`coin_data_collection` WHERE `main`.`coin_data_collection`.`cryptoId` IN (?,?,?,?,?) LIMIT ? OFFSET ?
 GET /api/cryptocurrencies?activeOnly=true 200 in 73ms
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE `main`.`analysis_history`.`cryptoId` = ? ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/dashboard?coinId=bitcoin 200 in 90ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET / 200 in 95ms
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /favicon.ico 200 in 37ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`isActive` = ? ORDER BY `main`.`cryptocurrencies`.`isDefault` DESC, `main`.`cryptocurrencies`.`rank` ASC, `main`.`cryptocurrencies`.`createdAt` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`coin_data_collection`.`id`, `main`.`coin_data_collection`.`cryptoId`, `main`.`coin_data_collection`.`status`, `main`.`coin_data_collection`.`lastCollected`, `main`.`coin_data_collection`.`nextCollection`, `main`.`coin_data_collection`.`errorCount`, `main`.`coin_data_collection`.`lastError`, `main`.`coin_data_collection`.`metadata` FROM `main`.`coin_data_collection` WHERE `main`.`coin_data_collection`.`cryptoId` IN (?,?,?,?,?) LIMIT ? OFFSET ?
 GET /api/cryptocurrencies?activeOnly=true 200 in 77ms
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE `main`.`analysis_history`.`cryptoId` = ? ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/dashboard?coinId=bitcoin 200 in 101ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/trading-signals-fast?action=signal&coinId=bitcoin 200 in 61ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/alerts-fast?action=process-data&coinId=bitcoin 200 in 85ms
🤖 [1754890427735-sbkl3p9es] Starting AI analysis operation: AI_ENHANCED_ANALYSIS for bitcoin
📊 [1754890427735-sbkl3p9es] Request data: {
  "marketData": {
    "price": {
      "usd": 117775,
      "usd_24h_change": 0.8618738474048199,
      "usd_24h_vol": 33776641957.26242,
      "usd_market_cap": 2343795976558.965
    },
    "onChain": {
      "mvrv": 1.8,
      "nupl": 0.65,
      "sopr": 1.02,
      "activeAddresses": 950000,
      "exchangeInflow": 15000,
      "exchangeOutflow": 12000,
      "transactionVolume": 25000000000,
      "supplyDistribution": {
        "whaleHoldings": {
          "percentage": 42.3,
          "addressCount": 850
        },
        "retailHoldings": {
          "percentage": 38.7,
          "addressCount": 42000000
        },
        "exchangeHoldings": {
          "percentage": 12.5,
          "addressCount": 150
        },
        "otherHoldings": {
          "percentage": 6.5,
          "addressCount": 120000
        }
      },
      "whaleHoldingsPercentage": 42.3,
      "retailHoldingsPercentage": 38.7,
      "exchangeHoldingsPercentage": 12.5
    },
    "technical": {
      "rsi": 58.5,
      "ma50": 112000,
      "ma200": 108000,
      "macd": 145.5,
      "macdSignal": null,
      "bollingerUpper": 122000,
      "bollingerLower": 111000,
      "bollingerMiddle": 116627
    },
    "derivatives": {
      "openInterest": 18500000000,
      "fundingRate": 0.0125,
      "liquidationVolume": 45000000,
      "putCallRatio": 0.85
    },
    "sentiment": {
      "fearGreedIndex": 50,
      "fearGreedClassification": "Neutral",
      "social": {
        "twitterSentiment": 0.5,
        "redditSentiment": 0.5,
        "socialVolume": 45000,
        "engagementRate": 0.085,
        "influencerSentiment": 0.75,
        "trendingScore": 75
      },
      "news": {
        "newsSentiment": 0.5,
        "newsVolume": 1250,
        "positiveNewsCount": 780,
        "negativeNewsCount": 320,
        "neutralNewsCount": 150,
        "sentimentScore": 0.5,
        "buzzScore": 75
      },
      "googleTrends": {
        "trendsScore": 75,
        "searchVolume": 850000,
        "trendingKeywords": [
          "bitcoin price",
          "btc news",
          "bitcoin mining"
        ],
        "regionalInterest": {
          "US": 85,
          "CN": 72,
          "EU": 68,
          "JP": 45,
          "KR": 52
        },
        "relatedQueries": [
          {
            "query": "bitcoin price today",
            "score": 95,
            "rising": true
          },
          {
            "query": "bitcoin prediction",
            "score": 78,
            "rising": true
          },
          {
            "query": "bitcoin mining",
            "score": 65,
            "rising": false
          }
        ],
        "trendDirection": "stable"
      }
    },
    "analysis": {
      "signal": "GIỮ",
      "confidence": 60,
      "reasoning": "Z.AI: Phân tích dựa trên dữ liệu thị trường hiện tại.... | ChatGPT: Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên q...",
      "riskLevel": "MEDIUM",
      "aiModel": "Z.AI+ChatGPT"
    },
    "timestamp": "2025-08-11T05:33:46.806Z",
    "dataSource": "database"
  },
  "tradingSignal": {
    "signal": "HOLD",
    "confidence": 50,
    "reasoning": "Tín hiệu trung lập: Không đủ điều kiện để MUA hoặc BÁN. Cần theo dõi thêm.",
    "riskLevel": "MEDIUM",
    "conditions": {
      "mvrv": 1.8,
      "fearGreed": 50,
      "fundingRate": 0.0125,
      "sopr": 1.02,
      "rsi": 58.5,
      "nupl": 0.65,
      "volumeTrend": "increasing",
      "extremeDetected": false
    },
    "triggers": []
  },
  "alerts": [],
  "coinId": "bitcoin"
}
🤖 Starting AI analysis for bitcoin...
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE (`main`.`analysis_history`.`coinId` = ? AND `main`.`analysis_history`.`analysisType` = ?) ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
🤖 Using cached AI analysis for bitcoin
💾 [1754890427735-sbkl3p9es] Using cached analysis for bitcoin (age: 25595ms)
✅ [1754890427735-sbkl3p9es] Completed AI_ENHANCED_ANALYSIS successfully (9ms)
🎯 [1754890427735-sbkl3p9es] Final result: {
  "recommendation": "GIỮ",
  "timeframe": "Ngắn hạn",
  "riskFactors": [
    "Thị trường biến động thông thường"
  ],
  "entryPoints": "Chờ tín hiệu rõ ràng hơn trước khi vào lệnh",
  "exitPoints": "Chốt lời khi có biến động giá mạnh hoặc đạt mục tiêu lợi nhuận",
  "stopLoss": "Quản lý rủi ro chặt chẽ, stop loss tại mức biến động chấp nhận được",
  "takeProfit": "Take profit khi đạt lợi nhuận mục tiêu hoặc có thay đổi xu hướng",
  "zaiAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn",
    "breakoutPotential": "LOW",
    "reasoning": "Phân tích dựa trên dữ liệu thị trường hiện tại."
  },
  "chatGPTAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn đến trung hạn (1-4 tuần)",
    "breakoutPotential": "LOW",
    "reasoning": "Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên quan sát và chờ đợi tín hiệu tốt hơn."
  }
}
 POST /api/ai-analysis?action=analyze&coinId=bitcoin 200 in 49ms
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `npx tsx server.ts`[39m
> Ready on http://0.0.0.0:3000
> Socket.IO server running at ws://0.0.0.0:3000/api/socketio
 ○ Compiling /api/ai-analysis ...
 ✓ Compiled / in 3.8s (1012 modules)
 GET / 200 in 2913ms
🤖 [1754890442374-d8aa62u3f] Starting AI analysis operation: AI_ENHANCED_ANALYSIS for bitcoin
📊 [1754890442374-d8aa62u3f] Request data: {
  "test": true
}
🧪 [TEST] Console.log test - AI Analysis starting for bitcoin
🤖 Starting AI analysis for bitcoin...
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE (`main`.`analysis_history`.`coinId` = ? AND `main`.`analysis_history`.`analysisType` = ?) ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
🤖 Using cached AI analysis for bitcoin
💾 [1754890442374-d8aa62u3f] Using cached analysis for bitcoin (age: 40724ms)
✅ [1754890442374-d8aa62u3f] Completed AI_ENHANCED_ANALYSIS successfully (500ms)
🎯 [1754890442374-d8aa62u3f] Final result: {
  "recommendation": "GIỮ",
  "timeframe": "Ngắn hạn",
  "riskFactors": [
    "Thị trường biến động thông thường"
  ],
  "entryPoints": "Chờ tín hiệu rõ ràng hơn trước khi vào lệnh",
  "exitPoints": "Chốt lời khi có biến động giá mạnh hoặc đạt mục tiêu lợi nhuận",
  "stopLoss": "Quản lý rủi ro chặt chẽ, stop loss tại mức biến động chấp nhận được",
  "takeProfit": "Take profit khi đạt lợi nhuận mục tiêu hoặc có thay đổi xu hướng",
  "zaiAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn",
    "breakoutPotential": "LOW",
    "reasoning": "Phân tích dựa trên dữ liệu thị trường hiện tại."
  },
  "chatGPTAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn đến trung hạn (1-4 tuần)",
    "breakoutPotential": "LOW",
    "reasoning": "Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên quan sát và chờ đợi tín hiệu tốt hơn."
  }
}
 POST /api/ai-analysis?action=analyze&coinId=bitcoin 200 in 5821ms
 GET / 200 in 1860ms
 ✓ Compiled /favicon.ico in 325ms (633 modules)
 GET /favicon.ico 200 in 440ms
 ○ Compiling /api/cryptocurrencies ...
 ✓ Compiled /api/cryptocurrencies in 971ms (1004 modules)
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`isActive` = ? ORDER BY `main`.`cryptocurrencies`.`isDefault` DESC, `main`.`cryptocurrencies`.`rank` ASC, `main`.`cryptocurrencies`.`createdAt` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`coin_data_collection`.`id`, `main`.`coin_data_collection`.`cryptoId`, `main`.`coin_data_collection`.`status`, `main`.`coin_data_collection`.`lastCollected`, `main`.`coin_data_collection`.`nextCollection`, `main`.`coin_data_collection`.`errorCount`, `main`.`coin_data_collection`.`lastError`, `main`.`coin_data_collection`.`metadata` FROM `main`.`coin_data_collection` WHERE `main`.`coin_data_collection`.`cryptoId` IN (?,?,?,?,?) LIMIT ? OFFSET ?
 GET /api/cryptocurrencies?activeOnly=true 200 in 1235ms
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE `main`.`analysis_history`.`cryptoId` = ? ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/dashboard?coinId=bitcoin 200 in 1332ms
 ✓ Compiled /api/trading-signals-fast in 355ms (1007 modules)
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/trading-signals-fast?action=signal&coinId=bitcoin 200 in 536ms
 ✓ Compiled /api/alerts-fast in 404ms (1010 modules)
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/alerts-fast?action=process-data&coinId=bitcoin 200 in 583ms
🤖 [1754890448251-ie008nlsj] Starting AI analysis operation: AI_ENHANCED_ANALYSIS for bitcoin
📊 [1754890448251-ie008nlsj] Request data: {
  "marketData": {
    "price": {
      "usd": 117775,
      "usd_24h_change": 0.8618738474048199,
      "usd_24h_vol": 33776641957.26242,
      "usd_market_cap": 2343795976558.965
    },
    "onChain": {
      "mvrv": 1.8,
      "nupl": 0.65,
      "sopr": 1.02,
      "activeAddresses": 950000,
      "exchangeInflow": 15000,
      "exchangeOutflow": 12000,
      "transactionVolume": 25000000000,
      "supplyDistribution": {
        "whaleHoldings": {
          "percentage": 42.3,
          "addressCount": 850
        },
        "retailHoldings": {
          "percentage": 38.7,
          "addressCount": 42000000
        },
        "exchangeHoldings": {
          "percentage": 12.5,
          "addressCount": 150
        },
        "otherHoldings": {
          "percentage": 6.5,
          "addressCount": 120000
        }
      },
      "whaleHoldingsPercentage": 42.3,
      "retailHoldingsPercentage": 38.7,
      "exchangeHoldingsPercentage": 12.5
    },
    "technical": {
      "rsi": 58.5,
      "ma50": 112000,
      "ma200": 108000,
      "macd": 145.5,
      "macdSignal": null,
      "bollingerUpper": 122000,
      "bollingerLower": 111000,
      "bollingerMiddle": 116627
    },
    "derivatives": {
      "openInterest": 18500000000,
      "fundingRate": 0.0125,
      "liquidationVolume": 45000000,
      "putCallRatio": 0.85
    },
    "sentiment": {
      "fearGreedIndex": 50,
      "fearGreedClassification": "Neutral",
      "social": {
        "twitterSentiment": 0.5,
        "redditSentiment": 0.5,
        "socialVolume": 45000,
        "engagementRate": 0.085,
        "influencerSentiment": 0.75,
        "trendingScore": 75
      },
      "news": {
        "newsSentiment": 0.5,
        "newsVolume": 1250,
        "positiveNewsCount": 780,
        "negativeNewsCount": 320,
        "neutralNewsCount": 150,
        "sentimentScore": 0.5,
        "buzzScore": 75
      },
      "googleTrends": {
        "trendsScore": 75,
        "searchVolume": 850000,
        "trendingKeywords": [
          "bitcoin price",
          "btc news",
          "bitcoin mining"
        ],
        "regionalInterest": {
          "US": 85,
          "CN": 72,
          "EU": 68,
          "JP": 45,
          "KR": 52
        },
        "relatedQueries": [
          {
            "query": "bitcoin price today",
            "score": 95,
            "rising": true
          },
          {
            "query": "bitcoin prediction",
            "score": 78,
            "rising": true
          },
          {
            "query": "bitcoin mining",
            "score": 65,
            "rising": false
          }
        ],
        "trendDirection": "stable"
      }
    },
    "analysis": {
      "signal": "GIỮ",
      "confidence": 60,
      "reasoning": "Z.AI: Phân tích dựa trên dữ liệu thị trường hiện tại.... | ChatGPT: Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên q...",
      "riskLevel": "MEDIUM",
      "aiModel": "Z.AI+ChatGPT"
    },
    "timestamp": "2025-08-11T05:34:05.654Z",
    "dataSource": "database"
  },
  "tradingSignal": {
    "signal": "HOLD",
    "confidence": 50,
    "reasoning": "Tín hiệu trung lập: Không đủ điều kiện để MUA hoặc BÁN. Cần theo dõi thêm.",
    "riskLevel": "MEDIUM",
    "conditions": {
      "mvrv": 1.8,
      "fearGreed": 50,
      "fundingRate": 0.0125,
      "sopr": 1.02,
      "rsi": 58.5,
      "nupl": 0.65,
      "volumeTrend": "increasing",
      "extremeDetected": false
    },
    "triggers": []
  },
  "alerts": [
    {
      "id": "alert_1754890447411_u1o77rsug",
      "type": "WARNING",
      "category": "FUNDING_RATE",
      "title": "High Funding Rate Detected",
      "message": "Funding rate at 1.250% indicates strong long pressure and potential squeeze risk.",
      "severity": "MEDIUM",
      "timestamp": "2025-08-11T05:34:07.411Z",
      "coinId": "bitcoin",
      "data": {
        "fundingRate": 0.0125,
        "threshold": 0.001
      },
      "triggeredBy": [
        "High funding rate"
      ],
      "actionRequired": true,
      "recommendedAction": "Monitor for potential long squeeze or price correction"
    }
  ],
  "coinId": "bitcoin"
}
🧪 [TEST] Console.log test - AI Analysis starting for bitcoin
🤖 Starting AI analysis for bitcoin...
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE (`main`.`analysis_history`.`coinId` = ? AND `main`.`analysis_history`.`analysisType` = ?) ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
🤖 Using cached AI analysis for bitcoin
💾 [1754890448251-ie008nlsj] Using cached analysis for bitcoin (age: 46125ms)
✅ [1754890448251-ie008nlsj] Completed AI_ENHANCED_ANALYSIS successfully (23ms)
🎯 [1754890448251-ie008nlsj] Final result: {
  "recommendation": "GIỮ",
  "timeframe": "Ngắn hạn",
  "riskFactors": [
    "Thị trường biến động thông thường"
  ],
  "entryPoints": "Chờ tín hiệu rõ ràng hơn trước khi vào lệnh",
  "exitPoints": "Chốt lời khi có biến động giá mạnh hoặc đạt mục tiêu lợi nhuận",
  "stopLoss": "Quản lý rủi ro chặt chẽ, stop loss tại mức biến động chấp nhận được",
  "takeProfit": "Take profit khi đạt lợi nhuận mục tiêu hoặc có thay đổi xu hướng",
  "zaiAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn",
    "breakoutPotential": "LOW",
    "reasoning": "Phân tích dựa trên dữ liệu thị trường hiện tại."
  },
  "chatGPTAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn đến trung hạn (1-4 tuần)",
    "breakoutPotential": "LOW",
    "reasoning": "Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên quan sát và chờ đợi tín hiệu tốt hơn."
  }
}
 POST /api/ai-analysis?action=analyze&coinId=bitcoin 200 in 122ms
 GET / 200 in 234ms
 GET /favicon.ico 200 in 65ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`isActive` = ? ORDER BY `main`.`cryptocurrencies`.`isDefault` DESC, `main`.`cryptocurrencies`.`rank` ASC, `main`.`cryptocurrencies`.`createdAt` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`coin_data_collection`.`id`, `main`.`coin_data_collection`.`cryptoId`, `main`.`coin_data_collection`.`status`, `main`.`coin_data_collection`.`lastCollected`, `main`.`coin_data_collection`.`nextCollection`, `main`.`coin_data_collection`.`errorCount`, `main`.`coin_data_collection`.`lastError`, `main`.`coin_data_collection`.`metadata` FROM `main`.`coin_data_collection` WHERE `main`.`coin_data_collection`.`cryptoId` IN (?,?,?,?,?) LIMIT ? OFFSET ?
 GET /api/cryptocurrencies?activeOnly=true 200 in 121ms
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE `main`.`analysis_history`.`cryptoId` = ? ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/dashboard?coinId=bitcoin 200 in 227ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/trading-signals-fast?action=signal&coinId=bitcoin 200 in 89ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/alerts-fast?action=process-data&coinId=bitcoin 200 in 76ms
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
Error in AI analysis API: SyntaxError: Unexpected end of JSON input
    at JSON.parse (<anonymous>)
    at POST (src/app/api/ai-analysis/route.ts:52:31)
  50 |     const action = searchParams.get('action')
  51 |     const coinId = searchParams.get('coinId') || 'bitcoin'
> 52 |     const body = await request.json()
     |                               ^
  53 |
  54 |     if (action === 'analyze') {
  55 |       return await performAIAnalysis(coinId, body)
 GET / 200 in 72ms
🤖 [1754890458720-k0cduk55e] Starting AI analysis operation: AI_ENHANCED_ANALYSIS for ethereum
📊 [1754890458720-k0cduk55e] Request data: {}
🧪 [TEST] Console.log test - AI Analysis starting for ethereum
🤖 Starting AI analysis for ethereum...
prisma:query SELECT 1
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE (`main`.`analysis_history`.`coinId` = ? AND `main`.`analysis_history`.`analysisType` = ?) ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
🤖 Using cached AI analysis for ethereum
💾 [1754890458720-k0cduk55e] Using cached analysis for ethereum (age: 357283ms)
✅ [1754890458720-k0cduk55e] Completed AI_ENHANCED_ANALYSIS successfully (7ms)
🎯 [1754890458720-k0cduk55e] Final result: {
  "recommendation": "GIỮ",
  "timeframe": "Ngắn hạn",
  "riskFactors": [
    "Thị trường biến động thông thường"
  ],
  "entryPoints": "Chờ tín hiệu rõ ràng hơn trước khi vào lệnh",
  "exitPoints": "Chốt lời khi có biến động giá mạnh hoặc đạt mục tiêu lợi nhuận",
  "stopLoss": "Quản lý rủi ro chặt chẽ, stop loss tại mức biến động chấp nhận được",
  "takeProfit": "Take profit khi đạt lợi nhuận mục tiêu hoặc có thay đổi xu hướng",
  "zaiAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn",
    "breakoutPotential": "LOW",
    "reasoning": "Phân tích dựa trên dữ liệu thị trường hiện tại."
  },
  "chatGPTAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn đến trung hạn (1-4 tuần)",
    "breakoutPotential": "LOW",
    "reasoning": "Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên quan sát và chờ đợi tín hiệu tốt hơn."
  }
}
 POST /api/ai-analysis?action=analyze&coinId=ethereum 200 in 55ms
 GET /favicon.ico 200 in 56ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`isActive` = ? ORDER BY `main`.`cryptocurrencies`.`isDefault` DESC, `main`.`cryptocurrencies`.`rank` ASC, `main`.`cryptocurrencies`.`createdAt` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`coin_data_collection`.`id`, `main`.`coin_data_collection`.`cryptoId`, `main`.`coin_data_collection`.`status`, `main`.`coin_data_collection`.`lastCollected`, `main`.`coin_data_collection`.`nextCollection`, `main`.`coin_data_collection`.`errorCount`, `main`.`coin_data_collection`.`lastError`, `main`.`coin_data_collection`.`metadata` FROM `main`.`coin_data_collection` WHERE `main`.`coin_data_collection`.`cryptoId` IN (?,?,?,?,?) LIMIT ? OFFSET ?
 GET /api/cryptocurrencies?activeOnly=true 200 in 84ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE `main`.`analysis_history`.`cryptoId` = ? ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/dashboard?coinId=bitcoin 200 in 142ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/trading-signals-fast?action=signal&coinId=bitcoin 200 in 95ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/alerts-fast?action=process-data&coinId=bitcoin 200 in 71ms
🤖 [1754890460621-3cq5c3cra] Starting AI analysis operation: AI_ENHANCED_ANALYSIS for bitcoin
📊 [1754890460621-3cq5c3cra] Request data: {
  "marketData": {
    "price": {
      "usd": 117775,
      "usd_24h_change": 0.8618738474048199,
      "usd_24h_vol": 33776641957.26242,
      "usd_market_cap": 2343795976558.965
    },
    "onChain": {
      "mvrv": 1.8,
      "nupl": 0.65,
      "sopr": 1.02,
      "activeAddresses": 950000,
      "exchangeInflow": 15000,
      "exchangeOutflow": 12000,
      "transactionVolume": 25000000000,
      "supplyDistribution": {
        "whaleHoldings": {
          "percentage": 42.3,
          "addressCount": 850
        },
        "retailHoldings": {
          "percentage": 38.7,
          "addressCount": 42000000
        },
        "exchangeHoldings": {
          "percentage": 12.5,
          "addressCount": 150
        },
        "otherHoldings": {
          "percentage": 6.5,
          "addressCount": 120000
        }
      },
      "whaleHoldingsPercentage": 42.3,
      "retailHoldingsPercentage": 38.7,
      "exchangeHoldingsPercentage": 12.5
    },
    "technical": {
      "rsi": 58.5,
      "ma50": 112000,
      "ma200": 108000,
      "macd": 145.5,
      "macdSignal": null,
      "bollingerUpper": 122000,
      "bollingerLower": 111000,
      "bollingerMiddle": 116627
    },
    "derivatives": {
      "openInterest": 18500000000,
      "fundingRate": 0.0125,
      "liquidationVolume": 45000000,
      "putCallRatio": 0.85
    },
    "sentiment": {
      "fearGreedIndex": 50,
      "fearGreedClassification": "Neutral",
      "social": {
        "twitterSentiment": 0.5,
        "redditSentiment": 0.5,
        "socialVolume": 45000,
        "engagementRate": 0.085,
        "influencerSentiment": 0.75,
        "trendingScore": 75
      },
      "news": {
        "newsSentiment": 0.5,
        "newsVolume": 1250,
        "positiveNewsCount": 780,
        "negativeNewsCount": 320,
        "neutralNewsCount": 150,
        "sentimentScore": 0.5,
        "buzzScore": 75
      },
      "googleTrends": {
        "trendsScore": 75,
        "searchVolume": 850000,
        "trendingKeywords": [
          "bitcoin price",
          "btc news",
          "bitcoin mining"
        ],
        "regionalInterest": {
          "US": 85,
          "CN": 72,
          "EU": 68,
          "JP": 45,
          "KR": 52
        },
        "relatedQueries": [
          {
            "query": "bitcoin price today",
            "score": 95,
            "rising": true
          },
          {
            "query": "bitcoin prediction",
            "score": 78,
            "rising": true
          },
          {
            "query": "bitcoin mining",
            "score": 65,
            "rising": false
          }
        ],
        "trendDirection": "stable"
      }
    },
    "analysis": {
      "signal": "GIỮ",
      "confidence": 60,
      "reasoning": "Z.AI: Phân tích dựa trên dữ liệu thị trường hiện tại.... | ChatGPT: Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên q...",
      "riskLevel": "MEDIUM",
      "aiModel": "Z.AI+ChatGPT"
    },
    "timestamp": "2025-08-11T05:34:20.218Z",
    "dataSource": "database"
  },
  "tradingSignal": {
    "signal": "HOLD",
    "confidence": 50,
    "reasoning": "Tín hiệu trung lập: Không đủ điều kiện để MUA hoặc BÁN. Cần theo dõi thêm.",
    "riskLevel": "MEDIUM",
    "conditions": {
      "mvrv": 1.8,
      "fearGreed": 50,
      "fundingRate": 0.0125,
      "sopr": 1.02,
      "rsi": 58.5,
      "nupl": 0.65,
      "volumeTrend": "increasing",
      "extremeDetected": false
    },
    "triggers": []
  },
  "alerts": [],
  "coinId": "bitcoin"
}
🧪 [TEST] Console.log test - AI Analysis starting for bitcoin
🤖 Starting AI analysis for bitcoin...
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE (`main`.`analysis_history`.`coinId` = ? AND `main`.`analysis_history`.`analysisType` = ?) ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
🤖 Using cached AI analysis for bitcoin
💾 [1754890460621-3cq5c3cra] Using cached analysis for bitcoin (age: 58478ms)
✅ [1754890460621-3cq5c3cra] Completed AI_ENHANCED_ANALYSIS successfully (6ms)
🎯 [1754890460621-3cq5c3cra] Final result: {
  "recommendation": "GIỮ",
  "timeframe": "Ngắn hạn",
  "riskFactors": [
    "Thị trường biến động thông thường"
  ],
  "entryPoints": "Chờ tín hiệu rõ ràng hơn trước khi vào lệnh",
  "exitPoints": "Chốt lời khi có biến động giá mạnh hoặc đạt mục tiêu lợi nhuận",
  "stopLoss": "Quản lý rủi ro chặt chẽ, stop loss tại mức biến động chấp nhận được",
  "takeProfit": "Take profit khi đạt lợi nhuận mục tiêu hoặc có thay đổi xu hướng",
  "zaiAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn",
    "breakoutPotential": "LOW",
    "reasoning": "Phân tích dựa trên dữ liệu thị trường hiện tại."
  },
  "chatGPTAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn đến trung hạn (1-4 tuần)",
    "breakoutPotential": "LOW",
    "reasoning": "Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên quan sát và chờ đợi tín hiệu tốt hơn."
  }
}
 POST /api/ai-analysis?action=analyze&coinId=bitcoin 200 in 46ms
 GET / 200 in 64ms
 GET /favicon.ico 200 in 53ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT 1
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`isActive` = ? ORDER BY `main`.`cryptocurrencies`.`isDefault` DESC, `main`.`cryptocurrencies`.`rank` ASC, `main`.`cryptocurrencies`.`createdAt` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`coin_data_collection`.`id`, `main`.`coin_data_collection`.`cryptoId`, `main`.`coin_data_collection`.`status`, `main`.`coin_data_collection`.`lastCollected`, `main`.`coin_data_collection`.`nextCollection`, `main`.`coin_data_collection`.`errorCount`, `main`.`coin_data_collection`.`lastError`, `main`.`coin_data_collection`.`metadata` FROM `main`.`coin_data_collection` WHERE `main`.`coin_data_collection`.`cryptoId` IN (?,?,?,?,?) LIMIT ? OFFSET ?
 GET /api/cryptocurrencies?activeOnly=true 200 in 81ms
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE `main`.`analysis_history`.`cryptoId` = ? ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/dashboard?coinId=bitcoin 200 in 99ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/trading-signals-fast?action=signal&coinId=bitcoin 200 in 96ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/alerts-fast?action=process-data&coinId=bitcoin 200 in 108ms
🤖 [1754890466172-ulz683zh6] Starting AI analysis operation: AI_ENHANCED_ANALYSIS for bitcoin
📊 [1754890466172-ulz683zh6] Request data: {
  "marketData": {
    "price": {
      "usd": 117775,
      "usd_24h_change": 0.8618738474048199,
      "usd_24h_vol": 33776641957.26242,
      "usd_market_cap": 2343795976558.965
    },
    "onChain": {
      "mvrv": 1.8,
      "nupl": 0.65,
      "sopr": 1.02,
      "activeAddresses": 950000,
      "exchangeInflow": 15000,
      "exchangeOutflow": 12000,
      "transactionVolume": 25000000000,
      "supplyDistribution": {
        "whaleHoldings": {
          "percentage": 42.3,
          "addressCount": 850
        },
        "retailHoldings": {
          "percentage": 38.7,
          "addressCount": 42000000
        },
        "exchangeHoldings": {
          "percentage": 12.5,
          "addressCount": 150
        },
        "otherHoldings": {
          "percentage": 6.5,
          "addressCount": 120000
        }
      },
      "whaleHoldingsPercentage": 42.3,
      "retailHoldingsPercentage": 38.7,
      "exchangeHoldingsPercentage": 12.5
    },
    "technical": {
      "rsi": 58.5,
      "ma50": 112000,
      "ma200": 108000,
      "macd": 145.5,
      "macdSignal": null,
      "bollingerUpper": 122000,
      "bollingerLower": 111000,
      "bollingerMiddle": 116627
    },
    "derivatives": {
      "openInterest": 18500000000,
      "fundingRate": 0.0125,
      "liquidationVolume": 45000000,
      "putCallRatio": 0.85
    },
    "sentiment": {
      "fearGreedIndex": 50,
      "fearGreedClassification": "Neutral",
      "social": {
        "twitterSentiment": 0.5,
        "redditSentiment": 0.5,
        "socialVolume": 45000,
        "engagementRate": 0.085,
        "influencerSentiment": 0.75,
        "trendingScore": 75
      },
      "news": {
        "newsSentiment": 0.5,
        "newsVolume": 1250,
        "positiveNewsCount": 780,
        "negativeNewsCount": 320,
        "neutralNewsCount": 150,
        "sentimentScore": 0.5,
        "buzzScore": 75
      },
      "googleTrends": {
        "trendsScore": 75,
        "searchVolume": 850000,
        "trendingKeywords": [
          "bitcoin price",
          "btc news",
          "bitcoin mining"
        ],
        "regionalInterest": {
          "US": 85,
          "CN": 72,
          "EU": 68,
          "JP": 45,
          "KR": 52
        },
        "relatedQueries": [
          {
            "query": "bitcoin price today",
            "score": 95,
            "rising": true
          },
          {
            "query": "bitcoin prediction",
            "score": 78,
            "rising": true
          },
          {
            "query": "bitcoin mining",
            "score": 65,
            "rising": false
          }
        ],
        "trendDirection": "stable"
      }
    },
    "analysis": {
      "signal": "GIỮ",
      "confidence": 60,
      "reasoning": "Z.AI: Phân tích dựa trên dữ liệu thị trường hiện tại.... | ChatGPT: Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên q...",
      "riskLevel": "MEDIUM",
      "aiModel": "Z.AI+ChatGPT"
    },
    "timestamp": "2025-08-11T05:34:25.714Z",
    "dataSource": "database"
  },
  "tradingSignal": {
    "signal": "HOLD",
    "confidence": 50,
    "reasoning": "Tín hiệu trung lập: Không đủ điều kiện để MUA hoặc BÁN. Cần theo dõi thêm.",
    "riskLevel": "MEDIUM",
    "conditions": {
      "mvrv": 1.8,
      "fearGreed": 50,
      "fundingRate": 0.0125,
      "sopr": 1.02,
      "rsi": 58.5,
      "nupl": 0.65,
      "volumeTrend": "increasing",
      "extremeDetected": false
    },
    "triggers": []
  },
  "alerts": [],
  "coinId": "bitcoin"
}
🧪 [TEST] Console.log test - AI Analysis starting for bitcoin
🤖 Starting AI analysis for bitcoin...
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE (`main`.`analysis_history`.`coinId` = ? AND `main`.`analysis_history`.`analysisType` = ?) ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
🤖 Using cached AI analysis for bitcoin
💾 [1754890466172-ulz683zh6] Using cached analysis for bitcoin (age: 64028ms)
✅ [1754890466172-ulz683zh6] Completed AI_ENHANCED_ANALYSIS successfully (5ms)
🎯 [1754890466172-ulz683zh6] Final result: {
  "recommendation": "GIỮ",
  "timeframe": "Ngắn hạn",
  "riskFactors": [
    "Thị trường biến động thông thường"
  ],
  "entryPoints": "Chờ tín hiệu rõ ràng hơn trước khi vào lệnh",
  "exitPoints": "Chốt lời khi có biến động giá mạnh hoặc đạt mục tiêu lợi nhuận",
  "stopLoss": "Quản lý rủi ro chặt chẽ, stop loss tại mức biến động chấp nhận được",
  "takeProfit": "Take profit khi đạt lợi nhuận mục tiêu hoặc có thay đổi xu hướng",
  "zaiAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn",
    "breakoutPotential": "LOW",
    "reasoning": "Phân tích dựa trên dữ liệu thị trường hiện tại."
  },
  "chatGPTAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn đến trung hạn (1-4 tuần)",
    "breakoutPotential": "LOW",
    "reasoning": "Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên quan sát và chờ đợi tín hiệu tốt hơn."
  }
}
 POST /api/ai-analysis?action=analyze&coinId=bitcoin 200 in 50ms
 GET / 200 in 71ms
 GET /favicon.ico 200 in 41ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`isActive` = ? ORDER BY `main`.`cryptocurrencies`.`isDefault` DESC, `main`.`cryptocurrencies`.`rank` ASC, `main`.`cryptocurrencies`.`createdAt` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`coin_data_collection`.`id`, `main`.`coin_data_collection`.`cryptoId`, `main`.`coin_data_collection`.`status`, `main`.`coin_data_collection`.`lastCollected`, `main`.`coin_data_collection`.`nextCollection`, `main`.`coin_data_collection`.`errorCount`, `main`.`coin_data_collection`.`lastError`, `main`.`coin_data_collection`.`metadata` FROM `main`.`coin_data_collection` WHERE `main`.`coin_data_collection`.`cryptoId` IN (?,?,?,?,?) LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/cryptocurrencies?activeOnly=true 200 in 84ms
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE `main`.`analysis_history`.`cryptoId` = ? ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/dashboard?coinId=bitcoin 200 in 94ms
🤖 [1754890473037-0pzy6gi87] Starting AI analysis operation: AI_ENHANCED_ANALYSIS for solana
📊 [1754890473037-0pzy6gi87] Request data: {}
🧪 [TEST] Console.log test - AI Analysis starting for solana
🤖 Starting AI analysis for solana...
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE (`main`.`analysis_history`.`coinId` = ? AND `main`.`analysis_history`.`analysisType` = ?) ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET / 200 in 83ms
 GET /favicon.ico 200 in 42ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`isActive` = ? ORDER BY `main`.`cryptocurrencies`.`isDefault` DESC, `main`.`cryptocurrencies`.`rank` ASC, `main`.`cryptocurrencies`.`createdAt` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`coin_data_collection`.`id`, `main`.`coin_data_collection`.`cryptoId`, `main`.`coin_data_collection`.`status`, `main`.`coin_data_collection`.`lastCollected`, `main`.`coin_data_collection`.`nextCollection`, `main`.`coin_data_collection`.`errorCount`, `main`.`coin_data_collection`.`lastError`, `main`.`coin_data_collection`.`metadata` FROM `main`.`coin_data_collection` WHERE `main`.`coin_data_collection`.`cryptoId` IN (?,?,?,?,?) LIMIT ? OFFSET ?
 GET /api/cryptocurrencies?activeOnly=true 200 in 90ms
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE `main`.`analysis_history`.`cryptoId` = ? ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/dashboard?coinId=bitcoin 200 in 166ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/trading-signals-fast?action=signal&coinId=bitcoin 200 in 107ms
🤖 [AI Analysis] Generated prompt for solana:
📄 [Prompt Length]: 1619 characters
📝 [Prompt Preview]: PHÂN TÍCH THỊ TRƯỜNG SOLANA
========================================

DỮ LIỆU GIÁ:
- Giá hiện tại: $185.61
- Thay đổi 24h: 1.76%
- Khối lượng 24h: $6.3B
- Vốn hóa thị trường: $0.1T

CHỈ BÁO ON-CHAIN:
...
🤖 [Z.AI] Sending prompt for solana:
📝 [Z.AI] Prompt content:
PHÂN TÍCH THỊ TRƯỜNG SOLANA
========================================

DỮ LIỆU GIÁ:
- Giá hiện tại: $185.61
- Thay đổi 24h: 1.76%
- Khối lượng 24h: $6.3B
- Vốn hóa thị trường: $0.1T

CHỈ BÁO ON-CHAIN:
- MVRV Ratio: 1.60
- NUPL: 0.58
- SOPR: 1.05
- Địa chỉ hoạt động: 320,000

CHỈ BÁO KỸ THUẬT:
- RSI: 61.20 (Trung lập)
- MA50: $168
- MA200: $162
- MACD: 8.70

TÂM LÝ THỊ TRƯỜNG:
- Fear & Greed Index: 70 (Greed)

THỊ TRƯỜNG PHÁI SINH:
- Lãi suất Funding: 0.950%
- Open Interest: $1.8B

YÊU CẦU PHÂN TÍCH:
==================
Hãy cung cấp phân tích chi tiết và khuyến nghị đầu tư cho Solana dựa trên tất cả dữ liệu trên. Cân nhắc:

1. PHÂN TÍCH KỸ THUẬT:
   - Đánh giá động lượng và xu hướng dựa trên RSI, MACD
   - Phân tích vị trí giá so với đường trung bình động
   - Xem xét biến động và dải Bollinger

2. PHÂN TÍCH ON-CHAIN:
   - Đánh giá định giá dựa trên MVRV và NUPL
   - Phân tích hành vi của holder và mức lợi nhuận/thua lỗ

3. TÂM LÝ THỊ TRƯỜNG:
   - Diễn giải Fear & Greed Index trong bối cảnh giá hiện tại
   - Đánh giá tâm lý thị trường và các điểm cực đoan

4. QUẢN LÝ RỦI RO:
   - Xác định các yếu tố rủi ro chính
   - Đề xuất mức stop-loss và take-profit phù hợp

5. KHUYẾN NGHỊ ĐẦU TƯ:
   - Tín hiệu rõ ràng: MUA MẠNH, MUA, GIỮ, BÁN, BÁN MẠNH
   - Mức độ tin cậy (0-100)
   - Khung thời gian phân tích
   - Tiềm năng breakout (LOW/MEDIUM/HIGH)
   - Lý do chi tiết

Định dạng trả lời JSON:
{
  "recommendation": "MUA|BÁN|GIỮ|MUA MẠNH|BÁN MẠNH",
  "confidence": 0-100,
  "timeframe": "ví dụ: Ngắn hạn (1-2 tuần)",
  "breakoutPotential": "LOW|MEDIUM|HIGH",
  "reasoning": "lý do chi tiết bằng tiếng Việt"
}

💬 [Z.AI] Sending prompt to Z.AI:
📝 [Z.AI] Prompt content: PHÂN TÍCH THỊ TRƯỜNG SOLANA
========================================

DỮ LIỆU GIÁ:
- Giá hiện tại: $185.61
- Thay đổi 24h: 1.76%
- Khối lượng 24h: $6.3B
- Vốn hóa thị trường: $0.1T

CHỈ BÁO ON-CHAIN:
- MVRV Ratio: 1.60
- NUPL: 0.58
- SOPR: 1.05
- Địa chỉ hoạt động: 320,000

CHỈ BÁO KỸ THUẬT:
- RSI: 61.20 (Trung lập)
- MA50: $168
- MA200: $162
- MACD: 8.70

TÂM LÝ THỊ TRƯỜNG:
- Fear & Greed Index: 70 (Greed)

THỊ TRƯỜNG PHÁI SINH:
- Lãi suất Funding: 0.950%
- Open Interest: $1.8B

YÊU CẦU PHÂN TÍCH:
==================
Hãy cung cấp phân tích chi tiết và khuyến nghị đầu tư cho Solana dựa trên tất cả dữ liệu trên. Cân nhắc:

1. PHÂN TÍCH KỸ THUẬT:
   - Đánh giá động lượng và xu hướng dựa trên RSI, MACD
   - Phân tích vị trí giá so với đường trung bình động
   - Xem xét biến động và dải Bollinger

2. PHÂN TÍCH ON-CHAIN:
   - Đánh giá định giá dựa trên MVRV và NUPL
   - Phân tích hành vi của holder và mức lợi nhuận/thua lỗ

3. TÂM LÝ THỊ TRƯỜNG:
   - Diễn giải Fear & Greed Index trong bối cảnh giá hiện tại
   - Đánh giá tâm lý thị trường và các điểm cực đoan

4. QUẢN LÝ RỦI RO:
   - Xác định các yếu tố rủi ro chính
   - Đề xuất mức stop-loss và take-profit phù hợp

5. KHUYẾN NGHỊ ĐẦU TƯ:
   - Tín hiệu rõ ràng: MUA MẠNH, MUA, GIỮ, BÁN, BÁN MẠNH
   - Mức độ tin cậy (0-100)
   - Khung thời gian phân tích
   - Tiềm năng breakout (LOW/MEDIUM/HIGH)
   - Lý do chi tiết

Định dạng trả lời JSON:
{
  "recommendation": "MUA|BÁN|GIỮ|MUA MẠNH|BÁN MẠNH",
  "confidence": 0-100,
  "timeframe": "ví dụ: Ngắn hạn (1-2 tuần)",
  "breakoutPotential": "LOW|MEDIUM|HIGH",
  "reasoning": "lý do chi tiết bằng tiếng Việt"
}

prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/alerts-fast?action=process-data&coinId=bitcoin 200 in 88ms
🤖 [1754890475986-f87nbec1u] Starting AI analysis operation: AI_ENHANCED_ANALYSIS for bitcoin
📊 [1754890475986-f87nbec1u] Request data: {
  "marketData": {
    "price": {
      "usd": 117775,
      "usd_24h_change": 0.8618738474048199,
      "usd_24h_vol": 33776641957.26242,
      "usd_market_cap": 2343795976558.965
    },
    "onChain": {
      "mvrv": 1.8,
      "nupl": 0.65,
      "sopr": 1.02,
      "activeAddresses": 950000,
      "exchangeInflow": 15000,
      "exchangeOutflow": 12000,
      "transactionVolume": 25000000000,
      "supplyDistribution": {
        "whaleHoldings": {
          "percentage": 42.3,
          "addressCount": 850
        },
        "retailHoldings": {
          "percentage": 38.7,
          "addressCount": 42000000
        },
        "exchangeHoldings": {
          "percentage": 12.5,
          "addressCount": 150
        },
        "otherHoldings": {
          "percentage": 6.5,
          "addressCount": 120000
        }
      },
      "whaleHoldingsPercentage": 42.3,
      "retailHoldingsPercentage": 38.7,
      "exchangeHoldingsPercentage": 12.5
    },
    "technical": {
      "rsi": 58.5,
      "ma50": 112000,
      "ma200": 108000,
      "macd": 145.5,
      "macdSignal": null,
      "bollingerUpper": 122000,
      "bollingerLower": 111000,
      "bollingerMiddle": 116627
    },
    "derivatives": {
      "openInterest": 18500000000,
      "fundingRate": 0.0125,
      "liquidationVolume": 45000000,
      "putCallRatio": 0.85
    },
    "sentiment": {
      "fearGreedIndex": 50,
      "fearGreedClassification": "Neutral",
      "social": {
        "twitterSentiment": 0.5,
        "redditSentiment": 0.5,
        "socialVolume": 45000,
        "engagementRate": 0.085,
        "influencerSentiment": 0.75,
        "trendingScore": 75
      },
      "news": {
        "newsSentiment": 0.5,
        "newsVolume": 1250,
        "positiveNewsCount": 780,
        "negativeNewsCount": 320,
        "neutralNewsCount": 150,
        "sentimentScore": 0.5,
        "buzzScore": 75
      },
      "googleTrends": {
        "trendsScore": 75,
        "searchVolume": 850000,
        "trendingKeywords": [
          "bitcoin price",
          "btc news",
          "bitcoin mining"
        ],
        "regionalInterest": {
          "US": 85,
          "CN": 72,
          "EU": 68,
          "JP": 45,
          "KR": 52
        },
        "relatedQueries": [
          {
            "query": "bitcoin price today",
            "score": 95,
            "rising": true
          },
          {
            "query": "bitcoin prediction",
            "score": 78,
            "rising": true
          },
          {
            "query": "bitcoin mining",
            "score": 65,
            "rising": false
          }
        ],
        "trendDirection": "stable"
      }
    },
    "analysis": {
      "signal": "GIỮ",
      "confidence": 60,
      "reasoning": "Z.AI: Phân tích dựa trên dữ liệu thị trường hiện tại.... | ChatGPT: Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên q...",
      "riskLevel": "MEDIUM",
      "aiModel": "Z.AI+ChatGPT"
    },
    "timestamp": "2025-08-11T05:34:35.513Z",
    "dataSource": "database"
  },
  "tradingSignal": {
    "signal": "HOLD",
    "confidence": 50,
    "reasoning": "Tín hiệu trung lập: Không đủ điều kiện để MUA hoặc BÁN. Cần theo dõi thêm.",
    "riskLevel": "MEDIUM",
    "conditions": {
      "mvrv": 1.8,
      "fearGreed": 50,
      "fundingRate": 0.0125,
      "sopr": 1.02,
      "rsi": 58.5,
      "nupl": 0.65,
      "volumeTrend": "increasing",
      "extremeDetected": false
    },
    "triggers": []
  },
  "alerts": [],
  "coinId": "bitcoin"
}
🧪 [TEST] Console.log test - AI Analysis starting for bitcoin
🤖 Starting AI analysis for bitcoin...
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE (`main`.`analysis_history`.`coinId` = ? AND `main`.`analysis_history`.`analysisType` = ?) ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
🤖 Using cached AI analysis for bitcoin
💾 [1754890475986-f87nbec1u] Using cached analysis for bitcoin (age: 73849ms)
✅ [1754890475986-f87nbec1u] Completed AI_ENHANCED_ANALYSIS successfully (12ms)
🎯 [1754890475986-f87nbec1u] Final result: {
  "recommendation": "GIỮ",
  "timeframe": "Ngắn hạn",
  "riskFactors": [
    "Thị trường biến động thông thường"
  ],
  "entryPoints": "Chờ tín hiệu rõ ràng hơn trước khi vào lệnh",
  "exitPoints": "Chốt lời khi có biến động giá mạnh hoặc đạt mục tiêu lợi nhuận",
  "stopLoss": "Quản lý rủi ro chặt chẽ, stop loss tại mức biến động chấp nhận được",
  "takeProfit": "Take profit khi đạt lợi nhuận mục tiêu hoặc có thay đổi xu hướng",
  "zaiAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn",
    "breakoutPotential": "LOW",
    "reasoning": "Phân tích dựa trên dữ liệu thị trường hiện tại."
  },
  "chatGPTAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn đến trung hạn (1-4 tuần)",
    "breakoutPotential": "LOW",
    "reasoning": "Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên quan sát và chờ đợi tín hiệu tốt hơn."
  }
}
 POST /api/ai-analysis?action=analyze&coinId=bitcoin 200 in 74ms
Failed to make API request: TypeError: fetch failed
    at async generateEnhancedAIAnalysis (src/app/api/ai-analysis/route.ts:343:27)
    at async performAIAnalysis (src/app/api/ai-analysis/route.ts:179:29)
    at async POST (src/app/api/ai-analysis/route.ts:55:13)
  341 |       
  342 |       try {
> 343 |         const completion = await zai.chat.completions.create({
      |                           ^
  344 |           messages: [
  345 |             {
  346 |               role: 'system', {
  [cause]: [Error: getaddrinfo ENOTFOUND api.z-ai.dev] {
    errno: -3008,
    code: 'ENOTFOUND',
    syscall: 'getaddrinfo',
    hostname: 'api.z-ai.dev'
  }
}
Z.AI analysis failed, using fallback: fetch failed
🤖 [Z.AI] Received response from Z.AI (273ms):
📋 [Z.AI] Response: {
  "error": "fetch failed"
}
🤖 [ChatGPT] Using rule-based analysis for solana (ChatGPT API not configured)
📋 [ChatGPT] Rule-based result: GIỮ (60% confidence)
🤖 [ChatGPT] Received response from ChatGPT (0ms):
📋 [ChatGPT] Response: {
  "recommendation": "GIỮ",
  "confidence": 60,
  "timeframe": "Ngắn hạn đến trung hạn (1-4 tuần)",
  "breakoutPotential": "LOW",
  "reasoning": "Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên quan sát và chờ đợi tín hiệu tốt hơn."
}
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query INSERT INTO `main`.`analysis_history` (`id`, `cryptoId`, `coinId`, `signal`, `confidence`, `reasoning`, `riskLevel`, `aiModel`, `analysisType`, `analysisData`, `timestamp`) VALUES (?,?,?,?,?,?,?,?,?,?,?) RETURNING `id` AS `id`, `cryptoId` AS `cryptoId`, `coinId` AS `coinId`, `signal` AS `signal`, `confidence` AS `confidence`, `reasoning` AS `reasoning`, `riskLevel` AS `riskLevel`, `aiModel` AS `aiModel`, `analysisType` AS `analysisType`, `analysisData` AS `analysisData`, `metricsData` AS `metricsData`, `timestamp` AS `timestamp`
✅ AI analysis saved to database for solana
💿 [1754890473037-0pzy6gi87] Database save_analysis successful: {
  "cryptoId": "cme59qgw80009pe497umtcjfu",
  "coinId": "solana",
  "analysisType": "AI_ENHANCED",
  "analysisData": "{\"recommendation\":\"GIỮ\",\"timeframe\":\"Ngắn hạn\",\"riskFactors\":[\"Thị trường biến động thông thường\"],\"entryPoints\":\"Chờ tín hiệu rõ ràng hơn trước khi vào lệnh\",\"exitPoints\":\"Chốt lời khi có biến động giá mạnh hoặc đạt mục tiêu lợi nhuận\",\"stopLoss\":\"Quản lý rủi ro chặt chẽ, stop loss tại mức biến động chấp nhận được\",\"takeProfit\":\"Take profit khi đạt lợi nhuận mục tiêu hoặc có thay đổi xu hướng\",\"zaiAnalysis\":{\"recommendation\":\"GIỮ\",\"confidence\":60,\"timeframe\":\"Ngắn hạn\",\"breakoutPotential\":\"LOW\",\"reasoning\":\"Phân tích dựa trên dữ liệu thị trường hiện tại.\"},\"chatGPTAnalysis\":{\"recommendation\":\"GIỮ\",\"confidence\":60,\"timeframe\":\"Ngắn hạn đến trung hạn (1-4 tuần)\",\"breakoutPotential\":\"LOW\",\"reasoning\":\"Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên quan sát và chờ đợi tín hiệu tốt hơn.\"}}",
  "signal": "GIỮ",
  "confidence": 60,
  "reasoning": "Z.AI: Phân tích dựa trên dữ liệu thị trường hiện tại.... | ChatGPT: Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên q...",
  "riskLevel": "MEDIUM",
  "aiModel": "Z.AI+ChatGPT"
}
✅ [5:34:36 AM] AI_ENHANCED_ANALYSIS - solana (3148ms)
   Metadata: {
  analysisType: 'AI_ENHANCED',
  marketDataPoints: 6,
  alertsCount: 0,
  cacheUsed: false,
  aiModelsUsed: [ 'Z.AI', 'ChatGPT' ]
}
✅ [1754890473037-0pzy6gi87] Completed AI_ENHANCED_ANALYSIS successfully (3148ms)
🎯 [1754890473037-0pzy6gi87] Final result: {
  "recommendation": "GIỮ",
  "timeframe": "Ngắn hạn",
  "riskFactors": [
    "Thị trường biến động thông thường"
  ],
  "entryPoints": "Chờ tín hiệu rõ ràng hơn trước khi vào lệnh",
  "exitPoints": "Chốt lời khi có biến động giá mạnh hoặc đạt mục tiêu lợi nhuận",
  "stopLoss": "Quản lý rủi ro chặt chẽ, stop loss tại mức biến động chấp nhận được",
  "takeProfit": "Take profit khi đạt lợi nhuận mục tiêu hoặc có thay đổi xu hướng",
  "zaiAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn",
    "breakoutPotential": "LOW",
    "reasoning": "Phân tích dựa trên dữ liệu thị trường hiện tại."
  },
  "chatGPTAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn đến trung hạn (1-4 tuần)",
    "breakoutPotential": "LOW",
    "reasoning": "Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên quan sát và chờ đợi tín hiệu tốt hơn."
  }
}
 POST /api/ai-analysis?action=analyze&coinId=solana 200 in 3200ms
 GET / 200 in 110ms
 GET /favicon.ico 200 in 58ms
 GET /favicon.ico 200 in 51ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`isActive` = ? ORDER BY `main`.`cryptocurrencies`.`isDefault` DESC, `main`.`cryptocurrencies`.`rank` ASC, `main`.`cryptocurrencies`.`createdAt` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`coin_data_collection`.`id`, `main`.`coin_data_collection`.`cryptoId`, `main`.`coin_data_collection`.`status`, `main`.`coin_data_collection`.`lastCollected`, `main`.`coin_data_collection`.`nextCollection`, `main`.`coin_data_collection`.`errorCount`, `main`.`coin_data_collection`.`lastError`, `main`.`coin_data_collection`.`metadata` FROM `main`.`coin_data_collection` WHERE `main`.`coin_data_collection`.`cryptoId` IN (?,?,?,?,?) LIMIT ? OFFSET ?
 GET /api/cryptocurrencies?activeOnly=true 200 in 120ms
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE `main`.`analysis_history`.`cryptoId` = ? ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/dashboard?coinId=bitcoin 200 in 196ms
prisma:query SELECT 1
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/trading-signals-fast?action=signal&coinId=bitcoin 200 in 83ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET / 200 in 64ms
 GET /favicon.ico 200 in 97ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT 1
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`isActive` = ? ORDER BY `main`.`cryptocurrencies`.`isDefault` DESC, `main`.`cryptocurrencies`.`rank` ASC, `main`.`cryptocurrencies`.`createdAt` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE `main`.`analysis_history`.`cryptoId` = ? ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/dashboard?coinId=bitcoin 200 in 78ms
prisma:query SELECT `main`.`coin_data_collection`.`id`, `main`.`coin_data_collection`.`cryptoId`, `main`.`coin_data_collection`.`status`, `main`.`coin_data_collection`.`lastCollected`, `main`.`coin_data_collection`.`nextCollection`, `main`.`coin_data_collection`.`errorCount`, `main`.`coin_data_collection`.`lastError`, `main`.`coin_data_collection`.`metadata` FROM `main`.`coin_data_collection` WHERE `main`.`coin_data_collection`.`cryptoId` IN (?,?,?,?,?) LIMIT ? OFFSET ?
 GET /api/cryptocurrencies?activeOnly=true 200 in 99ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/trading-signals-fast?action=signal&coinId=bitcoin 200 in 77ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/alerts-fast?action=process-data&coinId=bitcoin 200 in 70ms
🤖 [1754890495245-i3a1roxoz] Starting AI analysis operation: AI_ENHANCED_ANALYSIS for bitcoin
📊 [1754890495245-i3a1roxoz] Request data: {
  "marketData": {
    "price": {
      "usd": 117775,
      "usd_24h_change": 0.8618738474048199,
      "usd_24h_vol": 33776641957.26242,
      "usd_market_cap": 2343795976558.965
    },
    "onChain": {
      "mvrv": 1.8,
      "nupl": 0.65,
      "sopr": 1.02,
      "activeAddresses": 950000,
      "exchangeInflow": 15000,
      "exchangeOutflow": 12000,
      "transactionVolume": 25000000000,
      "supplyDistribution": {
        "whaleHoldings": {
          "percentage": 42.3,
          "addressCount": 850
        },
        "retailHoldings": {
          "percentage": 38.7,
          "addressCount": 42000000
        },
        "exchangeHoldings": {
          "percentage": 12.5,
          "addressCount": 150
        },
        "otherHoldings": {
          "percentage": 6.5,
          "addressCount": 120000
        }
      },
      "whaleHoldingsPercentage": 42.3,
      "retailHoldingsPercentage": 38.7,
      "exchangeHoldingsPercentage": 12.5
    },
    "technical": {
      "rsi": 58.5,
      "ma50": 112000,
      "ma200": 108000,
      "macd": 145.5,
      "macdSignal": null,
      "bollingerUpper": 122000,
      "bollingerLower": 111000,
      "bollingerMiddle": 116627
    },
    "derivatives": {
      "openInterest": 18500000000,
      "fundingRate": 0.0125,
      "liquidationVolume": 45000000,
      "putCallRatio": 0.85
    },
    "sentiment": {
      "fearGreedIndex": 50,
      "fearGreedClassification": "Neutral",
      "social": {
        "twitterSentiment": 0.5,
        "redditSentiment": 0.5,
        "socialVolume": 45000,
        "engagementRate": 0.085,
        "influencerSentiment": 0.75,
        "trendingScore": 75
      },
      "news": {
        "newsSentiment": 0.5,
        "newsVolume": 1250,
        "positiveNewsCount": 780,
        "negativeNewsCount": 320,
        "neutralNewsCount": 150,
        "sentimentScore": 0.5,
        "buzzScore": 75
      },
      "googleTrends": {
        "trendsScore": 75,
        "searchVolume": 850000,
        "trendingKeywords": [
          "bitcoin price",
          "btc news",
          "bitcoin mining"
        ],
        "regionalInterest": {
          "US": 85,
          "CN": 72,
          "EU": 68,
          "JP": 45,
          "KR": 52
        },
        "relatedQueries": [
          {
            "query": "bitcoin price today",
            "score": 95,
            "rising": true
          },
          {
            "query": "bitcoin prediction",
            "score": 78,
            "rising": true
          },
          {
            "query": "bitcoin mining",
            "score": 65,
            "rising": false
          }
        ],
        "trendDirection": "stable"
      }
    },
    "analysis": {
      "signal": "GIỮ",
      "confidence": 60,
      "reasoning": "Z.AI: Phân tích dựa trên dữ liệu thị trường hiện tại.... | ChatGPT: Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên q...",
      "riskLevel": "MEDIUM",
      "aiModel": "Z.AI+ChatGPT"
    },
    "timestamp": "2025-08-11T05:34:51.866Z",
    "dataSource": "database"
  },
  "tradingSignal": {
    "signal": "HOLD",
    "confidence": 50,
    "reasoning": "Tín hiệu trung lập: Không đủ điều kiện để MUA hoặc BÁN. Cần theo dõi thêm.",
    "riskLevel": "MEDIUM",
    "conditions": {
      "mvrv": 1.8,
      "fearGreed": 50,
      "fundingRate": 0.0125,
      "sopr": 1.02,
      "rsi": 58.5,
      "nupl": 0.65,
      "volumeTrend": "increasing",
      "extremeDetected": false
    },
    "triggers": []
  },
  "alerts": [],
  "coinId": "bitcoin"
}
🧪 [TEST] Console.log test - AI Analysis starting for bitcoin
🤖 Starting AI analysis for bitcoin...
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE (`main`.`analysis_history`.`coinId` = ? AND `main`.`analysis_history`.`analysisType` = ?) ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
🤖 Using cached AI analysis for bitcoin
💾 [1754890495245-i3a1roxoz] Using cached analysis for bitcoin (age: 93107ms)
✅ [1754890495245-i3a1roxoz] Completed AI_ENHANCED_ANALYSIS successfully (11ms)
🎯 [1754890495245-i3a1roxoz] Final result: {
  "recommendation": "GIỮ",
  "timeframe": "Ngắn hạn",
  "riskFactors": [
    "Thị trường biến động thông thường"
  ],
  "entryPoints": "Chờ tín hiệu rõ ràng hơn trước khi vào lệnh",
  "exitPoints": "Chốt lời khi có biến động giá mạnh hoặc đạt mục tiêu lợi nhuận",
  "stopLoss": "Quản lý rủi ro chặt chẽ, stop loss tại mức biến động chấp nhận được",
  "takeProfit": "Take profit khi đạt lợi nhuận mục tiêu hoặc có thay đổi xu hướng",
  "zaiAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn",
    "breakoutPotential": "LOW",
    "reasoning": "Phân tích dựa trên dữ liệu thị trường hiện tại."
  },
  "chatGPTAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn đến trung hạn (1-4 tuần)",
    "breakoutPotential": "LOW",
    "reasoning": "Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên quan sát và chờ đợi tín hiệu tốt hơn."
  }
}
 POST /api/ai-analysis?action=analyze&coinId=bitcoin 200 in 52ms
 GET / 200 in 60ms
 GET /favicon.ico 200 in 43ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE `main`.`analysis_history`.`cryptoId` = ? ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/dashboard?coinId=bitcoin 200 in 71ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`isActive` = ? ORDER BY `main`.`cryptocurrencies`.`isDefault` DESC, `main`.`cryptocurrencies`.`rank` ASC, `main`.`cryptocurrencies`.`createdAt` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`coin_data_collection`.`id`, `main`.`coin_data_collection`.`cryptoId`, `main`.`coin_data_collection`.`status`, `main`.`coin_data_collection`.`lastCollected`, `main`.`coin_data_collection`.`nextCollection`, `main`.`coin_data_collection`.`errorCount`, `main`.`coin_data_collection`.`lastError`, `main`.`coin_data_collection`.`metadata` FROM `main`.`coin_data_collection` WHERE `main`.`coin_data_collection`.`cryptoId` IN (?,?,?,?,?) LIMIT ? OFFSET ?
 GET /api/cryptocurrencies?activeOnly=true 200 in 49ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/trading-signals-fast?action=signal&coinId=bitcoin 200 in 86ms
 GET /api/alerts-fast?action=process-data&coinId=bitcoin 200 in 19ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET / 200 in 63ms
 GET /favicon.ico 200 in 45ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`isActive` = ? ORDER BY `main`.`cryptocurrencies`.`isDefault` DESC, `main`.`cryptocurrencies`.`rank` ASC, `main`.`cryptocurrencies`.`createdAt` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`coin_data_collection`.`id`, `main`.`coin_data_collection`.`cryptoId`, `main`.`coin_data_collection`.`status`, `main`.`coin_data_collection`.`lastCollected`, `main`.`coin_data_collection`.`nextCollection`, `main`.`coin_data_collection`.`errorCount`, `main`.`coin_data_collection`.`lastError`, `main`.`coin_data_collection`.`metadata` FROM `main`.`coin_data_collection` WHERE `main`.`coin_data_collection`.`cryptoId` IN (?,?,?,?,?) LIMIT ? OFFSET ?
 GET /api/cryptocurrencies?activeOnly=true 200 in 68ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE `main`.`analysis_history`.`cryptoId` = ? ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/dashboard?coinId=bitcoin 200 in 126ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/trading-signals-fast?action=signal&coinId=bitcoin 200 in 72ms
 GET / 200 in 64ms
 GET / 200 in 59ms
 GET /favicon.ico 200 in 41ms
prisma:query SELECT 1
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT 1
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`isActive` = ? ORDER BY `main`.`cryptocurrencies`.`isDefault` DESC, `main`.`cryptocurrencies`.`rank` ASC, `main`.`cryptocurrencies`.`createdAt` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`coin_data_collection`.`id`, `main`.`coin_data_collection`.`cryptoId`, `main`.`coin_data_collection`.`status`, `main`.`coin_data_collection`.`lastCollected`, `main`.`coin_data_collection`.`nextCollection`, `main`.`coin_data_collection`.`errorCount`, `main`.`coin_data_collection`.`lastError`, `main`.`coin_data_collection`.`metadata` FROM `main`.`coin_data_collection` WHERE `main`.`coin_data_collection`.`cryptoId` IN (?,?,?,?,?) LIMIT ? OFFSET ?
 GET /api/cryptocurrencies?activeOnly=true 200 in 76ms
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE `main`.`analysis_history`.`cryptoId` = ? ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/dashboard?coinId=bitcoin 200 in 95ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/trading-signals-fast?action=signal&coinId=bitcoin 200 in 80ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/alerts-fast?action=process-data&coinId=bitcoin 200 in 69ms
Error in AI analysis API: SyntaxError: Unexpected end of JSON input
    at JSON.parse (<anonymous>)
    at POST (src/app/api/ai-analysis/route.ts:52:31)
  50 |     const action = searchParams.get('action')
  51 |     const coinId = searchParams.get('coinId') || 'bitcoin'
> 52 |     const body = await request.json()
     |                               ^
  53 |
  54 |     if (action === 'analyze') {
  55 |       return await performAIAnalysis(coinId, body)
 GET / 200 in 58ms
 GET /favicon.ico 200 in 59ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`isActive` = ? ORDER BY `main`.`cryptocurrencies`.`isDefault` DESC, `main`.`cryptocurrencies`.`rank` ASC, `main`.`cryptocurrencies`.`createdAt` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`coin_data_collection`.`id`, `main`.`coin_data_collection`.`cryptoId`, `main`.`coin_data_collection`.`status`, `main`.`coin_data_collection`.`lastCollected`, `main`.`coin_data_collection`.`nextCollection`, `main`.`coin_data_collection`.`errorCount`, `main`.`coin_data_collection`.`lastError`, `main`.`coin_data_collection`.`metadata` FROM `main`.`coin_data_collection` WHERE `main`.`coin_data_collection`.`cryptoId` IN (?,?,?,?,?) LIMIT ? OFFSET ?
 GET /api/cryptocurrencies?activeOnly=true 200 in 152ms
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE `main`.`analysis_history`.`cryptoId` = ? ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/dashboard?coinId=bitcoin 200 in 162ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/trading-signals-fast?action=signal&coinId=bitcoin 200 in 112ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/alerts-fast?action=process-data&coinId=bitcoin 200 in 89ms
🤖 [1754890519416-vy0unxm6t] Starting AI analysis operation: AI_ENHANCED_ANALYSIS for bitcoin
📊 [1754890519416-vy0unxm6t] Request data: {
  "marketData": {
    "price": {
      "usd": 117775,
      "usd_24h_change": 0.8618738474048199,
      "usd_24h_vol": 33776641957.26242,
      "usd_market_cap": 2343795976558.965
    },
    "onChain": {
      "mvrv": 1.8,
      "nupl": 0.65,
      "sopr": 1.02,
      "activeAddresses": 950000,
      "exchangeInflow": 15000,
      "exchangeOutflow": 12000,
      "transactionVolume": 25000000000,
      "supplyDistribution": {
        "whaleHoldings": {
          "percentage": 42.3,
          "addressCount": 850
        },
        "retailHoldings": {
          "percentage": 38.7,
          "addressCount": 42000000
        },
        "exchangeHoldings": {
          "percentage": 12.5,
          "addressCount": 150
        },
        "otherHoldings": {
          "percentage": 6.5,
          "addressCount": 120000
        }
      },
      "whaleHoldingsPercentage": 42.3,
      "retailHoldingsPercentage": 38.7,
      "exchangeHoldingsPercentage": 12.5
    },
    "technical": {
      "rsi": 58.5,
      "ma50": 112000,
      "ma200": 108000,
      "macd": 145.5,
      "macdSignal": null,
      "bollingerUpper": 122000,
      "bollingerLower": 111000,
      "bollingerMiddle": 116627
    },
    "derivatives": {
      "openInterest": 18500000000,
      "fundingRate": 0.0125,
      "liquidationVolume": 45000000,
      "putCallRatio": 0.85
    },
    "sentiment": {
      "fearGreedIndex": 50,
      "fearGreedClassification": "Neutral",
      "social": {
        "twitterSentiment": 0.5,
        "redditSentiment": 0.5,
        "socialVolume": 45000,
        "engagementRate": 0.085,
        "influencerSentiment": 0.75,
        "trendingScore": 75
      },
      "news": {
        "newsSentiment": 0.5,
        "newsVolume": 1250,
        "positiveNewsCount": 780,
        "negativeNewsCount": 320,
        "neutralNewsCount": 150,
        "sentimentScore": 0.5,
        "buzzScore": 75
      },
      "googleTrends": {
        "trendsScore": 75,
        "searchVolume": 850000,
        "trendingKeywords": [
          "bitcoin price",
          "btc news",
          "bitcoin mining"
        ],
        "regionalInterest": {
          "US": 85,
          "CN": 72,
          "EU": 68,
          "JP": 45,
          "KR": 52
        },
        "relatedQueries": [
          {
            "query": "bitcoin price today",
            "score": 95,
            "rising": true
          },
          {
            "query": "bitcoin prediction",
            "score": 78,
            "rising": true
          },
          {
            "query": "bitcoin mining",
            "score": 65,
            "rising": false
          }
        ],
        "trendDirection": "stable"
      }
    },
    "analysis": {
      "signal": "GIỮ",
      "confidence": 60,
      "reasoning": "Z.AI: Phân tích dựa trên dữ liệu thị trường hiện tại.... | ChatGPT: Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên q...",
      "riskLevel": "MEDIUM",
      "aiModel": "Z.AI+ChatGPT"
    },
    "timestamp": "2025-08-11T05:35:17.047Z",
    "dataSource": "database"
  },
  "tradingSignal": {
    "signal": "HOLD",
    "confidence": 50,
    "reasoning": "Tín hiệu trung lập: Không đủ điều kiện để MUA hoặc BÁN. Cần theo dõi thêm.",
    "riskLevel": "MEDIUM",
    "conditions": {
      "mvrv": 1.8,
      "fearGreed": 50,
      "fundingRate": 0.0125,
      "sopr": 1.02,
      "rsi": 58.5,
      "nupl": 0.65,
      "volumeTrend": "increasing",
      "extremeDetected": false
    },
    "triggers": []
  },
  "alerts": [],
  "coinId": "bitcoin"
}
🧪 [TEST] Console.log test - AI Analysis starting for bitcoin
🤖 Starting AI analysis for bitcoin...
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE (`main`.`analysis_history`.`coinId` = ? AND `main`.`analysis_history`.`analysisType` = ?) ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
🤖 Using cached AI analysis for bitcoin
💾 [1754890519416-vy0unxm6t] Using cached analysis for bitcoin (age: 117277ms)
✅ [1754890519416-vy0unxm6t] Completed AI_ENHANCED_ANALYSIS successfully (10ms)
🎯 [1754890519416-vy0unxm6t] Final result: {
  "recommendation": "GIỮ",
  "timeframe": "Ngắn hạn",
  "riskFactors": [
    "Thị trường biến động thông thường"
  ],
  "entryPoints": "Chờ tín hiệu rõ ràng hơn trước khi vào lệnh",
  "exitPoints": "Chốt lời khi có biến động giá mạnh hoặc đạt mục tiêu lợi nhuận",
  "stopLoss": "Quản lý rủi ro chặt chẽ, stop loss tại mức biến động chấp nhận được",
  "takeProfit": "Take profit khi đạt lợi nhuận mục tiêu hoặc có thay đổi xu hướng",
  "zaiAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn",
    "breakoutPotential": "LOW",
    "reasoning": "Phân tích dựa trên dữ liệu thị trường hiện tại."
  },
  "chatGPTAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn đến trung hạn (1-4 tuần)",
    "breakoutPotential": "LOW",
    "reasoning": "Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên quan sát và chờ đợi tín hiệu tốt hơn."
  }
}
 POST /api/ai-analysis?action=analyze&coinId=bitcoin 200 in 74ms
 GET / 200 in 1296ms
 GET /favicon.ico 200 in 73ms
 GET / 200 in 69ms
 GET /favicon.ico 200 in 44ms
prisma:query SELECT 1
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`isActive` = ? ORDER BY `main`.`cryptocurrencies`.`isDefault` DESC, `main`.`cryptocurrencies`.`rank` ASC, `main`.`cryptocurrencies`.`createdAt` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`coin_data_collection`.`id`, `main`.`coin_data_collection`.`cryptoId`, `main`.`coin_data_collection`.`status`, `main`.`coin_data_collection`.`lastCollected`, `main`.`coin_data_collection`.`nextCollection`, `main`.`coin_data_collection`.`errorCount`, `main`.`coin_data_collection`.`lastError`, `main`.`coin_data_collection`.`metadata` FROM `main`.`coin_data_collection` WHERE `main`.`coin_data_collection`.`cryptoId` IN (?,?,?,?,?) LIMIT ? OFFSET ?
 GET /api/cryptocurrencies?activeOnly=true 200 in 57ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE `main`.`analysis_history`.`cryptoId` = ? ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/dashboard?coinId=bitcoin 200 in 102ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/trading-signals-fast?action=signal&coinId=bitcoin 200 in 79ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET / 200 in 83ms
 GET /favicon.ico 200 in 51ms
 GET / 200 in 64ms
 GET /favicon.ico 200 in 44ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`isActive` = ? ORDER BY `main`.`cryptocurrencies`.`isDefault` DESC, `main`.`cryptocurrencies`.`rank` ASC, `main`.`cryptocurrencies`.`createdAt` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`coin_data_collection`.`id`, `main`.`coin_data_collection`.`cryptoId`, `main`.`coin_data_collection`.`status`, `main`.`coin_data_collection`.`lastCollected`, `main`.`coin_data_collection`.`nextCollection`, `main`.`coin_data_collection`.`errorCount`, `main`.`coin_data_collection`.`lastError`, `main`.`coin_data_collection`.`metadata` FROM `main`.`coin_data_collection` WHERE `main`.`coin_data_collection`.`cryptoId` IN (?,?,?,?,?) LIMIT ? OFFSET ?
 GET /api/cryptocurrencies?activeOnly=true 200 in 63ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE `main`.`analysis_history`.`cryptoId` = ? ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/dashboard?coinId=bitcoin 200 in 102ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT 1
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/trading-signals-fast?action=signal&coinId=bitcoin 200 in 73ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/alerts-fast?action=process-data&coinId=bitcoin 200 in 66ms
🤖 [1754890556715-n3oqaqw7v] Starting AI analysis operation: AI_ENHANCED_ANALYSIS for bitcoin
📊 [1754890556715-n3oqaqw7v] Request data: {
  "marketData": {
    "price": {
      "usd": 117775,
      "usd_24h_change": 0.8618738474048199,
      "usd_24h_vol": 33776641957.26242,
      "usd_market_cap": 2343795976558.965
    },
    "onChain": {
      "mvrv": 1.8,
      "nupl": 0.65,
      "sopr": 1.02,
      "activeAddresses": 950000,
      "exchangeInflow": 15000,
      "exchangeOutflow": 12000,
      "transactionVolume": 25000000000,
      "supplyDistribution": {
        "whaleHoldings": {
          "percentage": 42.3,
          "addressCount": 850
        },
        "retailHoldings": {
          "percentage": 38.7,
          "addressCount": 42000000
        },
        "exchangeHoldings": {
          "percentage": 12.5,
          "addressCount": 150
        },
        "otherHoldings": {
          "percentage": 6.5,
          "addressCount": 120000
        }
      },
      "whaleHoldingsPercentage": 42.3,
      "retailHoldingsPercentage": 38.7,
      "exchangeHoldingsPercentage": 12.5
    },
    "technical": {
      "rsi": 58.5,
      "ma50": 112000,
      "ma200": 108000,
      "macd": 145.5,
      "macdSignal": null,
      "bollingerUpper": 122000,
      "bollingerLower": 111000,
      "bollingerMiddle": 116627
    },
    "derivatives": {
      "openInterest": 18500000000,
      "fundingRate": 0.0125,
      "liquidationVolume": 45000000,
      "putCallRatio": 0.85
    },
    "sentiment": {
      "fearGreedIndex": 50,
      "fearGreedClassification": "Neutral",
      "social": {
        "twitterSentiment": 0.5,
        "redditSentiment": 0.5,
        "socialVolume": 45000,
        "engagementRate": 0.085,
        "influencerSentiment": 0.75,
        "trendingScore": 75
      },
      "news": {
        "newsSentiment": 0.5,
        "newsVolume": 1250,
        "positiveNewsCount": 780,
        "negativeNewsCount": 320,
        "neutralNewsCount": 150,
        "sentimentScore": 0.5,
        "buzzScore": 75
      },
      "googleTrends": {
        "trendsScore": 75,
        "searchVolume": 850000,
        "trendingKeywords": [
          "bitcoin price",
          "btc news",
          "bitcoin mining"
        ],
        "regionalInterest": {
          "US": 85,
          "CN": 72,
          "EU": 68,
          "JP": 45,
          "KR": 52
        },
        "relatedQueries": [
          {
            "query": "bitcoin price today",
            "score": 95,
            "rising": true
          },
          {
            "query": "bitcoin prediction",
            "score": 78,
            "rising": true
          },
          {
            "query": "bitcoin mining",
            "score": 65,
            "rising": false
          }
        ],
        "trendDirection": "stable"
      }
    },
    "analysis": {
      "signal": "GIỮ",
      "confidence": 60,
      "reasoning": "Z.AI: Phân tích dựa trên dữ liệu thị trường hiện tại.... | ChatGPT: Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên q...",
      "riskLevel": "MEDIUM",
      "aiModel": "Z.AI+ChatGPT"
    },
    "timestamp": "2025-08-11T05:35:52.626Z",
    "dataSource": "database"
  },
  "tradingSignal": {
    "signal": "HOLD",
    "confidence": 50,
    "reasoning": "Tín hiệu trung lập: Không đủ điều kiện để MUA hoặc BÁN. Cần theo dõi thêm.",
    "riskLevel": "MEDIUM",
    "conditions": {
      "mvrv": 1.8,
      "fearGreed": 50,
      "fundingRate": 0.0125,
      "sopr": 1.02,
      "rsi": 58.5,
      "nupl": 0.65,
      "volumeTrend": "increasing",
      "extremeDetected": false
    },
    "triggers": []
  },
  "alerts": [],
  "coinId": "bitcoin"
}
🧪 [TEST] Console.log test - AI Analysis starting for bitcoin
🤖 Starting AI analysis for bitcoin...
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE (`main`.`analysis_history`.`coinId` = ? AND `main`.`analysis_history`.`analysisType` = ?) ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
🤖 Using cached AI analysis for bitcoin
💾 [1754890556715-n3oqaqw7v] Using cached analysis for bitcoin (age: 154570ms)
✅ [1754890556715-n3oqaqw7v] Completed AI_ENHANCED_ANALYSIS successfully (4ms)
🎯 [1754890556715-n3oqaqw7v] Final result: {
  "recommendation": "GIỮ",
  "timeframe": "Ngắn hạn",
  "riskFactors": [
    "Thị trường biến động thông thường"
  ],
  "entryPoints": "Chờ tín hiệu rõ ràng hơn trước khi vào lệnh",
  "exitPoints": "Chốt lời khi có biến động giá mạnh hoặc đạt mục tiêu lợi nhuận",
  "stopLoss": "Quản lý rủi ro chặt chẽ, stop loss tại mức biến động chấp nhận được",
  "takeProfit": "Take profit khi đạt lợi nhuận mục tiêu hoặc có thay đổi xu hướng",
  "zaiAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn",
    "breakoutPotential": "LOW",
    "reasoning": "Phân tích dựa trên dữ liệu thị trường hiện tại."
  },
  "chatGPTAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn đến trung hạn (1-4 tuần)",
    "breakoutPotential": "LOW",
    "reasoning": "Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên quan sát và chờ đợi tín hiệu tốt hơn."
  }
}
 POST /api/ai-analysis?action=analyze&coinId=bitcoin 200 in 63ms
 GET / 200 in 72ms
 GET /favicon.ico 200 in 40ms
prisma:query SELECT 1
prisma:query SELECT 1
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`isActive` = ? ORDER BY `main`.`cryptocurrencies`.`isDefault` DESC, `main`.`cryptocurrencies`.`rank` ASC, `main`.`cryptocurrencies`.`createdAt` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`coin_data_collection`.`id`, `main`.`coin_data_collection`.`cryptoId`, `main`.`coin_data_collection`.`status`, `main`.`coin_data_collection`.`lastCollected`, `main`.`coin_data_collection`.`nextCollection`, `main`.`coin_data_collection`.`errorCount`, `main`.`coin_data_collection`.`lastError`, `main`.`coin_data_collection`.`metadata` FROM `main`.`coin_data_collection` WHERE `main`.`coin_data_collection`.`cryptoId` IN (?,?,?,?,?) LIMIT ? OFFSET ?
 GET /api/cryptocurrencies?activeOnly=true 200 in 85ms
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE `main`.`analysis_history`.`cryptoId` = ? ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/dashboard?coinId=bitcoin 200 in 116ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`technical_indicators`.`id`, `main`.`technical_indicators`.`cryptoId`, `main`.`technical_indicators`.`timestamp`, `main`.`technical_indicators`.`rsi`, `main`.`technical_indicators`.`ma50`, `main`.`technical_indicators`.`ma200`, `main`.`technical_indicators`.`macd`, `main`.`technical_indicators`.`macdSignal`, `main`.`technical_indicators`.`bollingerUpper`, `main`.`technical_indicators`.`bollingerLower`, `main`.`technical_indicators`.`bollingerMiddle` FROM `main`.`technical_indicators` WHERE `main`.`technical_indicators`.`cryptoId` = ? ORDER BY `main`.`technical_indicators`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/trading-signals-fast?action=signal&coinId=bitcoin 200 in 82ms
prisma:query SELECT `main`.`cryptocurrencies`.`id`, `main`.`cryptocurrencies`.`symbol`, `main`.`cryptocurrencies`.`name`, `main`.`cryptocurrencies`.`coinGeckoId`, `main`.`cryptocurrencies`.`logo`, `main`.`cryptocurrencies`.`rank`, `main`.`cryptocurrencies`.`isActive`, `main`.`cryptocurrencies`.`isDefault`, `main`.`cryptocurrencies`.`addedBy`, `main`.`cryptocurrencies`.`createdAt`, `main`.`cryptocurrencies`.`updatedAt` FROM `main`.`cryptocurrencies` WHERE `main`.`cryptocurrencies`.`coinGeckoId` = ? LIMIT ? OFFSET ?
prisma:query SELECT `main`.`price_history`.`id`, `main`.`price_history`.`cryptoId`, `main`.`price_history`.`timestamp`, `main`.`price_history`.`price`, `main`.`price_history`.`volume24h`, `main`.`price_history`.`marketCap`, `main`.`price_history`.`priceChange24h` FROM `main`.`price_history` WHERE `main`.`price_history`.`cryptoId` = ? ORDER BY `main`.`price_history`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`on_chain_metrics`.`id`, `main`.`on_chain_metrics`.`cryptoId`, `main`.`on_chain_metrics`.`timestamp`, `main`.`on_chain_metrics`.`mvrv`, `main`.`on_chain_metrics`.`nupl`, `main`.`on_chain_metrics`.`sopr`, `main`.`on_chain_metrics`.`activeAddresses`, `main`.`on_chain_metrics`.`exchangeInflow`, `main`.`on_chain_metrics`.`exchangeOutflow`, `main`.`on_chain_metrics`.`transactionVolume`, `main`.`on_chain_metrics`.`supplyDistribution`, `main`.`on_chain_metrics`.`whaleHoldingsPercentage`, `main`.`on_chain_metrics`.`retailHoldingsPercentage`, `main`.`on_chain_metrics`.`exchangeHoldingsPercentage` FROM `main`.`on_chain_metrics` WHERE `main`.`on_chain_metrics`.`cryptoId` = ? ORDER BY `main`.`on_chain_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`derivative_metrics`.`id`, `main`.`derivative_metrics`.`cryptoId`, `main`.`derivative_metrics`.`timestamp`, `main`.`derivative_metrics`.`openInterest`, `main`.`derivative_metrics`.`fundingRate`, `main`.`derivative_metrics`.`liquidationVolume`, `main`.`derivative_metrics`.`putCallRatio` FROM `main`.`derivative_metrics` WHERE `main`.`derivative_metrics`.`cryptoId` = ? ORDER BY `main`.`derivative_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
prisma:query SELECT `main`.`sentiment_metrics`.`id`, `main`.`sentiment_metrics`.`timestamp`, `main`.`sentiment_metrics`.`fearGreedIndex`, `main`.`sentiment_metrics`.`socialSentiment`, `main`.`sentiment_metrics`.`googleTrends`, `main`.`sentiment_metrics`.`newsSentiment` FROM `main`.`sentiment_metrics` WHERE 1=1 ORDER BY `main`.`sentiment_metrics`.`timestamp` DESC LIMIT ? OFFSET ?
 GET /api/alerts-fast?action=process-data&coinId=bitcoin 200 in 81ms
🤖 [1754890574587-ppgeltxzl] Starting AI analysis operation: AI_ENHANCED_ANALYSIS for bitcoin
📊 [1754890574587-ppgeltxzl] Request data: {
  "marketData": {
    "price": {
      "usd": 117775,
      "usd_24h_change": 0.8618738474048199,
      "usd_24h_vol": 33776641957.26242,
      "usd_market_cap": 2343795976558.965
    },
    "onChain": {
      "mvrv": 1.8,
      "nupl": 0.65,
      "sopr": 1.02,
      "activeAddresses": 950000,
      "exchangeInflow": 15000,
      "exchangeOutflow": 12000,
      "transactionVolume": 25000000000,
      "supplyDistribution": {
        "whaleHoldings": {
          "percentage": 42.3,
          "addressCount": 850
        },
        "retailHoldings": {
          "percentage": 38.7,
          "addressCount": 42000000
        },
        "exchangeHoldings": {
          "percentage": 12.5,
          "addressCount": 150
        },
        "otherHoldings": {
          "percentage": 6.5,
          "addressCount": 120000
        }
      },
      "whaleHoldingsPercentage": 42.3,
      "retailHoldingsPercentage": 38.7,
      "exchangeHoldingsPercentage": 12.5
    },
    "technical": {
      "rsi": 58.5,
      "ma50": 112000,
      "ma200": 108000,
      "macd": 145.5,
      "macdSignal": null,
      "bollingerUpper": 122000,
      "bollingerLower": 111000,
      "bollingerMiddle": 116627
    },
    "derivatives": {
      "openInterest": 18500000000,
      "fundingRate": 0.0125,
      "liquidationVolume": 45000000,
      "putCallRatio": 0.85
    },
    "sentiment": {
      "fearGreedIndex": 50,
      "fearGreedClassification": "Neutral",
      "social": {
        "twitterSentiment": 0.5,
        "redditSentiment": 0.5,
        "socialVolume": 45000,
        "engagementRate": 0.085,
        "influencerSentiment": 0.75,
        "trendingScore": 75
      },
      "news": {
        "newsSentiment": 0.5,
        "newsVolume": 1250,
        "positiveNewsCount": 780,
        "negativeNewsCount": 320,
        "neutralNewsCount": 150,
        "sentimentScore": 0.5,
        "buzzScore": 75
      },
      "googleTrends": {
        "trendsScore": 75,
        "searchVolume": 850000,
        "trendingKeywords": [
          "bitcoin price",
          "btc news",
          "bitcoin mining"
        ],
        "regionalInterest": {
          "US": 85,
          "CN": 72,
          "EU": 68,
          "JP": 45,
          "KR": 52
        },
        "relatedQueries": [
          {
            "query": "bitcoin price today",
            "score": 95,
            "rising": true
          },
          {
            "query": "bitcoin prediction",
            "score": 78,
            "rising": true
          },
          {
            "query": "bitcoin mining",
            "score": 65,
            "rising": false
          }
        ],
        "trendDirection": "stable"
      }
    },
    "analysis": {
      "signal": "GIỮ",
      "confidence": 60,
      "reasoning": "Z.AI: Phân tích dựa trên dữ liệu thị trường hiện tại.... | ChatGPT: Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên q...",
      "riskLevel": "MEDIUM",
      "aiModel": "Z.AI+ChatGPT"
    },
    "timestamp": "2025-08-11T05:36:14.142Z",
    "dataSource": "database"
  },
  "tradingSignal": {
    "signal": "HOLD",
    "confidence": 50,
    "reasoning": "Tín hiệu trung lập: Không đủ điều kiện để MUA hoặc BÁN. Cần theo dõi thêm.",
    "riskLevel": "MEDIUM",
    "conditions": {
      "mvrv": 1.8,
      "fearGreed": 50,
      "fundingRate": 0.0125,
      "sopr": 1.02,
      "rsi": 58.5,
      "nupl": 0.65,
      "volumeTrend": "increasing",
      "extremeDetected": false
    },
    "triggers": []
  },
  "alerts": [],
  "coinId": "bitcoin"
}
🧪 [TEST] Console.log test - AI Analysis starting for bitcoin
🤖 Starting AI analysis for bitcoin...
prisma:query SELECT `main`.`analysis_history`.`id`, `main`.`analysis_history`.`cryptoId`, `main`.`analysis_history`.`coinId`, `main`.`analysis_history`.`signal`, `main`.`analysis_history`.`confidence`, `main`.`analysis_history`.`reasoning`, `main`.`analysis_history`.`riskLevel`, `main`.`analysis_history`.`aiModel`, `main`.`analysis_history`.`analysisType`, `main`.`analysis_history`.`analysisData`, `main`.`analysis_history`.`metricsData`, `main`.`analysis_history`.`timestamp` FROM `main`.`analysis_history` WHERE (`main`.`analysis_history`.`coinId` = ? AND `main`.`analysis_history`.`analysisType` = ?) ORDER BY `main`.`analysis_history`.`timestamp` DESC LIMIT ? OFFSET ?
🤖 Using cached AI analysis for bitcoin
💾 [1754890574587-ppgeltxzl] Using cached analysis for bitcoin (age: 172445ms)
✅ [1754890574587-ppgeltxzl] Completed AI_ENHANCED_ANALYSIS successfully (7ms)
🎯 [1754890574587-ppgeltxzl] Final result: {
  "recommendation": "GIỮ",
  "timeframe": "Ngắn hạn",
  "riskFactors": [
    "Thị trường biến động thông thường"
  ],
  "entryPoints": "Chờ tín hiệu rõ ràng hơn trước khi vào lệnh",
  "exitPoints": "Chốt lời khi có biến động giá mạnh hoặc đạt mục tiêu lợi nhuận",
  "stopLoss": "Quản lý rủi ro chặt chẽ, stop loss tại mức biến động chấp nhận được",
  "takeProfit": "Take profit khi đạt lợi nhuận mục tiêu hoặc có thay đổi xu hướng",
  "zaiAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn",
    "breakoutPotential": "LOW",
    "reasoning": "Phân tích dựa trên dữ liệu thị trường hiện tại."
  },
  "chatGPTAnalysis": {
    "recommendation": "GIỮ",
    "confidence": 60,
    "timeframe": "Ngắn hạn đến trung hạn (1-4 tuần)",
    "breakoutPotential": "LOW",
    "reasoning": "Các chỉ báo kỹ thuật và on-chain cho thấy thị trường đang đi ngang. Không có xu hướng rõ ràng, nên quan sát và chờ đợi tín hiệu tốt hơn."
  }
}
 POST /api/ai-analysis?action=analyze&coinId=bitcoin 200 in 73ms
